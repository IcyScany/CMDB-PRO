Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_dom=require("../../ui/src/dom"),_utils=require("../../ui/src/utils"),_ui=require("../../ui"),_cell=_interopRequireDefault(require("./cell")),_body=_interopRequireDefault(require("./body")),_header=_interopRequireDefault(require("./header")),_footer=_interopRequireDefault(require("./footer")),_props=_interopRequireDefault(require("./props")),_emits=_interopRequireDefault(require("./emits")),_util=require("./util"),_vn=require("../../ui/src/vn"),_log=require("../../ui/src/log"),_panel=_interopRequireDefault(require("../module/custom/panel")),_panel2=_interopRequireDefault(require("../module/filter/panel")),_importPanel=_interopRequireDefault(require("../module/export/import-panel")),_exportPanel=_interopRequireDefault(require("../module/export/export-panel")),_panel3=_interopRequireDefault(require("../module/menu/panel"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}let{getConfig,getIcon,getI18n,renderer,formats,createEvent,globalResize,interceptor,hooks,globalEvents,GLOBAL_EVENT_KEYS,useFns,renderEmptyElement}=_ui.VxeUI,supportMaxRow=5e6,customStorageKey="VXE_CUSTOM_STORE",maxYHeight=5e6,maxXWidth=5e6;var _default=exports.default=(0,_vue.defineComponent)({name:"VxeTable",props:_props.default,emits:_emits.default,setup(V,e){let{slots:de,emit:r}=e,ue=_xeUtils.default.uniqueId(),se=_xeUtils.default.browse(),ce=_ui.VxeUI.getComponent("VxeLoading"),ge=_ui.VxeUI.getComponent("VxeTooltip"),t=(0,_vue.inject)("$xeTabs",null),ve=useFns.useSize(V).computeSize,B=(0,_vue.reactive)({staticColumns:[],tableGroupColumn:[],tableColumn:[],tableData:[],scrollXLoad:!1,scrollYLoad:!1,overflowY:!0,overflowX:!1,scrollbarWidth:0,scrollbarHeight:0,lastScrollTime:0,rowHeight:0,parentHeight:0,isGroup:!1,isAllOverflow:!1,isAllSelected:!1,isIndeterminate:!1,currentRow:null,currentColumn:null,selectRadioRow:null,footerTableData:[],expandColumn:null,treeNodeColumn:null,hasFixedColumn:!1,mergeList:[],mergeFooterList:[],upDataFlag:0,reColumnFlag:0,initStore:{filter:!1,import:!1,export:!1,custom:!1},customStore:{btnEl:null,isAll:!1,isIndeterminate:!1,activeBtn:!1,activeWrapper:!1,visible:!1,maxHeight:0,oldSortMaps:{},oldFixedMaps:{},oldVisibleMaps:{}},customColumnList:[],filterStore:{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1,maxHeight:null},columnStore:{leftList:[],centerList:[],rightList:[],resizeList:[],pxList:[],pxMinList:[],autoMinList:[],scaleList:[],scaleMinList:[],autoList:[],remainList:[]},ctxMenuStore:{selected:null,visible:!1,showChild:!1,selectChild:null,list:[],style:null},editStore:{indexs:{columns:[]},titles:{columns:[]},selected:{row:null,column:null},copyed:{cut:!1,rows:[],columns:[]},actived:{row:null,column:null},focused:{row:null,column:null}},tooltipStore:{row:null,column:null,content:null,visible:!1,currOpts:{}},validStore:{visible:!1},validErrorMaps:{},importStore:{inited:!1,file:null,type:"",modeList:[],typeList:[],filename:"",visible:!1},importParams:{mode:"",types:null,message:!0},exportStore:{inited:!1,name:"",modeList:[],typeList:[],columns:[],isPrint:!1,hasFooter:!1,hasMerge:!1,hasTree:!1,hasColgroup:!1,visible:!1},exportParams:{filename:"",sheetName:"",mode:"",type:"",isColgroup:!1,isMerge:!1,isAllExpand:!1,useStyle:!1,original:!1,message:!0,isHeader:!1,isFooter:!1},rowExpandedFlag:1,treeExpandedFlag:1,updateCheckboxFlag:1,pendingRowFlag:1,insertRowFlag:1,removeRowFlag:1,rowHeightStore:{default:48,medium:44,small:40,mini:36},scrollVMLoading:!1,scrollYHeight:0,scrollYTop:0,isScrollYBig:!1,scrollXLeft:0,scrollXWidth:0,isScrollXBig:!1,rowExpandHeightFlag:1,calcCellHeightFlag:1,resizeHeightFlag:1,resizeWidthFlag:1,isCustomStatus:!1,isDragRowMove:!1,dragRow:null,isDragColMove:!1,dragCol:null,dragTipText:"",isDragResize:!1,isRowLoading:!1,isColLoading:!1}),W={tZindex:0,elemStore:{},scrollXStore:{preloadSize:0,offsetSize:0,visibleSize:0,visibleStartIndex:0,visibleEndIndex:0,startIndex:0,endIndex:0},scrollYStore:{preloadSize:0,offsetSize:0,visibleSize:0,visibleStartIndex:0,visibleEndIndex:0,startIndex:0,endIndex:0},tableWidth:0,tableHeight:0,headerHeight:0,footerHeight:0,customHeight:0,customMinHeight:0,customMaxHeight:0,hoverRow:null,lastScrollLeft:0,lastScrollTop:0,radioReserveRow:null,checkboxReserveRowMap:{},rowExpandedReserveRowMap:{},treeExpandedReserveRowMap:{},treeIndeterminateRowMaps:{},tableFullData:[],afterFullData:[],afterTreeFullData:[],afterFullRowMaps:{},tableFullTreeData:[],tableSynchData:[],tableSourceData:[],collectColumn:[],tableFullColumn:[],visibleColumn:[],fullAllDataRowIdData:{},sourceDataRowIdData:{},fullDataRowIdData:{},fullColumnIdData:{},fullColumnFieldData:{},rowExpandedMaps:{},rowExpandLazyLoadedMaps:{},treeExpandedMaps:{},treeExpandLazyLoadedMaps:{},selectCheckboxMaps:{},pendingRowMaps:{},insertRowMaps:{},removeRowMaps:{},inited:!1,tooltipTimeout:null,initStatus:!1,isActivated:!1},P={},Y={},q=(0,_vue.ref)(),he=(0,_vue.ref)(),$=(0,_vue.ref)(),fe=(0,_vue.ref)(),me=(0,_vue.ref)(),pe=(0,_vue.ref)(),xe=(0,_vue.ref)(),_e=(0,_vue.ref)(),u=(0,_vue.ref)(),s=(0,_vue.ref)(),_=(0,_vue.ref)(),c=(0,_vue.ref)(),g=(0,_vue.ref)(),v=(0,_vue.ref)(),h=(0,_vue.ref)(),x=(0,_vue.ref)(),w=(0,_vue.ref)(),C=(0,_vue.ref)(),N=(0,_vue.ref)(),X=(0,_vue.ref)(),we=(0,_vue.ref)(),Ce=(0,_vue.ref)(),be=(0,_vue.ref)(),Re=(0,_vue.ref)(),Ee=(0,_vue.ref)(),ye=(0,_vue.ref)(),j=(0,_vue.ref)(),L=(0,_vue.ref)(),Se=(0,_vue.ref)(),Te=(0,_vue.ref)(),S=(0,_vue.ref)(),De=(0,_vue.ref)(),Ie=(0,_vue.ref)(),T=(0,_vue.ref)(),Me=(0,_vue.ref)(),Le=(0,_vue.ref)(),Fe=(0,_vue.ref)(),ke=(0,_vue.ref)(),F=(0,_vue.ref)(),k=(0,_vue.ref)(),K=(0,_vue.inject)("$xeGrid",null),U,A=(0,_vue.computed)(()=>{var e=V.id;return e?_xeUtils.default.isFunction(e)?""+(e({$table:ie,$grid:K})||""):""+e:""}),Ue=(0,_vue.computed)(()=>Object.assign({},getConfig().table.validConfig,V.validConfig));var l=(0,_vue.computed)(()=>f.value);let O=(0,_vue.computed)(()=>{var e=f.value.threshold;return e?_xeUtils.default.toNumber(e):0});var a=(0,_vue.computed)(()=>m.value);let f=(0,_vue.computed)(()=>Object.assign({},getConfig().table.scrollX,getConfig().table.virtualXConfig,V.scrollX,V.virtualXConfig)),m=(0,_vue.computed)(()=>Object.assign({},getConfig().table.scrollY,getConfig().table.virtualYConfig,V.scrollY,V.virtualYConfig)),H=(0,_vue.computed)(()=>Object.assign({},getConfig().table.scrollbarConfig,V.scrollbarConfig)),Ae=(0,_vue.computed)(()=>{var e=H.value;return!(!e.x||"top"!==e.x.position)}),Oe=(0,_vue.computed)(()=>{var e=H.value;return!(!e.y||"left"!==e.y.position)}),z=(0,_vue.computed)(()=>{var e=m.value.threshold;return e?_xeUtils.default.toNumber(e):0}),o=(0,_vue.computed)(()=>B.rowHeightStore),E=(0,_vue.computed)(()=>{var e=ve.value;return o.value[e||"default"]||18}),G=(0,_vue.computed)(()=>Object.assign({},getConfig().table.columnConfig,V.columnConfig)),He=(0,_vue.computed)(()=>Object.assign({},getConfig().table.currentColumnConfig,V.currentColumnConfig)),y=(0,_vue.computed)(()=>{var e=Object.assign({},getConfig().table.cellConfig,V.cellConfig);return e.height&&(e.height=_xeUtils.default.toNumber(e.height)),e});var i=(0,_vue.computed)(()=>{var e=Object.assign({},getConfig().table.headerCellConfig,V.headerCellConfig);return e.height&&(e.height=_xeUtils.default.toNumber(e.height)),e}),n=(0,_vue.computed)(()=>{var e=Object.assign({},getConfig().table.footerCellConfig,V.footerCellConfig);return e.height&&(e.height=_xeUtils.default.toNumber(e.height)),e});let Z=(0,_vue.computed)(()=>Object.assign({},getConfig().table.rowConfig,V.rowConfig));var d=(0,_vue.computed)(()=>Object.assign({},getConfig().table.currentRowConfig,V.currentRowConfig));let J=(0,_vue.computed)(()=>Object.assign({},getConfig().table.rowDragConfig,V.rowDragConfig)),Q=(0,_vue.computed)(()=>Object.assign({},getConfig().table.columnDragConfig,V.columnDragConfig)),ze=(0,_vue.computed)(()=>Object.assign({},getConfig().table.resizeConfig,V.resizeConfig)),Ne=(0,_vue.computed)(()=>Object.assign({},getConfig().table.resizableConfig,V.resizableConfig));var We=(0,_vue.computed)(()=>Object.assign({startIndex:0},getConfig().table.seqConfig,V.seqConfig));let D=(0,_vue.computed)(()=>Object.assign({},getConfig().table.radioConfig,V.radioConfig)),ee=(0,_vue.computed)(()=>Object.assign({},getConfig().table.checkboxConfig,V.checkboxConfig)),Pe=(0,_vue.computed)(()=>Object.assign({},getConfig().tooltip,getConfig().table.tooltipConfig,V.tooltipConfig)),Ve=(0,_vue.computed)(()=>{var e=B.tooltipStore,t=Pe.value;return Object.assign({},t,e.currOpts)}),Be=(0,_vue.computed)(()=>{var e=Pe.value;return Object.assign({},e)}),te=(0,_vue.computed)(()=>Object.assign({},getConfig().table.editConfig,V.editConfig)),R=(0,_vue.computed)(()=>Object.assign({orders:["asc","desc",null]},getConfig().table.sortConfig,V.sortConfig)),Ye=(0,_vue.computed)(()=>Object.assign({},getConfig().table.filterConfig,V.filterConfig)),le=(0,_vue.computed)(()=>Object.assign({},getConfig().table.mouseConfig,V.mouseConfig)),qe=(0,_vue.computed)(()=>Object.assign({},getConfig().table.areaConfig,V.areaConfig)),re=(0,_vue.computed)(()=>Object.assign({},getConfig().table.keyboardConfig,V.keyboardConfig));var $e=(0,_vue.computed)(()=>Object.assign({},getConfig().table.clipConfig,V.clipConfig)),Xe=(0,_vue.computed)(()=>Object.assign({},getConfig().table.fnrConfig,V.fnrConfig));let je=(0,_vue.computed)(()=>Object.assign({},getConfig().table.menuConfig,V.menuConfig)),Ke=(0,_vue.computed)(()=>{var e=B.columnStore,t=e.leftList;let l=0;for(let e=0;e<t.length;e++){var r=t[e];l+=r.renderWidth}return l}),Ge=(0,_vue.computed)(()=>{var e=B.columnStore,t=e.rightList;let l=0;for(let e=0;e<t.length;e++){var r=t[e];l+=r.renderWidth}return l}),Ze=(0,_vue.computed)(()=>{var e=je.value.header;return e&&e.options?e.options:[]}),Je=(0,_vue.computed)(()=>{var e=je.value.body;return e&&e.options?e.options:[]}),Qe=(0,_vue.computed)(()=>{var e=je.value.footer;return e&&e.options?e.options:[]}),et=(0,_vue.computed)(()=>{var e=je.value,t=Ze.value,l=Je.value,r=Qe.value;return!!(V.menuConfig&&(0,_utils.isEnableConf)(e)&&(t.length||l.length||r.length))}),tt=(0,_vue.computed)(()=>{var e=B.ctxMenuStore;let t=[];return e.list.forEach(e=>{e.forEach(e=>{t.push(e)})}),t}),lt=(0,_vue.computed)(()=>Object.assign({},getConfig().table.exportConfig,V.exportConfig)),rt=(0,_vue.computed)(()=>Object.assign({},getConfig().table.importConfig,V.importConfig));var at=(0,_vue.computed)(()=>Object.assign({},getConfig().table.printConfig,V.printConfig));let ae=(0,_vue.computed)(()=>Object.assign({},getConfig().table.expandConfig,V.expandConfig)),oe=(0,_vue.computed)(()=>Object.assign({},getConfig().table.treeConfig,V.treeConfig)),ot=(0,_vue.computed)(()=>Object.assign({},getConfig().table.emptyRender,V.emptyRender)),it=(0,_vue.computed)(()=>Object.assign({},getConfig().table.loadingConfig,V.loadingConfig));var nt=(0,_vue.computed)(()=>V.border?Math.max(2,Math.ceil(B.scrollbarWidth/B.tableColumn.length)):1);let I=(0,_vue.computed)(()=>Object.assign({},getConfig().table.customConfig,V.customConfig)),dt=(0,_vue.computed)(()=>{var{rowExpandedFlag:e,tableData:t,expandColumn:l}=B,r=W.rowExpandedMaps;let a=(0,_util.createHandleGetRowId)(ie).handleGetRowId,o=[];if(l&&e){let l={};t.forEach(e=>{l[a(e)]=!0}),_xeUtils.default.each(r,(e,t)=>{l[t]&&o.push(e)})}return o}),ut=(0,_vue.computed)(()=>{var e=W.visibleColumn,t=B.tableColumn;return t.length||e.length?e.filter(e=>"auto"===e.width||"auto"===e.minWidth):[]}),st=(0,_vue.computed)(()=>{var e=B.tableColumn,t=W.collectColumn;let l=0;return e.length&&t.length&&t.forEach(e=>{e.renderFixed&&l++}),l}),ct=(0,_vue.computed)(()=>{var e=st.value,t=G.value.maxFixedSize;return!!t&&t<=e}),gt=(0,_vue.computed)(()=>{var e=V.border;return!0===e?"full":e||"default"});var vt=(0,_vue.computed)(()=>{var{}=V,e=B.tableData,t=W.tableFullData;let{strict:l,checkMethod:r}=ee.value;return!!l&&(!e.length&&!t.length||!!r&&t.every(e=>!r({row:e})))}),ht=(0,_vue.computed)(()=>{var{overflowX:e,scrollXLoad:t,overflowY:l,scrollYLoad:r}=B;return{x:e&&t,y:l&&r}});let ft={refElem:q,refTooltip:$,refValidTooltip:me,refTableFilter:xe,refTableCustom:_e,refTableMenu:pe,refTableHeader:s,refTableBody:_,refTableFooter:c,refTableLeftHeader:g,refTableLeftBody:v,refTableLeftFooter:h,refTableRightHeader:x,refTableRightBody:w,refTableRightFooter:C,refLeftContainer:N,refRightContainer:X,refColResizeBar:we,refRowResizeBar:Ce,refScrollXVirtualElem:Se,refScrollYVirtualElem:Te,refScrollXHandleElem:S,refScrollYHandleElem:T,refScrollXSpaceElem:F,refScrollYSpaceElem:k},mt={computeSize:ve,computeTableId:A,computeValidOpts:Ue,computeVirtualXOpts:f,computeVirtualYOpts:m,computeScrollbarOpts:H,computeScrollbarXToTop:Ae,computeScrollbarYToLeft:Oe,computeColumnOpts:G,computeCurrentColumnOpts:He,computeScrollXThreshold:O,computeScrollYThreshold:z,computeRowHeightMaps:o,computeDefaultRowHeight:E,computeCellOpts:y,computeHeaderCellOpts:i,computeFooterCellOpts:n,computeRowOpts:Z,computeCurrentRowOpts:d,computeRowDragOpts:J,computeColumnDragOpts:Q,computeResizeOpts:ze,computeResizableOpts:Ne,computeSeqOpts:We,computeRadioOpts:D,computeCheckboxOpts:ee,computeTooltipOpts:Pe,computeEditOpts:te,computeSortOpts:R,computeFilterOpts:Ye,computeMouseOpts:le,computeAreaOpts:qe,computeKeyboardOpts:re,computeClipOpts:$e,computeFNROpts:Xe,computeHeaderMenu:Ze,computeBodyMenu:Je,computeFooterMenu:Qe,computeIsMenu:et,computeMenuOpts:je,computeExportOpts:lt,computeImportOpts:rt,computePrintOpts:at,computeExpandOpts:ae,computeTreeOpts:oe,computeEmptyOpts:ot,computeLoadingOpts:it,computeCellOffsetWidth:nt,computeCustomOpts:I,computeLeftFixedWidth:Ke,computeRightFixedWidth:Ge,computeFixedColumnSize:st,computeIsMaxFixedColumn:ct,computeIsAllCheckboxDisabled:vt,computeVirtualScrollBars:ht,computeSXOpts:l,computeSYOpts:a},ie={xID:ue,props:V,context:e,reactData:B,internalData:W,getRefMaps:()=>ft,getComputeMaps:()=>mt,xeGrid:K,xegrid:K},pt=(e,t,l)=>{e=_xeUtils.default.get(e,l),t=_xeUtils.default.get(t,l);return!(!(0,_utils.eqEmptyValue)(e)||!(0,_utils.eqEmptyValue)(t))||(_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?""+e==""+t:_xeUtils.default.isEqual(e,t))},xt=e=>{var t=R.value.orders,e=e.order||null,e=t.indexOf(e)+1;return t[e<t.length?e:0]},_t=e=>{var t=getConfig().version,l=_xeUtils.default.toStringJSON(localStorage.getItem(customStorageKey)||""),l=l&&l._v===t?l:{_v:t};return(e?l[e]:l)||{}},wt=e=>{let l=W.fullAllDataRowIdData,r={};return _xeUtils.default.each(e,(e,t)=>{l[t]&&(r[t]=e)}),r},Ct=e=>{let l=W.fullDataRowIdData,r=[];return _xeUtils.default.each(e,(e,t)=>{l[t]&&-1===ie.findRowIndexOf(r,l[t].row)&&r.push(l[t].row)}),r},bt=()=>{var{isScrollXBig:a,scrollXWidth:o}=B,{elemStore:i,visibleColumn:n,fullColumnIdData:d}=W,u=Ke.value,s=Ge.value,i=(0,_util.getRefElem)(i["main-body-scroll"]);if(i){var c=i.clientWidth;let e=i.scrollLeft;var g=(e=a?Math.ceil((o-c)*Math.min(1,e/(maxXWidth-c))):e)+u,v=e+c-s;let t=0,l=n.length;for(;t<l;){var h=Math.floor((t+l)/2);(d[n[h].id]||{}).oLeft<=g?t=h+1:l=h}let r=0;i=Math.max(0,t<n.length?t-2:0);for(let e=i,t=n.length;e<t;e++){var f=d[n[e].id]||{};if(r++,f.oLeft>v||60<=r)break}return{toVisibleIndex:Math.max(0,i),visibleSize:Math.max(1,r)}}return{toVisibleIndex:0,visibleSize:6}},Rt=(e,t)=>{var l=B.rowHeightStore;t&&t.clientHeight&&(l[e]=t.clientHeight)},Et=()=>{var t=B.isAllOverflow,l=s.value,r=_.value,r=r?r.$el:null,e=E.value;let a=0;if(t){if(r){t=l?l.$el:null;let e;(e=!(e=r.querySelector("tr"))&&t?t.querySelector("tr"):e)&&(a=e.clientHeight)}a=a||e}else a=e;return Math.max(18,a)},yt=()=>{var{isAllOverflow:t,expandColumn:l,isScrollYBig:o,scrollYHeight:i}=B,{elemStore:n,isResizeCellHeight:d,afterFullData:u,fullAllDataRowIdData:s}=W,c=Z.value,g=y.value,v=E.value,n=(0,_util.getRefElem)(n["main-body-scroll"]);if(n){var h=n.clientHeight;let e=n.scrollTop;var f=e=o?Math.ceil((i-h)*Math.min(1,e/(maxYHeight-h))):e,m=e+h;let r=-1,a=0;if(d||g.height||c.height||l||!t){var p=(0,_util.createHandleGetRowId)(ie).handleGetRowId;let l=0,e=u.length;for(;l<e;){var x=Math.floor((l+e)/2);(s[p(u[x])]||{}).oTop<=f?l=x+1:e=x}for(let e=r=Math.max(0,l<u.length?l-2:0),t=u.length;e<t;e++){var _=s[p(u[e])]||{};if(a++,_.oTop>m||100<=a)break}}else r=Math.floor(f/v)-1,a=Math.ceil(h/v)+1;return{toVisibleIndex:Math.max(0,r),visibleSize:Math.max(6,a)}}return{toVisibleIndex:0,visibleSize:6}},St=(l,r,a)=>{for(let e=0,t=l.length;e<t;e++){var o=l[e],{startIndex:i,endIndex:n}=r,d=o[a],o=d+o[a+"span"];d<i&&i<o&&(r.startIndex=d),d<n&&n<o&&(r.endIndex=o),r.startIndex===i&&r.endIndex===n||(e=-1)}},Tt=(e,n,d)=>{if(e){let i=W.visibleColumn;(e=_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{let{row:t,col:l,rowspan:r,colspan:a}=e;var o;d&&_xeUtils.default.isNumber(t)&&(t=d[t]),_xeUtils.default.isNumber(l)&&(l=i[l]),(d?t:_xeUtils.default.isNumber(t))&&l&&(r||a)&&(r=_xeUtils.default.toNumber(r)||1,a=_xeUtils.default.toNumber(a)||1,1<r||1<a)&&(e=_xeUtils.default.findIndexOf(n,e=>!(e._row!==t&&(0,_util.getRowid)(ie,e._row)!==(0,_util.getRowid)(ie,t)||e._col.id!==l&&e._col.id!==l.id)),(e=n[e])?(e.rowspan=r,e.colspan=a,e._rowspan=r,e._colspan=a):(e=d?ie.findRowIndexOf(d,t):t,o=P.getVTColumnIndex(l),n.push({row:e,col:o,rowspan:r,colspan:a,_row:t,_col:l,_rowspan:r,_colspan:a})))})}},Dt=(e,a,o)=>{let i=[];if(e){let r=W.visibleColumn;(e=_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{let{row:t,col:l}=e;o&&_xeUtils.default.isNumber(t)&&(t=o[t]),_xeUtils.default.isNumber(l)&&(l=r[l]);var e=_xeUtils.default.findIndexOf(a,e=>!(e._row!==t&&(0,_util.getRowid)(ie,e._row)!==(0,_util.getRowid)(ie,t)||e._col.id!==l&&e._col.id!==l.id));-1<e&&(e=a.splice(e,1),i.push(e[0]))})}return i},It=()=>{var e=W.tableFullColumn;e.forEach(e=>{e.order=null})},Mt=e=>{var t,l=B.parentHeight,e=V[e];let r=0;return r=e?"100%"===e||"auto"===e?l:(t=ie.getExcludeHeight(),r=(0,_dom.isScale)(e)?Math.floor((_xeUtils.default.toInteger(e)||1)/100*l):_xeUtils.default.toNumber(e),Math.max(40,r-t)):r},Lt=e=>{var t=W.collectColumn;let{resizableData:i,sortData:n,visibleData:d,fixedData:u}=e,s=!1;i||n||d||u?(_xeUtils.default.eachTree(t,(e,t,l,r,a)=>{var o=e.getKey();a||(u&&void 0!==u[o]&&(e.fixed=u[o]),n&&_xeUtils.default.isNumber(n[o])&&(s=!0,e.renderSortNumber=n[o])),i&&_xeUtils.default.isNumber(i[o])&&(e.resizeWidth=i[o]),d&&_xeUtils.default.isBoolean(d[o])&&(e.visible=d[o])}),s&&(t=_xeUtils.default.orderBy(t,"renderSortNumber"),W.collectColumn=t,W.tableFullColumn=nl(t)),B.isCustomStatus=!0):B.isCustomStatus=!1},Ft=()=>{var{tableFullColumn:e,collectColumn:t}=W;let s=W.fullColumnIdData={},c=W.fullColumnFieldData={};var l=le.value,r=ae.value;let g=G.value,{isCrossDrag:v,isSelfToChildDrag:h}=Q.value,f=I.value.storage;var a=Z.value,o=t.some(_utils.hasChildrenList);let m=!!V.showOverflow,p,x,_,w,C,b,i=(e,t,l,r,a)=>{var{id:o,field:i,fixed:n,type:d,treeNode:u}=e,t={$index:-1,_index:-1,column:e,colid:o,index:t,items:l,parent:a||null,width:0,oLeft:0};i?(c[i]&&(0,_log.errLog)("vxe.error.colRepet",["field",i]),c[i]=t):(f&&!d||g.drag&&(v||h))&&(0,_log.errLog)("vxe.error.reqProp",[`${e.getTitle()||d||""} -> column.field=?`]),!b&&n&&(b=n),C||"html"!==d||(C=e),u?("development"===process.env.NODE_ENV&&x&&(0,_log.warnLog)("vxe.error.colRepet",["tree-node",u]),x=x||e):"expand"===d&&("development"===process.env.NODE_ENV&&p&&(0,_log.warnLog)("vxe.error.colRepet",["type",d]),p=p||e),"development"===process.env.NODE_ENV&&("checkbox"===d?(_&&(0,_log.warnLog)("vxe.error.colRepet",["type",d]),_=_||e):"radio"===d&&(w&&(0,_log.warnLog)("vxe.error.colRepet",["type",d]),w=w||e)),m&&!1===e.showOverflow&&(m=!1),s[o]&&(0,_log.errLog)("vxe.error.colRepet",["colId",o]),s[o]=t};o?_xeUtils.default.eachTree(t,(e,t,l,r,a,o)=>{e.level=o.length,i(e,t,l,0,a)}):e.forEach(i),p&&"fixed"!==r.mode&&l.area&&(0,_log.errLog)("vxe.error.errConflicts",["mouse-config.area","column.type=expand"]),C&&(g.useKey||(0,_log.errLog)("vxe.error.reqProp",["column-config.useKey & column.type=html"]),a.useKey||(0,_log.errLog)("vxe.error.reqProp",["row-config.useKey & column.type=html"])),B.isGroup=o,B.treeNodeColumn=x,B.expandColumn=p,B.isAllOverflow=m},kt=()=>{W.customHeight=Mt("height"),W.customMinHeight=Mt("minHeight"),W.customMaxHeight=Mt("maxHeight")},Ut=(e,t)=>{var l=t.querySelectorAll(`.vxe-cell--wrapper[colid="${e.id}"]`);let r=0;var t=l[0];t&&t.parentElement&&(t=getComputedStyle(t.parentElement),r=Math.ceil(_xeUtils.default.toNumber(t.paddingLeft)+_xeUtils.default.toNumber(t.paddingRight)));let a=e.renderAutoWidth-r;for(let e=0;e<l.length;e++){var o=l[e];a=Math.max(a,o?Math.ceil(o.scrollWidth)+4:0)}return a+r},At=()=>{var e=ut.value;let r=W.fullColumnIdData,a=q.value;a&&(a.setAttribute("data-calc-col","Y"),e.forEach(e=>{var t=e.id,t=r[t],l=Ut(e,a);t&&(t.width=Math.max(l,t.width)),e.renderAutoWidth=l}),ie.analyColumnWidth(),a.removeAttribute("data-calc-col"))},Ot=()=>{var e=W.elemStore,t=H.value,a=_.value,a=a?a.$el:null;if(a){var o=T.value;if(o){var i=S.value;if(i){let l=0;var n=a.clientWidth,d=n;let r=d/100;var u=V.fit,s=B.columnStore,{resizeList:s,pxMinList:c,autoMinList:g,pxList:v,scaleList:h,scaleMinList:f,autoList:m,remainList:p}=s;if(c.forEach(e=>{var t=_xeUtils.default.toInteger(e.minWidth);l+=t,e.renderWidth=t}),g.forEach(e=>{var t=Math.max(60,_xeUtils.default.toInteger(e.renderAutoWidth));l+=t,e.renderWidth=t}),f.forEach(e=>{var t=Math.floor(_xeUtils.default.toInteger(e.minWidth)*r);l+=t,e.renderWidth=t}),h.forEach(e=>{var t=Math.floor(_xeUtils.default.toInteger(e.width)*r);l+=t,e.renderWidth=t}),v.forEach(e=>{var t=_xeUtils.default.toInteger(e.width);l+=t,e.renderWidth=t}),m.forEach(e=>{var t=Math.max(60,_xeUtils.default.toInteger(e.renderAutoWidth));l+=t,e.renderWidth=t}),s.forEach(e=>{var t=_xeUtils.default.toInteger(e.resizeWidth);l+=t,e.renderWidth=t}),d-=l,r=0<d?Math.floor(d/(f.length+c.length+g.length+p.length)):0,u?0<d&&f.concat(c).concat(g).forEach(e=>{l+=r,e.renderWidth+=r}):r=40,p.forEach(e=>{var t=Math.max(r,40);e.renderWidth=t,l+=t}),u){var x=h.concat(f).concat(c).concat(g).concat(p);let t=x.length-1;if(0<t){let e=n-l;if(0<e){for(;0<e&&0<=t;)e--,x[t--].renderWidth++;l=n}}}v=a.offsetHeight,m=o.scrollHeight>o.clientHeight,s=(B.scrollbarWidth=Math.max(t.width||0,o.offsetWidth-o.clientWidth),B.overflowY=m,B.scrollXWidth=l,W.tableHeight=v,(0,_util.getRefElem)(e["main-header-table"])),d=(0,_util.getRefElem)(e["main-footer-table"]),u=s?s.clientHeight:0,h=l>n,f=d?d.clientHeight:0;B.scrollbarHeight=Math.max(t.height||0,i.offsetHeight-i.clientHeight),W.headerHeight=u,W.footerHeight=f,B.overflowX=h,B.resizeWidthFlag++,pl(),kt(),B.parentHeight=Math.max(W.headerHeight+f+20,ie.getParentHeight()),h&&ie.checkScrolling()}}}},Ht=(e,t)=>{var l=t.querySelectorAll(`.vxe-cell--wrapper[rowid="${e.rowid}"]`);let r=e.height;for(let e=0;e<l.length;e++){var a=l[e],o=a.parentElement,o=Math.ceil(_xeUtils.default.toNumber(o.style.paddingTop)+_xeUtils.default.toNumber(o.style.paddingBottom)),a=a?a.clientHeight:0;r=Math.max(r-o,Math.ceil(a))}return r},zt=()=>{let{tableData:e,isAllOverflow:t,scrollYLoad:l,scrollXLoad:r}=B,a=W.fullAllDataRowIdData,o=E.value,i=q.value;if(!t&&l&&i){let l=(0,_util.createHandleGetRowId)(ie).handleGetRowId;i.setAttribute("data-calc-row","Y"),e.forEach(e=>{var t,e=l(e),e=a[e];e&&(t=Ht(e,i),e.height=Math.max(o,r?Math.max(e.height,t):t)),i.removeAttribute("data-calc-row")}),B.calcCellHeightFlag++}},Nt=l=>{let{sortBy:r,sortType:a}=l;return e=>{let t;return t=r?_xeUtils.default.isFunction(r)?r({row:e,column:l}):_xeUtils.default.get(e,r):P.getCellLabel(e,l),a&&"auto"!==a?"number"===a?_xeUtils.default.toNumber(t):"string"===a?_xeUtils.default.toValueString(t):t:isNaN(t)?t:_xeUtils.default.toNumber(t)}},Wt=()=>{let o=V.treeConfig,{afterFullData:e,fullDataRowIdData:i,fullAllDataRowIdData:n}=W,d=(0,_util.createHandleGetRowId)(ie).handleGetRowId,u={};e.forEach((e,t)=>{var l=d(e),r=n[l],a=t+1;r?(o||(r.seq=a),r._index=t):(r={row:e,rowid:l,seq:a,index:-1,$index:-1,_index:t,treeIndex:-1,items:[],parent:null,level:0,height:0,resizeHeight:0,oTop:0,expandHeight:0},n[l]=r,i[l]=r),u[l]=e}),W.afterFullRowMaps=u},Pt=()=>{var e=V.treeConfig;let{fullDataRowIdData:n,fullAllDataRowIdData:d,afterTreeFullData:t}=W;var l=oe.value,r=l.transform,a=l.children||l.childrenField;let u={};if(e){let i=(0,_util.createHandleGetRowId)(ie).handleGetRowId;_xeUtils.default.eachTree(t,(e,t,l,r)=>{var a=i(e),o=d[a],r=r.map((e,t)=>t%2==0?Number(e)+1:".").join("");o?(o.seq=r,o.treeIndex=t):(o={row:e,rowid:a,seq:r,index:-1,$index:-1,_index:-1,treeIndex:-1,items:[],parent:null,level:0,height:0,resizeHeight:0,oTop:0,expandHeight:0},d[a]=o,n[a]=o),u[a]=e},{children:r?l.mapChildrenField:a}),W.afterFullRowMaps=u}Wt()},Vt=()=>{var e=V.treeConfig;let{fullAllDataRowIdData:s,treeExpandedMaps:c}=W;var t=oe.value,l=t.children||t.childrenField;if(e&&t.transform){let n=(0,_util.createHandleGetRowId)(ie).handleGetRowId,d=[],u={};return _xeUtils.default.eachTree(W.afterTreeFullData,(e,t,l,r,a)=>{var o=n(e),i=n(a);(!a||u[i]&&c[i])&&((a=s[o])&&(a._index=d.length),u[o]=1,d.push(e))},{children:l}),W.afterFullData=d,sl(d),d}return W.afterFullData},b=()=>{let{showHeaderOverflow:x,showFooterOverflow:_,mouseConfig:e,spanMethod:w,footerSpanMethod:C}=V,{isGroup:b,currentRow:t,tableColumn:R,scrollXLoad:E,scrollYLoad:y,overflowX:l,scrollbarWidth:r,overflowY:a,scrollbarHeight:o,scrollXWidth:S,columnStore:i,editStore:n,isAllOverflow:T,expandColumn:D}=B,{visibleColumn:I,tableHeight:M,headerHeight:L,footerHeight:F,elemStore:k,customHeight:U,customMinHeight:d,customMaxHeight:A}=W;var u=q.value;if(u){let g=a?r:0,v=l?o:0;var s=be.value,c=le.value;let h=ae.value;var O=(0,_util.getRefElem)(k["main-body-wrapper"]),H=(0,_util.getRefElem)(k["main-body-table"]);s&&(s.style.top=L+"px",s.style.height=O?O.offsetHeight-v+"px":"");let f=0,m=0,p=d-L-F-v;A&&(m=Math.max(p,A-L-F-v)),(f=U?U-L-F-v:f)||H&&(f=H.clientHeight),f&&(m&&(f=Math.min(m,f)),f=Math.max(p,f));var s=Ae.value,O=De.value,H=Ie.value,z=Se.value,z=(z&&(z.style.height=v+"px",z.style.visibility=l?"visible":"hidden"),Le.value),z=(z&&(z.style.left=s?g+"px":"",z.style.width=u.clientWidth-g+"px"),O&&(O.style.width=s?g+"px":"",O.style.display=s&&g&&v?"block":""),H&&(H.style.width=s?"":g+"px",H.style.display=!s&&g&&v?"block":""),Te.value),u=(z&&(z.style.width=g+"px",z.style.height=f+L+F+"px",z.style.visibility=a?"visible":"hidden"),Me.value),O=(u&&(u.style.height=L+"px",u.style.display=L?"block":""),Fe.value),H=(O&&(O.style.height=f+"px",O.style.top=L+"px"),ke.value),s=(H&&(H.style.height=F+"px",H.style.top=L+f+"px",H.style.display=F?"block":""),j.value);return s&&(s.style.height=f+"px",s.style.top=L+"px"),["main","left","right"].forEach((d,e)=>{let u=0<e?d:"";e="left"===u;let s=[],c;u&&(s=e?i.leftList:i.rightList,c=(e?N:X).value),["header","body","footer"].forEach(l=>{var r=(0,_util.getRefElem)(k[d+`-${l}-wrapper`]),a=(0,_util.getRefElem)(k[d+`-${l}-scroll`]),o=(0,_util.getRefElem)(k[d+`-${l}-table`]);if("header"===l){let e=R,t=!1;b?e=I:(!(E||y||x)||w||C||(t=!0),u&&(e=I,t)&&(e=s||[]));var i=e.reduce((e,t)=>e+t.renderWidth,0);u&&(!b&&t?r&&(r.style.width=i?i+"px":""):r&&(r.style.width=S?S+"px":"")),a&&(a.style.height=L+"px"),o&&(o.style.width=i?i+"px":"")}else if("body"===l){a&&(a.style.maxHeight=A?m+"px":"",a.style.height=U?f+"px":"",a.style.minHeight=p+"px"),c&&(r&&(r.style.top=L+"px"),c.style.height=`${0<U?U:M+L+F+v}px`,c.style.width=s.reduce((e,t)=>e+t.renderWidth,0)+"px");let e=R,t=!1;!(E||y||T)||D&&"fixed"!==h.mode||w||C||(t=!0);var i=(e=u&&(e=I,t)?s||[]:e).reduce((e,t)=>e+t.renderWidth,0),n=(u&&(t?r&&(r.style.width=i?i+"px":""):r&&(r.style.width=S?S+"px":"")),o&&(o.style.width=i?i+"px":"",o.style.paddingRight=g&&u&&(se["-moz"]||se.safari)?g+"px":""),(0,_util.getRefElem)(k[d+`-${l}-emptyBlock`]));n&&(n.style.width=i?i+"px":"")}else if("footer"===l){let e=R,t=!1;!(E||y||_)||w||C||(t=!0);n=(e=u&&(e=I,t)?s||[]:e).reduce((e,t)=>e+t.renderWidth,0);u&&(t?r&&(r.style.width=n?n+"px":""):r&&(r.style.width=S?S+"px":"")),a&&(a.style.height=F+"px",c)&&r&&(r.style.top=`${0<U?U-F-v:M+L}px`),o&&(o.style.width=n?n+"px":"")}})}),t&&ie.setCurrentRow(t),e&&c.selected&&n.selected.row&&n.selected.column&&ie.addCellSelectedClass(),(0,_vue.nextTick)()}},Bt=e=>ie.triggerValidate?ie.triggerValidate(e):(0,_vue.nextTick)(),Yt=(e,t)=>{Bt("blur").catch(e=>e).then(()=>{ie.handleEdit(t,e).then(()=>Bt("change")).catch(e=>e)})},qt=e=>{D.value.reserve&&(W.radioReserveRow=e)},$t=(e,t)=>{var l,r=W.checkboxReserveRowMap;ee.value.reserve&&(l=(0,_util.getRowid)(ie,e),t?r[l]=e:r[l]&&delete r[l])},Xt=(e,t)=>{var l=D.value.checkMethod;return e&&(t||!l||l({row:e}))&&(B.selectRadioRow=e,qt(e)),(0,_vue.nextTick)()},p=(e,t,l)=>(e&&!_xeUtils.default.isArray(e)&&(e=[e]),ie.handleBatchSelectRows(e,!!t,l),ie.checkSelectionStatus(),(0,_vue.nextTick)()),jt=(t,l)=>{let r=V.treeConfig,{afterFullData:e,checkboxReserveRowMap:a,selectCheckboxMaps:o}=W;var i=oe.value,i=i.children||i.childrenField,n=ee.value;let{checkField:d,reserve:u,checkMethod:s}=n,c=(0,_util.createHandleGetRowId)(ie).handleGetRowId,g=n.indeterminateField||n.halfField,v={};return d?(n=e=>{!l&&s&&!s({row:e})||(t&&(v[c(e)]=e),_xeUtils.default.set(e,d,t)),r&&g&&_xeUtils.default.set(e,g,!1)},r?_xeUtils.default.eachTree(e,n,{children:i}):e.forEach(n)):r?t?_xeUtils.default.eachTree(e,e=>{var t;!l&&s&&!s({row:e})||(t=c(e),v[t]=e)},{children:i}):!l&&s&&_xeUtils.default.eachTree(e,e=>{var t=c(e);!s({row:e})&&o[t]&&(v[t]=e)},{children:i}):t?!l&&s?e.forEach(e=>{var t=c(e);(o[t]||s({row:e}))&&(v[t]=e)}):e.forEach(e=>{var t=c(e);v[t]=e}):!l&&s&&e.forEach(e=>{var t=c(e);!s({row:e})&&o[t]&&(v[t]=e)}),u&&(t?_xeUtils.default.each(v,(e,t)=>{a[t]=e}):e.forEach(e=>$t(e,!1))),B.updateCheckboxFlag++,W.selectCheckboxMaps=d?{}:v,B.isAllSelected=t,B.isIndeterminate=!1,W.treeIndeterminateRowMaps={},ie.checkSelectionStatus(),(0,_vue.nextTick)()},Kt=o=>{var e=oe.value,t=ee.value;let{transform:i,loadMethod:n}=e,d=t.checkStrictly;return new Promise(a=>{if(n){let{fullAllDataRowIdData:e,treeExpandLazyLoadedMaps:t}=W,l=(0,_util.getRowid)(ie,o),r=e[l];t[l]=o,Promise.resolve(n({$table:ie,row:o})).then(e=>{if(r&&(r.treeLoaded=!0),t[l]&&delete t[l],e=_xeUtils.default.isArray(e)?e:[])return ie.loadTreeChildren(o,e).then(e=>{var t=W.treeExpandedMaps;return e.length&&!t[l]&&(t[l]=o),B.treeExpandedFlag++,!d&&ie.isCheckedByCheckboxRow(o)&&p(e,!0),(0,_vue.nextTick)().then(()=>{if(i)return ie.handleTableData(),Pt(),(0,_vue.nextTick)()})})}).catch(()=>{var e=W.treeExpandLazyLoadedMaps;r&&(r.treeLoaded=!1),e[l]&&delete e[l]}).finally(()=>{B.treeExpandedFlag++,(0,_vue.nextTick)().then(()=>ie.recalculate()).then(()=>a())})}else a()})},Gt=(e,t)=>{var l,r=W.treeExpandedReserveRowMap;oe.value.reserve&&(l=(0,_util.getRowid)(ie,e),t?r[l]=e:r[l]&&delete r[l])},Zt=i=>new Promise(r=>{var e=ae.value.loadMethod;if(e){var{fullAllDataRowIdData:a,rowExpandLazyLoadedMaps:o}=W;let t=(0,_util.getRowid)(ie,i),l=a[t];o[t]=i,e({$table:ie,row:i,rowIndex:ie.getRowIndex(i),$rowIndex:ie.getVMRowIndex(i)}).then(()=>{var e=W.rowExpandedMaps;l&&(l.expandLoaded=!0),e[t]=i,B.rowExpandedFlag++}).catch(()=>{l&&(l.expandLoaded=!1)}).finally(()=>{var e=W.rowExpandLazyLoadedMaps;e[t]&&delete e[t],B.rowExpandedFlag++,(0,_vue.nextTick)().then(()=>ie.recalculate()).then(()=>ie.updateCellAreas()).then(()=>r())})}else r()}),Jt=(e,t)=>{var l,r=W.rowExpandedReserveRowMap;ae.value.reserve&&(l=(0,_util.getRowid)(ie,e),t?r[l]=e:r[l]&&delete r[l])},Qt=()=>(0,_vue.nextTick)().then(()=>{var e,{scrollXLoad:t,scrollYLoad:l}=B,{scrollXStore:r,scrollYStore:a}=W,o=m.value,i=f.value,i=(t?({toVisibleIndex:t,visibleSize:e}=bt(),n=Math.max(0,i.oSize?_xeUtils.default.toNumber(i.oSize):0),r.preloadSize=_xeUtils.default.toNumber(i.preSize),r.offsetSize=n,r.visibleSize=e,r.endIndex=Math.max(r.startIndex+r.visibleSize+n,r.endIndex),r.visibleStartIndex=Math.max(r.startIndex,t),r.visibleEndIndex=Math.min(r.endIndex,t+e),ie.updateScrollXData().then(()=>{il()})):ie.updateScrollXSpace(),Et()),{toVisibleIndex:n,visibleSize:r}=(a.rowHeight=i,B.rowHeight=i,yt());l?(t=Math.max(0,o.oSize?_xeUtils.default.toNumber(o.oSize):0),a.preloadSize=_xeUtils.default.toNumber(o.preSize),a.offsetSize=t,a.visibleSize=r,a.endIndex=Math.max(a.startIndex+r+t,a.endIndex),a.visibleStartIndex=Math.max(a.startIndex,n),a.visibleEndIndex=Math.min(a.endIndex,n+r),ie.updateScrollYData().then(()=>{vl()})):ie.updateScrollYSpace(),(0,_vue.nextTick)(()=>{b()})}),el=e=>{var t,l,r,a=q.value;return W.rceRunTime=Date.now(),a&&a.clientWidth?((a=he.value)&&([a,t,l,r]=a.children,Rt("default",a),Rt("medium",t),Rt("small",l),Rt("mini",r)),At(),Ot(),b(),xl(),Qt().then(()=>{if(!0===e)return At(),Ot(),b(),e&&M(),xl(),Qt()})):(0,_vue.nextTick)()},tl=(e,t)=>{var{keepSource:l,treeConfig:r}=V;let o=B.scrollYLoad,{scrollYStore:a,scrollXStore:i,lastScrollLeft:n,lastScrollTop:d}=W;var u=oe.value,s=u.transform,c=u.children||u.childrenField;let g=[],v=(0,_vue.reactive)(e?e.slice(0):[]),h=(v.length>supportMaxRow&&(0,_log.errLog)("vxe.error.errMaxRow",[supportMaxRow]),r&&(s?(u.rowField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.rowField"]),u.parentField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.parentField"]),c||(0,_log.errLog)("vxe.error.reqProp",["tree-config.childrenField"]),u.mapChildrenField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.mapChildrenField"]),c===u.mapChildrenField&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config.childrenField","tree-config.mapChildrenField"]),g=_xeUtils.default.toArrayTree(v,{key:u.rowField,parentKey:u.parentField,children:c,mapChildren:u.mapChildrenField}),v=g.slice(0)):g=v.slice(0)),a.startIndex=0,a.endIndex=1,i.startIndex=0,i.endIndex=1,B.isRowLoading=!0,B.scrollVMLoading=!1,W.insertRowMaps={},W.removeRowMaps={},sl(v));return B.isDragColMove=!1,B.isDragRowMove=!1,W.tableFullData=v,W.tableFullTreeData=g,ie.cacheRowMap(!0),W.tableSynchData=e,t&&(W.isResizeCellHeight=!1),l&&ie.cacheSourceMap(v),ie.clearCellAreas&&V.mouseConfig&&(ie.clearCellAreas(),ie.clearCopyCellArea()),ie.clearMergeCells(),ie.clearMergeFooterItems(),ie.handleTableData(!0),ie.updateFooter(),(0,_vue.nextTick)().then(()=>{kt(),b()}).then(()=>{Qt()}).then(()=>(h&&(a.endIndex=a.visibleSize),h&&(V.height||V.maxHeight||(0,_log.errLog)("vxe.error.reqProp",["table.height | table.max-height | table.scroll-y={enabled: false}"]),V.spanMethod)&&(0,_log.errLog)("vxe.error.scrollErrProp",["table.span-method"]),(()=>{var e=V.treeConfig,{expandColumn:t,currentRow:l,selectRadioRow:r}=B,{fullDataRowIdData:a,fullAllDataRowIdData:o,radioReserveRow:i,selectCheckboxMaps:n,treeExpandedMaps:d,rowExpandedMaps:u}=W,s=ae.value,c=oe.value,g=D.value,v=ee.value;r&&!o[(0,_util.getRowid)(ie,r)]&&(B.selectRadioRow=null),g.reserve&&i&&a[r=(0,_util.getRowid)(ie,i)]&&Xt(a[r].row,!0),W.selectCheckboxMaps=wt(n),B.updateCheckboxFlag++,v.reserve&&p(Ct(W.checkboxReserveRowMap),!0,!0),l&&!o[(0,_util.getRowid)(ie,l)]&&(B.currentRow=null),W.rowExpandedMaps=t?wt(u):{},B.rowExpandedFlag++,t&&s.reserve&&ie.setRowExpand(Ct(W.rowExpandedReserveRowMap),!0),W.treeExpandedMaps=e?wt(d):{},B.treeExpandedFlag++,e&&c.reserve&&ie.setTreeExpand(Ct(W.treeExpandedReserveRowMap),!0)})(),ie.checkSelectionStatus(),new Promise(a=>{(0,_vue.nextTick)().then(()=>ie.recalculate()).then(()=>{let e=n,t=d;var l=f.value,r=m.value;l.scrollToLeftOnChange&&(e=0),r.scrollToTopOnChange&&(t=0),B.isRowLoading=!1,zt(),M(),o===h?(0,_util.restoreScrollLocation)(ie,e,t).then(()=>{a()}):setTimeout(()=>{(0,_util.restoreScrollLocation)(ie,e,t).then(()=>{a()})})})})))},ll=()=>{var e,t,l;(()=>{var e=V.checkboxConfig;if(e){let l=W.fullDataRowIdData;var{checkAll:e,checkRowKeys:r}=ee.value;if(e)jt(!0,!0);else if(r){let t=[];r.forEach(e=>{l[e]&&t.push(l[e].row)}),p(t,!0,!0)}}})(),(l=V.radioConfig)&&(l=W.fullDataRowIdData,{checkRowKey:e,reserve:t}=D.value,e)&&(l[e]&&Xt(l[e].row,!0),t)&&(l=(0,_util.getRowkey)(ie),W.radioReserveRow={[l]:e}),(()=>{var e=V.expandConfig;if(e){let l=W.fullDataRowIdData;var{expandAll:e,expandRowKeys:r}=ae.value;if(e)ie.setAllRowExpand(!0);else if(r){let t=[];r.forEach(e=>{l[e]&&t.push(l[e].row)}),ie.setRowExpand(t,!0)}}})(),(()=>{var e=V.treeConfig;if(e){let a=W.tableFullData;var e=oe.value,{expandAll:t,expandRowKeys:i}=e;let o=e.children||e.childrenField;if(t)ie.setAllTreeExpand(!0);else if(i){let l=[],r=(0,_util.getRowkey)(ie);i.forEach(t=>{var e=_xeUtils.default.findTree(a,e=>t===_xeUtils.default.get(e,r),{children:o});e&&l.push(e.item)}),ie.setTreeExpand(l,!0)}}})(),(t=V.mergeCells)&&ie.setMergeCells(t),(l=V.mergeFooterItems)&&ie.setMergeFooterItems(l),(0,_vue.nextTick)(()=>setTimeout(()=>ie.recalculate()))},rl=()=>{(()=>{var t=V.sortConfig;if(t){var l=R.value;let e=l.defaultSort;e&&(e=_xeUtils.default.isArray(e)?e:[e]).length&&((t.multiple?e:e.slice(0,1)).forEach((e,t)=>{var{field:e,order:l}=e;e&&l&&(e=ie.getColumnByField(e))&&e.sortable&&(e.order=l,e.sortTime=Date.now()+t)}),l.remote||ie.handleTableData(!0).then(b))}})()},al=()=>{var e=B.scrollXLoad;let{visibleColumn:t,scrollXStore:l,fullColumnIdData:r}=W;e=e?t.slice(l.startIndex,l.endIndex):t.slice(0);e.forEach((e,t)=>{e=e.id,e=r[e];e&&(e.$index=t)}),B.tableColumn=e},ol=()=>{var e=_xeUtils.default.orderBy(W.collectColumn,"renderSortNumber"),e=(W.collectColumn=e,nl(e));W.tableFullColumn=e,Ft()},il=()=>{var{mergeList:e,mergeFooterList:t,isScrollXBig:l}=B,r=W.scrollXStore,{preloadSize:a,startIndex:o,endIndex:i,offsetSize:n}=r,{toVisibleIndex:d,visibleSize:u}=bt(),l={startIndex:Math.max(0,l?d-1:d-1-n-a),endIndex:l?d+u:d+u+n+a},{startIndex:n,endIndex:a}=(r.visibleStartIndex=d-1,r.visibleEndIndex=d+u+1,St(e.concat(t),l,"col"),l);!(d<=o||i-u-1<=d)||o===n&&i===a||(r.startIndex=n,r.endIndex=a,ie.updateScrollXData()),ie.closeTooltip()},nl=e=>{let t=[];return e.forEach(e=>{t.push(...e.children&&e.children.length?nl(e.children):[e])}),t},dl=e=>{let i=[],n=[],d=[];var{isGroup:t,columnStore:l}=B,r=f.value;let{collectColumn:a,tableFullColumn:o,scrollXStore:u,fullColumnIdData:s}=W;if(t){let t=[],l=[],r=[];_xeUtils.default.eachTree(a,(e,t,l,r,a)=>{var o=(0,_utils.hasChildrenList)(e);a&&a.fixed&&(e.fixed=a.fixed),a&&e.fixed!==a.fixed&&(0,_log.errLog)("vxe.error.groupFixed"),o?e.visible=!!_xeUtils.default.findTree(e.children,e=>!(0,_utils.hasChildrenList)(e)&&e.visible):e.visible&&("left"===e.fixed?i:"right"===e.fixed?d:n).push(e)}),a.forEach(e=>{e.visible&&("left"===e.fixed?t:"right"===e.fixed?r:l).push(e)}),B.tableGroupColumn=t.concat(l).concat(r)}else o.forEach(e=>{e.visible&&("left"===e.fixed?i:"right"===e.fixed?d:n).push(e)});let c=i.concat(n).concat(d);t=!!r.enabled&&-1<r.gt&&(0===r.gt||r.gt<o.length);return B.hasFixedColumn=0<i.length||0<d.length,Object.assign(l,{leftList:i,centerList:n,rightList:d}),t&&(V.spanMethod&&(0,_log.warnLog)("vxe.error.scrollErrProp",["span-method"]),V.footerSpanMethod&&(0,_log.warnLog)("vxe.error.scrollErrProp",["footer-span-method"]),e)&&(r=bt().visibleSize,u.startIndex=0,u.endIndex=r,u.visibleSize=r,u.visibleStartIndex=0,u.visibleEndIndex=r),c.length===W.visibleColumn.length&&W.visibleColumn.every((e,t)=>e===c[t])||(ie.clearMergeCells(),ie.clearMergeFooterItems()),B.scrollXLoad=t,c.forEach((e,t)=>{e=e.id,e=s[e];e&&(e._index=t)}),W.visibleColumn=c,al(),e?(pl(),ie.updateFooter().then(()=>ie.recalculate()).then(()=>(ie.updateCellAreas(),ie.recalculate()))):ie.updateFooter()},ul=e=>{let r=ae.value;W.collectColumn=e;e=nl(e);return W.tableFullColumn=e,B.isColLoading=!0,B.isDragColMove=!1,W.collectColumn.forEach((e,t)=>{t+=1;e.sortNumber=t,e.renderSortNumber=t}),Promise.resolve((()=>{var e=V.customConfig,t=A.value,l=I.value,{storage:r,restoreStore:a}=l,o=!0===r,r=o?{}:Object.assign({},r||{}),i=o||r.resizable,n=o||r.visible,d=o||r.fixed,o=o||r.sort;if((e?(0,_utils.isEnableConf)(l):l.enabled)&&(i||n||d||o)){if(t)return r=_t(t),a?Promise.resolve(a({id:t,type:"restore",storeData:r})).then(e=>{if(e)return Lt(e)}).catch(e=>e):Lt(r);(0,_log.errLog)("vxe.error.reqProp",["id"])}})()).then(()=>{var{scrollXLoad:e,scrollYLoad:t,expandColumn:l}=B;return Ft(),dl(!0).then(()=>{B.scrollXLoad&&il()}),ie.clearMergeCells(),ie.clearMergeFooterItems(),ie.handleTableData(!0),(e||t)&&l&&"fixed"!==r.mode&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),(0,_vue.nextTick)().then(()=>(U&&U.syncUpdate({collectColumn:W.collectColumn,$table:ie}),ie.handleUpdateCustomColumn&&ie.handleUpdateCustomColumn(),B.isColLoading=!1,ie.recalculate()))})},sl=e=>{var t=V.treeConfig,l=m.value,r=oe.value.transform,e=e||W.tableFullData,r=(r||!t)&&!!l.enabled&&-1<l.gt&&(0===l.gt||l.gt<e.length);return B.scrollYLoad=r},cl=(e,t)=>{let l=B.treeNodeColumn,{fullAllDataRowIdData:r,tableFullData:a,treeExpandedMaps:o,treeExpandLazyLoadedMaps:i}=W;var n=oe.value;let{reserve:d,lazy:u,accordion:s,toggleMethod:c}=n,g=n.children||n.childrenField,v=n.hasChild||n.hasChildField,h=[],f=P.getColumnIndex(l),m=P.getVMColumnIndex(l),p=(0,_util.createHandleGetRowId)(ie).handleGetRowId,x=c?e.filter(e=>c({$table:ie,expanded:t,column:l,columnIndex:f,$columnIndex:m,row:e})):e;return s&&(x=x.length?[x[x.length-1]]:[],n=_xeUtils.default.findTree(a,e=>e===x[0],{children:g}))&&n.items.forEach(e=>{e=p(e);o[e]&&delete o[e]}),t?x.forEach(e=>{var t,l=p(e);o[l]||(t=r[l])&&(u&&e[v]&&!t.treeLoaded&&!i[l]?h.push(Kt(e)):e[g]&&e[g].length&&(o[l]=e))}):x.forEach(e=>{e=p(e);o[e]&&delete o[e]}),d&&x.forEach(e=>Gt(e,t)),B.treeExpandedFlag++,Promise.all(h).then(()=>P.recalculate())},gl=(e,t)=>{jt(t),e&&ne("checkbox-all",{records:()=>ie.getCheckboxRecords(),reserves:()=>ie.getCheckboxReserveRecords(),indeterminates:()=>ie.getCheckboxIndeterminateRecords(),checked:t},e)},vl=()=>{var{mergeList:e,isAllOverflow:t,isScrollYBig:l}=B,r=W.scrollYStore,{preloadSize:a,startIndex:o,endIndex:i,offsetSize:n}=r,t=t?n:n+1,{toVisibleIndex:d,visibleSize:u}=yt(),n={startIndex:Math.max(0,l?d-1:d-1-n-a),endIndex:l?d+u:d+u+t+a},{startIndex:l,endIndex:t}=(r.visibleStartIndex=d-1,r.visibleEndIndex=d+u+1,St(e,n,"row"),n);!(d<=o||i-u-1<=d)||o===l&&i===t||(r.startIndex=l,r.endIndex=t,ie.updateScrollYData())};i=l=>{let r=(0,_util.createHandleGetRowId)(ie).handleGetRowId;return function(e){var t=W.fullAllDataRowIdData;if(e){t=t[r(e)];if(t)return t[l]}return-1}},n=l=>function(e){var t=W.fullColumnIdData;if(e){t=t[e.id];if(t)return t[l]}return-1};let ne=(e,t,l)=>{r(e,createEvent(l,{$table:ie,$grid:K},t))},hl=()=>{var e=q.value;e&&e.clientWidth&&e.clientHeight&&P.recalculate()},fl=(e,t)=>{ie.analyColumnWidth(),ie.recalculate().then(()=>{ie.saveCustomStore("update:width"),ie.updateCellAreas(),ie.dispatchEvent("column-resizable-change",t,e),ie.dispatchEvent("resizable-change",t,e),setTimeout(()=>ie.recalculate(!0),300)})},ml=(e,t)=>{B.resizeHeightFlag++,ie.recalculate().then(()=>{ie.updateCellAreas(),ie.dispatchEvent("row-resizable-change",t,e),setTimeout(()=>ie.recalculate(!0),300)})},pl=()=>{var{visibleColumn:l,fullColumnIdData:r}=W;let a=0;for(let e=0,t=l.length;e<t;e++){var o=l[e];r[o.id].oLeft=a,a+=o.renderWidth}},M=()=>{var l=B.expandColumn,{afterFullData:r,fullAllDataRowIdData:a,rowExpandedMaps:o}=W,i=ae.value,n=Z.value,d=y.value,u=E.value,s=(0,_util.createHandleGetRowId)(ie).handleGetRowId;let c=0;for(let e=0,t=r.length;e<t;e++){var g=s(r[e]),v=a[g]||{};v.oTop=c,c+=v.resizeHeight||d.height||n.height||v.height||u,l&&o[g]&&(c+=v.expandHeight||i.height||0)}},xl=()=>{let{expandColumn:e,scrollYLoad:d,scrollYTop:u,isScrollYBig:s}=B;var t=ae.value;let c=Z.value,g=y.value,v=E.value;t=t.mode;if(e&&"fixed"===t){let{elemStore:e,fullAllDataRowIdData:i}=W;t=j.value;let n=(0,_util.getRefElem)(e["main-body-scroll"]);if(t&&n){let o=!1;_xeUtils.default.arrayEach(t.children,t=>{var l=t.getAttribute("rowid")||"",r=i[l];if(r){var a=t.offsetHeight+1,l=n.querySelector(`.vxe-body--row[rowid="${l}"]`);let e=0;d?e=s&&l?l.offsetTop+l.offsetHeight:r.oTop+(r.resizeHeight||g.height||c.height||r.height||v):l&&(e=l.offsetTop+l.offsetHeight),s&&(e+=u),t.style.top=(0,_dom.toCssUnit)(e),o||r.expandHeight!==a&&(o=!0),r.expandHeight=a}}),o&&(B.rowExpandHeightFlag++,(0,_vue.nextTick)(()=>{M()}))}}},_l=()=>{var e=W.elemStore,t=j.value,e=(0,_util.getRefElem)(e["main-body-scroll"]);t&&e&&(t.scrollTop=e.scrollTop)},wl=(P={dispatchEvent:ne,getEl(){return q.value},clearAll(){return(0,_util.clearTableAllStatus)(ie)},syncData(){return(0,_log.warnLog)("vxe.error.delFunc",["syncData","getData"]),(0,_vue.nextTick)().then(()=>(B.tableData=[],r("update:data",W.tableFullData),(0,_vue.nextTick)()))},updateData(){let{scrollXLoad:e,scrollYLoad:t}=B;return Y.handleTableData(!0).then(()=>{if(P.updateFooter(),e||t)return e&&Y.updateScrollXSpace(),t&&Y.updateScrollYSpace(),P.refreshScroll()}).then(()=>(P.updateCellAreas(),P.recalculate(!0))).then(()=>{setTimeout(()=>ie.recalculate(),50)})},loadData(e){let t=W.initStatus;return tl(e,!1).then(()=>(W.inited=!0,W.initStatus=!0,t||ll(),P.recalculate()))},reloadData(e){return P.clearAll().then(()=>(W.inited=!0,W.initStatus=!0,tl(e,!0))).then(()=>(ll(),P.recalculate()))},setRow(t,a){if(t&&a){let e=t,r=(_xeUtils.default.isArray(t)||(e=[t]),(0,_util.getRowkey)(ie));e.forEach(e=>{var t=(0,_util.getRowid)(ie,e),l=_xeUtils.default.clone(Object.assign({},a),!0);_xeUtils.default.set(l,r,t),Object.assign(e,l)})}return(0,_vue.nextTick)()},reloadRow(e,t,l){var r=V.keepSource,a=B.tableData,o=W.tableSourceData;return r?((r=o[P.getRowIndex(e)])&&e&&(l?(o=_xeUtils.default.clone(_xeUtils.default.get(t||e,l),!0),_xeUtils.default.set(e,l,o),_xeUtils.default.set(r,l,o)):(l=(0,_util.getRowkey)(ie),o=(0,_util.getRowid)(ie,e),t=_xeUtils.default.clone(Object.assign({},t),!0),_xeUtils.default.set(t,l,o),_xeUtils.default.destructuring(r,Object.assign(e,t)))),B.tableData=a.slice(0)):"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)()},getParams(){return V.params},loadTreeChildren(r,e){let t=V.keepSource,{tableSourceData:a,fullDataRowIdData:n,fullAllDataRowIdData:d,sourceDataRowIdData:o}=W;var l=oe.value;let{transform:i,mapChildrenField:u}=l,s=l.children||l.childrenField,c=d[(0,_util.getRowid)(ie,r)],g=c?c.level:0;return P.createData(e).then(e=>{if(t){let t=(0,_util.getRowid)(ie,r);var l=_xeUtils.default.findTree(a,e=>t===(0,_util.getRowid)(ie,e),{children:s});l&&(l.item[s]=_xeUtils.default.clone(e,!0)),e.forEach(e=>{var t=(0,_util.getRowid)(ie,e);o[t]=_xeUtils.default.clone(e,!0)})}return _xeUtils.default.eachTree(e,(e,t,l,r,a,o)=>{var i=(0,_util.getRowid)(ie,e),e={row:e,rowid:i,seq:-1,index:t,_index:-1,$index:-1,treeIndex:-1,items:l,parent:a||c.row,level:g+o.length,height:0,resizeHeight:0,oTop:0,expandHeight:0};n[i]=e,d[i]=e},{children:s}),r[s]=e,i&&(r[u]=_xeUtils.default.clone(e,!1)),Pt(),e})},loadColumn(e){e=_xeUtils.default.mapTree(e,e=>(0,_vue.reactive)(_cell.default.createColumn(ie,e)));return ul(e)},reloadColumn(e){return P.clearAll().then(()=>P.loadColumn(e))},getRowNode(e){if(e){var t=W.fullAllDataRowIdData,e=e.getAttribute("rowid");if(e){t=t[e];if(t)return{rowid:t.rowid,item:t.row,index:t.index,items:t.items,parent:t.parent}}}return null},getColumnNode(e){if(e){var t=W.fullColumnIdData,e=e.getAttribute("colid");if(e){t=t[e];if(t)return{colid:t.colid,item:t.column,index:t.index,items:t.items,parent:t.parent}}}return null},getRowSeq:i("seq"),getRowIndex:i("index"),getVTRowIndex:i("_index"),getVMRowIndex:i("$index"),getColumnIndex:n("index"),getVTColumnIndex:n("_index"),getVMColumnIndex:n("$index"),createData(e){return(0,_vue.nextTick)().then(()=>(0,_vue.reactive)(Y.defineField(e)))},createRow(e){let t=_xeUtils.default.isArray(e);return t||(e=[e||{}]),P.createData(e).then(e=>t?e:e[0])},revertData(e,r){var{keepSource:t,treeConfig:l}=V;let{fullAllDataRowIdData:a,fullDataRowIdData:o,tableSourceData:i,sourceDataRowIdData:n,tableFullData:d,afterFullData:u,removeRowMaps:s}=W;var c=oe.value.transform;let g=(0,_util.createHandleGetRowId)(ie).handleGetRowId;if(!t)return"development"===process.env.NODE_ENV&&(0,_log.errLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)();let v=e,h=(e?_xeUtils.default.isArray(e)||(v=[e]):v=_xeUtils.default.toArray(ie.getUpdateRecords()),!1);return v.length&&v.forEach(e=>{var t,e=g(e),l=a[e];l&&(l=l.row,ie.isInsertByRow(l)||(t=n[e])&&l&&(r?_xeUtils.default.set(l,r,_xeUtils.default.clone(_xeUtils.default.get(t,r),!0)):_xeUtils.default.destructuring(l,_xeUtils.default.clone(t,!0)),!o[e])&&ie.isRemoveByRow(l)&&(s[e]&&delete s[e],d.unshift(l),u.unshift(l),h=!0))}),e?(h&&(B.removeRowFlag++,ie.updateFooter(),ie.cacheRowMap(!1),ie.handleTableData(l&&c),l&&c||ie.updateAfterDataIndex(),ie.checkSelectionStatus(),B.scrollYLoad)&&ie.updateScrollYSpace(),(0,_vue.nextTick)().then(()=>(ie.updateCellAreas(),ie.recalculate()))):ie.reloadData(i)},clearData(e,t){let{tableFullData:l,visibleColumn:r}=W;return arguments.length?e&&!_xeUtils.default.isArray(e)&&(e=[e]):e=l,t?e.forEach(e=>_xeUtils.default.set(e,t,null)):e.forEach(t=>{r.forEach(e=>{e.field&&(0,_util.setCellValue)(t,e,null)})}),(0,_vue.nextTick)()},getCellElement(e,t){var l=W.elemStore,t=(0,_util.handleFieldOrColumn)(ie,t);if(!t)return null;var e=(0,_util.getRowid)(ie,e),r=(0,_util.getRefElem)(l["main-body-scroll"]),a=(0,_util.getRefElem)(l["left-body-scroll"]),l=(0,_util.getRefElem)(l["right-body-scroll"]);let o;return t&&(t.fixed&&("left"===t.fixed?a&&(o=a):l&&(o=l)),o=o||r)?o.querySelector(`.vxe-body--row[rowid="${e}"] .`+t.id):null},getCellLabel(t,l){l=(0,_util.handleFieldOrColumn)(ie,l);if(!l)return null;var r=l.formatter,a=(0,_util.getCellValue)(t,l);let o=a;if(r){let e;var i=W.fullAllDataRowIdData,n=(0,_util.getRowid)(ie,t),d=l.id,u=i[n];if(u&&(e=(e=u.formatData)||(i[n].formatData={}),u)&&e[d]&&e[d].value===a)return e[d].label;i={cellValue:a,row:t,rowIndex:P.getRowIndex(t),column:l,columnIndex:P.getColumnIndex(l)};o=_xeUtils.default.isString(r)?(u=(n=formats.get(r))?n.tableCellFormatMethod||n.cellFormatMethod:null)?u(i):"":_xeUtils.default.isArray(r)?(l=(t=formats.get(r[0]))?t.tableCellFormatMethod||t.cellFormatMethod:null)?l(i,...r.slice(1)):"":r(i),e&&(e[d]={value:a,label:o})}return o},isInsertByRow(e){e=(0,_util.getRowid)(ie,e);return!!B.insertRowFlag&&!!W.insertRowMaps[e]},isRemoveByRow(e){e=(0,_util.getRowid)(ie,e);return!!B.removeRowFlag&&!!W.removeRowMaps[e]},removeInsertRow(){return W.insertRowMaps={},ie.remove(ie.getInsertRecords())},isUpdateByRow(e,t){var l=V.keepSource,{tableFullColumn:r,fullDataRowIdData:a,sourceDataRowIdData:o}=W;if(l){l=_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?e:(0,_util.getRowid)(ie,e),e=a[l];if(!e)return!1;var i=e.row,n=o[l];if(n){if(1<arguments.length)return!pt(n,i,t);for(let e=0,t=r.length;e<t;e++){var d=r[e].field;if(d&&!pt(n,i,d))return!0}}}return!1},getColumns(e){var t=W.visibleColumn;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getColid(e){e=(0,_util.handleFieldOrColumn)(ie,e);return e?e.id:null},getColumnById(e){var t=W.fullColumnIdData;return e&&t[e]?t[e].column:null},getColumnByField(e){var t=W.fullColumnFieldData;return e&&t[e]?t[e].column:null},getParentColumn(e){var t=W.fullColumnIdData,e=(0,_util.handleFieldOrColumn)(ie,e);return e&&e.parentId&&t[e.parentId]?t[e.parentId].column:null},getTableColumn(){return{collectColumn:W.collectColumn.slice(0),fullColumn:W.tableFullColumn.slice(0),visibleColumn:W.visibleColumn.slice(0),tableColumn:B.tableColumn.slice(0)}},moveColumnTo(e,l,t){var{fullColumnIdData:r,visibleColumn:a}=W,{dragToChild:t,dragPos:o,isCrossDrag:i}=Object.assign({},t),e=(0,_util.handleFieldOrColumn)(ie,e);let n=null;var d=e?r[e.id]:null;let u="left";if(_xeUtils.default.isNumber(l)){if(d&&l){let e=d.items,t=d._index+l;i&&(e=a,t=d._index+l),0<t&&t<e.length-1&&(n=e[t]),0<l&&(u="right")}}else{i=(n=(0,_util.handleFieldOrColumn)(ie,l))?r[n.id]:null;d&&i&&i._index>d._index&&(u="right")}return ie.handleColDragSwapEvent(null,!0,e,n,o||u,!0===t)},moveRowTo(e,l,t){var r=V.treeConfig,{fullAllDataRowIdData:a,afterFullData:o}=W,{dragToChild:t,dragPos:i,isCrossDrag:n}=Object.assign({},t),d=oe.value,e=(0,_util.handleRowidOrRow)(ie,e);let u=null,s="top";var c=e?a[(0,_util.getRowid)(ie,e)]:null;if(_xeUtils.default.isNumber(l)){if(c&&l){let e=o,t=c._index+l;r&&(e=c.items,d.transform)&&(t=c.treeIndex+l,n)&&(e=o,t=c._index+l),0<=t&&t<=e.length-1&&(u=e[t]),0<l&&(s="bottom")}}else{r=(u=(0,_util.handleRowidOrRow)(ie,l))?a[(0,_util.getRowid)(ie,u)]:null;c&&r&&r._index>c._index&&(s="bottom")}return ie.handleRowDragSwapEvent(null,!0,e,u,i||s,!0===t)},getFullColumns(){var e=W.collectColumn;return e.slice(0)},getData(e){var t=V.data||W.tableSynchData;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getCheckboxRecords(l){var e=V.treeConfig;let{tableFullData:t,afterFullData:r,afterTreeFullData:a,tableFullTreeData:o,fullDataRowIdData:i,afterFullRowMaps:n,selectCheckboxMaps:d}=W;var u=oe.value,{transform:s,mapChildrenField:c}=u;let g=ee.value.checkField;u=u.children||u.childrenField;let v=[];return g?v=e?_xeUtils.default.filterTree(l?s?o:t:s?a:r,e=>_xeUtils.default.get(e,g),{children:s?c:u}):(l?t:r).filter(e=>_xeUtils.default.get(e,g)):_xeUtils.default.each(d,(e,t)=>{l?i[t]&&v.push(i[t].row):n[t]&&v.push(n[t])}),v},getTreeRowChildren(t){var l=V.treeConfig,r=W.fullAllDataRowIdData,a=oe.value,{transform:o,mapChildrenField:i}=a,a=a.children||a.childrenField;if(t&&l){let e;if(e=_xeUtils.default.isString(t)?t:(0,_util.getRowid)(ie,t)){l=r[e],t=l?l.row:null;if(t)return t[o?i:a]||[]}}return[]},getTreeParentRow(t){var l=V.treeConfig,r=W.fullAllDataRowIdData;if(t&&l){let e;if(e=_xeUtils.default.isString(t)?t:(0,_util.getRowid)(ie,t))return(l=r[e])?l.parent:null}return null},getParentRow(e){return(0,_log.warnLog)("vxe.error.delFunc",["getParentRow","getTreeParentRow"]),ie.getTreeParentRow(e)},getRowById(e){var t=W.fullAllDataRowIdData,e=_xeUtils.default.eqNull(e)?"":encodeURIComponent(e||"");return t[e]?t[e].row:null},getRowid(e){return(0,_util.getRowid)(ie,e)},getTableData(){var{tableData:e,footerTableData:t}=B,{tableFullData:l,afterFullData:r,tableFullTreeData:a}=W;return{fullData:(V.treeConfig?a:l).slice(0),visibleData:r.slice(0),tableData:e.slice(0),footerData:t.slice(0)}},getFullData(){var e,t,l,r,a=V.treeConfig,{tableFullData:o,tableFullTreeData:i}=W;return a?({transform:e,mapChildrenField:t,rowField:l,parentField:r}=a=oe.value,a=a.children||a.childrenField,e?_xeUtils.default.toArrayTree(_xeUtils.default.toTreeArray(i,{children:t}),{key:l,parentKey:r,children:a,mapChildren:t}):i.slice(0)):o.slice(0)},setColumnFixed(e,t){let l=!1;var r=_xeUtils.default.isArray(e)?e:[e],a=G.value,o=ct.value;for(let e=0;e<r.length;e++){var i=r[e],i=(0,_util.handleFieldOrColumn)(ie,i),i=(0,_util.getRootColumn)(ie,i);if(i&&i.fixed!==t){if(!i.fixed&&o)return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.table.maxFixedCol",[a.maxFixedSize])}),(0,_vue.nextTick)();_xeUtils.default.eachTree([i],e=>{e.fixed=t}),Y.saveCustomStore("update:fixed"),l=l||!0}}return l?P.refreshColumn():(0,_vue.nextTick)()},clearColumnFixed(e){let t=!1;return(_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{e=(0,_util.handleFieldOrColumn)(ie,e),e=(0,_util.getRootColumn)(ie,e);e&&e.fixed&&(_xeUtils.default.eachTree([e],e=>{e.fixed=null}),Y.saveCustomStore("update:fixed"),t=t||!0)}),t?P.refreshColumn():(0,_vue.nextTick)()},hideColumn(e){let t=!1;return(_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{e=(0,_util.handleFieldOrColumn)(ie,e);e&&e.visible&&(e.visible=!1,t=t||!0)}),t?Y.handleCustom():(0,_vue.nextTick)()},showColumn(e){let t=!1;return(_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{e=(0,_util.handleFieldOrColumn)(ie,e);e&&!e.visible&&(e.visible=!0,t=t||!0)}),t?Y.handleCustom():(0,_vue.nextTick)()},setColumnWidth(e,t){var l=W.elemStore;let r=!1;e=_xeUtils.default.isArray(e)?e:[e];let a=_xeUtils.default.toInteger(t);return(0,_dom.isScale)(t)&&(l=(t=(0,_util.getRefElem)(l["main-body-scroll"]))?t.clientWidth-1:0,a=Math.floor(a*l)),(a&&(e.forEach(e=>{e=(0,_util.handleFieldOrColumn)(ie,e);e&&(e.resizeWidth=a,r=r||!0)}),r)?ie.refreshColumn():(0,_vue.nextTick)()).then(()=>({status:r}))},getColumnWidth(e){e=(0,_util.handleFieldOrColumn)(ie,e);return e?e.renderWidth:0},resetColumn(e){return(0,_log.warnLog)("vxe.error.delFunc",["resetColumn","resetCustom"]),ie.resetCustom(e)},refreshColumn(e){return e&&ol(),dl(!0).then(()=>P.refreshScroll()).then(()=>P.recalculate())},setRowHeightConf(e){let l=W.fullAllDataRowIdData,r=!1;return e&&(_xeUtils.default.each(e,(e,t)=>{t=l[t];t&&(e=_xeUtils.default.toInteger(e))&&(t.resizeHeight=e,r=r||!0)}),r)&&(W.isResizeCellHeight=!0,B.resizeHeightFlag++),(0,_vue.nextTick)().then(()=>(M(),{status:r}))},getRowHeightConf(r){let{fullAllDataRowIdData:a,afterFullData:e}=W,o=(0,_util.createHandleGetRowId)(ie).handleGetRowId,i=Z.value,n=y.value,d=E.value,u={};return e.forEach(e=>{var t,e=o(e),l=a[e];l&&((t=l.resizeHeight)||r)&&(t=t||n.height||i.height||l.height||d,u[e]=t)}),u},setRowHeight(e,t){let l=W.fullAllDataRowIdData,r=!1;e=_xeUtils.default.isArray(e)?e:[e];let a=_xeUtils.default.toInteger(t);if((0,_dom.isScale)(t)&&(t=(t=(t=_.value)?t.$el:null)?t.clientHeight-1:0,a=Math.floor(a*t)),a){let t=(0,_util.createHandleGetRowId)(ie).handleGetRowId;e.forEach(e=>{e=_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?e:t(e),e=l[e];e&&(e.resizeHeight=a,r=r||!0)}),r&&(W.isResizeCellHeight=!0,B.resizeHeightFlag++)}return(0,_vue.nextTick)().then(()=>({status:r}))},getRowHeight(e){var t=W.fullAllDataRowIdData,l=Z.value,r=y.value,a=E.value,t=t[_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?e:(0,_util.getRowid)(ie,e)];return t?t.resizeHeight||r.height||l.height||t.height||a:0},refreshScroll(){let{elemStore:e,lastScrollLeft:t,lastScrollTop:l}=W,r=(0,_util.getRefElem)(e["main-header-scroll"]),a=(0,_util.getRefElem)(e["main-body-scroll"]),o=(0,_util.getRefElem)(e["main-footer-scroll"]),i=(0,_util.getRefElem)(e["left-body-scroll"]),n=(0,_util.getRefElem)(e["right-body-scroll"]),d=S.value,u=T.value;return new Promise(e=>{if(t||l)return(0,_util.restoreScrollLocation)(ie,t,l).then().then(()=>{setTimeout(e,10)});W.intoRunScroll=!0,(0,_dom.setScrollTop)(u,l),(0,_dom.setScrollTop)(a,l),(0,_dom.setScrollTop)(i,l),(0,_dom.setScrollTop)(n,l),(0,_dom.setScrollLeft)(d,t),(0,_dom.setScrollLeft)(a,t),(0,_dom.setScrollLeft)(r,t),(0,_dom.setScrollLeft)(o,t),setTimeout(()=>{W.intoRunScroll=!1,e()},10)})},recalculate(o){return new Promise(e=>{var{rceTimeout:t,rceRunTime:l}=W,r=ze.value.refreshDelay||20,a=q.value;a&&a.clientWidth&&(Ot(),xl()),!t||(clearTimeout(t),l&&l+(r-5)<Date.now())?e(el(!!o)):(0,_vue.nextTick)(()=>{e()}),W.rceTimeout=setTimeout(()=>{W.rceTimeout=void 0,el(!!o)},r)})},openTooltip(e,t){var l=fe.value;return l&&l.open?l.open(e,t):(0,_vue.nextTick)()},closeTooltip(){var e=B.tooltipStore,t=$.value,l=fe.value;return e.visible&&(Object.assign(e,{row:null,column:null,content:null,visible:!1,currOpts:{}}),t)&&t.close&&t.close(),l&&l.close&&l.close(),(0,_vue.nextTick)()},isAllCheckboxChecked(){return B.isAllSelected},isAllCheckboxIndeterminate(){return!B.isAllSelected&&B.isIndeterminate},getCheckboxIndeterminateRecords(e){var t=V.treeConfig;let{fullDataRowIdData:a,treeIndeterminateRowMaps:o}=W;if(t){let l=[],r=[];return _xeUtils.default.each(o,(e,t)=>{e&&(l.push(e),a[t])&&r.push(e)}),e?l:r}return[]},setCheckboxRow(e,t){return e&&!_xeUtils.default.isArray(e)&&(e=[e]),p(e,t,!0)},setCheckboxRowKey(e,t){let l=W.fullAllDataRowIdData,r=(_xeUtils.default.isArray(e)||(e=[e]),[]);return e.forEach(e=>{e=l[e];e&&r.push(e.row)}),p(r,t,!0)},isCheckedByCheckboxRow(e){var t=B.updateCheckboxFlag,l=W.selectCheckboxMaps,r=ee.value.checkField;return r?_xeUtils.default.get(e,r):!!t&&!!l[(0,_util.getRowid)(ie,e)]},isCheckedByCheckboxRowKey(e){var t=B.updateCheckboxFlag,{fullAllDataRowIdData:l,selectCheckboxMaps:r}=W,a=ee.value.checkField;return a?!!(l=l[e])&&_xeUtils.default.get(l.row,a):!!t&&!!r[e]},isIndeterminateByCheckboxRow(e){var t=W.treeIndeterminateRowMaps;return!!t[(0,_util.getRowid)(ie,e)]&&!ie.isCheckedByCheckboxRow(e)},isIndeterminateByCheckboxRowKey(e){var t=W.treeIndeterminateRowMaps;return!!t[e]&&!ie.isCheckedByCheckboxRowKey(e)},toggleCheckboxRow(e){var t=W.selectCheckboxMaps,l=ee.value.checkField,l=l?!_xeUtils.default.get(e,l):!t[(0,_util.getRowid)(ie,e)];return Y.handleBatchSelectRows([e],l,!0),Y.checkSelectionStatus(),(0,_vue.nextTick)()},setAllCheckboxRow(e){return jt(e,!0)},getRadioReserveRecord(e){var r=V.treeConfig,{fullDataRowIdData:t,radioReserveRow:a,afterFullData:o}=W,l=D.value,i=oe.value,i=i.children||i.childrenField;if(l.reserve&&a){let l=(0,_util.getRowid)(ie,a);if(e){if(!t[l])return a}else{let t=(0,_util.getRowkey)(ie);if(r){if(_xeUtils.default.findTree(o,e=>l===_xeUtils.default.get(e,t),{children:i}))return a}else if(!o.some(e=>l===_xeUtils.default.get(e,t)))return a}}return null},clearRadioReserve(){return(W.radioReserveRow=null,_vue.nextTick)()},getCheckboxReserveRecords(r){var e=V.treeConfig;let{afterFullData:a,fullDataRowIdData:o,checkboxReserveRowMap:i}=W;var t=ee.value,n=oe.value,n=n.children||n.childrenField;let d=[];if(t.reserve){let t=(0,_util.createHandleGetRowId)(ie).handleGetRowId,l={};e?_xeUtils.default.eachTree(a,e=>{l[t(e)]=1},{children:n}):a.forEach(e=>{l[t(e)]=1}),_xeUtils.default.each(i,(e,t)=>{e&&(r?o[t]||d.push(e):l[t]||d.push(e))})}return d},clearCheckboxReserve(){return W.checkboxReserveRowMap={},(0,_vue.nextTick)()},toggleAllCheckboxRow(){return gl(null,!B.isAllSelected),(0,_vue.nextTick)()},clearCheckboxRow(){let t=V.treeConfig;var e=W.tableFullData,l=oe.value,l=l.children||l.childrenField,r=ee.value;let{checkField:a,reserve:o}=r,i=r.indeterminateField||r.halfField;return a&&(r=e=>{t&&i&&_xeUtils.default.set(e,i,!1),_xeUtils.default.set(e,a,!1)},t?_xeUtils.default.eachTree(e,r,{children:l}):e.forEach(r)),o&&e.forEach(e=>$t(e,!1)),B.isAllSelected=!1,B.isIndeterminate=!1,W.selectCheckboxMaps={},W.treeIndeterminateRowMaps={},B.updateCheckboxFlag++,(0,_vue.nextTick)()},setCurrentRow(e){var t=Z.value,l=q.value;return P.clearCurrentRow(),B.currentRow=e,(t.isCurrent||V.highlightCurrentRow)&&l&&_xeUtils.default.arrayEach(l.querySelectorAll(`[rowid="${(0,_util.getRowid)(ie,e)}"]`),e=>(0,_dom.addClass)(e,"row--current")),(0,_vue.nextTick)()},isCheckedByRadioRow(e){var t=B.selectRadioRow;return!(!e||!t)&&ie.eqRow(t,e)},isCheckedByRadioRowKey(e){var t=B.selectRadioRow;return!!t&&e===(0,_util.getRowid)(ie,t)},setRadioRow(e){return Xt(e,!0)},setRadioRowKey(e){var t=W.fullAllDataRowIdData,t=t[e];return t?Xt(t.row,!0):(0,_vue.nextTick)()},clearCurrentRow(){var e=q.value;return B.currentRow=null,W.hoverRow=null,e&&_xeUtils.default.arrayEach(e.querySelectorAll(".row--current"),e=>(0,_dom.removeClass)(e,"row--current")),(0,_vue.nextTick)()},clearRadioRow(){return(B.selectRadioRow=null,_vue.nextTick)()},getCurrentRecord(){return Z.value.isCurrent||V.highlightCurrentRow?B.currentRow:null},getRadioRecord(e){var{fullDataRowIdData:t,afterFullRowMaps:l}=W,r=B.selectRadioRow;if(r){var a=(0,_util.getRowid)(ie,r);if(e){if(t[a])return r}else if(l[a])return r}return null},getCurrentColumn(){return G.value.isCurrent||V.highlightCurrentColumn?B.currentColumn:null},setCurrentColumn(e){var t=V.mouseConfig,l=le.value;let r=t&&l.selected;t=(0,_util.handleFieldOrColumn)(ie,e);return t&&(ie.clearCurrentColumn(),B.currentColumn=t),(0,_vue.nextTick)().then(()=>{r&&ie.addCellSelectedClass()})},clearCurrentColumn(){return(B.currentColumn=null,_vue.nextTick)()},setPendingRow(e,t){let l=(0,_util.createHandleGetRowId)(ie).handleGetRowId,r=W.pendingRowMaps;return e&&!_xeUtils.default.isArray(e)&&(e=[e]),t?e.forEach(e=>{var t=l(e);t&&!r[t]&&(r[t]=e)}):e.forEach(e=>{e=l(e);e&&r[e]&&delete r[e]}),B.pendingRowFlag++,(0,_vue.nextTick)()},togglePendingRow(e){let l=(0,_util.createHandleGetRowId)(ie).handleGetRowId,r=W.pendingRowMaps;return(e=e&&!_xeUtils.default.isArray(e)?[e]:e).forEach(e=>{var t=l(e);t&&(r[t]?delete r[t]:r[t]=e)}),B.pendingRowFlag++,(0,_vue.nextTick)()},hasPendingByRow(e){return P.isPendingByRow(e)},isPendingByRow(e){var t=W.pendingRowMaps;return!!t[(0,_util.getRowid)(ie,e)]},getPendingRecords(){let{fullAllDataRowIdData:l,pendingRowMaps:e}=W,r=[];return _xeUtils.default.each(e,(e,t)=>{l[t]&&r.push(e)}),r},clearPendingRow(){return W.pendingRowMaps={},B.pendingRowFlag++,(0,_vue.nextTick)()},sort(e,t){let{multiple:l,remote:r,orders:o}=R.value;return e&&_xeUtils.default.isString(e)&&(e=[{field:e,order:t}]),(e=_xeUtils.default.isArray(e)?e:[e]).length?(l||It(),(l?e:[e[0]]).forEach((e,t)=>{let{field:l,order:r}=e,a=l;(a=_xeUtils.default.isString(l)?P.getColumnByField(l):a)&&a.sortable&&(-1===o.indexOf(r)&&(r=xt(a)),a.order!==r&&(a.order=r),a.sortTime=Date.now()+t)}),r||Y.handleTableData(!0),(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b()))):(0,_vue.nextTick)()},setSort(e,t){let{multiple:l,remote:r,orders:i}=R.value;if((e=_xeUtils.default.isArray(e)?e:[e])&&e.length){l||(e=[e[0]],It());let o=null;return e.forEach((e,t)=>{let{field:l,order:r}=e,a=l;_xeUtils.default.isString(l)&&(a=P.getColumnByField(l)),o=o||a,a&&a.sortable&&(-1===i.indexOf(r)&&(r=xt(a)),a.order!==r&&(a.order=r),a.sortTime=Date.now()+t)}),t&&(r||Y.handleTableData(!0),ie.handleColumnSortEvent(new Event("click"),o)),(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b()))}return(0,_vue.nextTick)()},clearSort(e){var t=R.value;return e?(e=(0,_util.handleFieldOrColumn)(ie,e))&&(e.order=null):It(),t.remote||Y.handleTableData(!0),(0,_vue.nextTick)().then(b)},isSort(e){return e?!!(e=(0,_util.handleFieldOrColumn)(ie,e))&&e.sortable&&!!e.order:0<P.getSortColumns().length},getSortColumns(){var{multiple:e,chronological:t}=R.value;let r=[];var l=W.tableFullColumn;return l.forEach(e=>{var{field:t,order:l}=e;e.sortable&&l&&r.push({column:e,field:t,property:t,order:l,sortTime:e.sortTime})}),e&&t&&1<r.length?_xeUtils.default.orderBy(r,"sortTime"):r},closeFilter(){var e=B.filterStore,{column:t,visible:l}=e;return Object.assign(e,{isAllSelected:!1,isIndeterminate:!1,options:[],visible:!1}),l&&ne("filter-visible",{column:t,property:t.field,field:t.field,filterList:()=>ie.getCheckedFilters(),visible:!1},null),(0,_vue.nextTick)()},isActiveFilterByColumn(e){e=(0,_util.handleFieldOrColumn)(ie,e);return e?e.filters&&e.filters.some(e=>e.checked):0<ie.getCheckedFilters().length},isFilter(e){return P.isActiveFilterByColumn(e)},isRowExpandLoaded(e){var t=W.fullAllDataRowIdData,t=t[(0,_util.getRowid)(ie,e)];return t&&!!t.expandLoaded},clearRowExpandLoaded(e){var{fullAllDataRowIdData:t,rowExpandLazyLoadedMaps:l}=W,r=ae.value.lazy,e=(0,_util.getRowid)(ie,e),t=t[e];return r&&t&&(t.expandLoaded=!1,delete l[e]),B.rowExpandedFlag++,(0,_vue.nextTick)()},reloadRowExpand(e){var t=W.rowExpandLazyLoadedMaps,l=ae.value.lazy,r=(0,_util.getRowid)(ie,e);return l&&!t[r]&&ie.clearRowExpandLoaded(e).then(()=>Zt(e)),(0,_vue.nextTick)()},reloadExpandContent(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["reloadExpandContent","reloadRowExpand"]),ie.reloadRowExpand(e)},toggleRowExpand(e){return ie.setRowExpand(e,!ie.isRowExpandByRow(e))},setAllRowExpand(e){var t=oe.value,{tableFullData:l,tableFullTreeData:r}=W,t=t.children||t.childrenField;let a=[];return V.treeConfig?_xeUtils.default.eachTree(r,e=>{a.push(e)},{children:t}):a=l,P.setRowExpand(a,e)},setRowExpand(e,t){let l=B.expandColumn,{fullAllDataRowIdData:r,rowExpandedMaps:a,rowExpandLazyLoadedMaps:o}=W,i=(0,_util.createHandleGetRowId)(ie).handleGetRowId;let{reserve:n,lazy:d,accordion:u,toggleMethod:s}=ae.value,c=[],g=ie.getColumnIndex(l),v=ie.getVMColumnIndex(l);return e&&(_xeUtils.default.isArray(e)||(e=[e]),u&&(a={},W.rowExpandedMaps=a,e=e.slice(e.length-1,e.length)),e=s?e.filter(e=>s({$table:ie,expanded:t,column:l,columnIndex:g,$columnIndex:v,row:e,rowIndex:P.getRowIndex(e),$rowIndex:P.getVMRowIndex(e)})):e,t?e.forEach(e=>{var t,l=i(e);a[l]||(t=r[l],d&&!t.expandLoaded&&!o[l]?c.push(Zt(e)):a[l]=e)}):e.forEach(e=>{e=i(e);a[e]&&delete a[e]}),n)&&e.forEach(e=>Jt(e,t)),B.rowExpandedFlag++,Promise.all(c).then(()=>(0,_vue.nextTick)()).then(()=>ie.recalculate(!0)).then(()=>(M(),xl(),_l(),ie.updateCellAreas()))},isRowExpandByRow(e){var t=B.rowExpandedFlag,l=W.rowExpandedMaps,e=(0,_util.getRowid)(ie,e);return!!t&&!!l[e]},isExpandByRow(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["isExpandByRow","isRowExpandByRow"]),P.isRowExpandByRow(e)},clearRowExpand(){var e=W.tableFullData,t=ae.value.reserve;let l=ie.getRowExpandRecords();return W.rowExpandedMaps={},B.rowExpandedFlag++,t&&e.forEach(e=>Jt(e,!1)),(0,_vue.nextTick)().then(()=>{if(l.length)return ie.recalculate(!0)}).then(()=>(M(),xl(),_l(),ie.updateCellAreas()))},clearRowExpandReserve(){return W.rowExpandedReserveRowMap={},(0,_vue.nextTick)()},getRowExpandRecords(){let t=[];return _xeUtils.default.each(W.rowExpandedMaps,e=>{e&&t.push(e)}),t},getTreeExpandRecords(){let t=[];return _xeUtils.default.each(W.treeExpandedMaps,e=>{e&&t.push(e)}),t},isTreeExpandLoaded(e){var t=W.fullAllDataRowIdData,t=t[(0,_util.getRowid)(ie,e)];return t&&!!t.treeLoaded},clearTreeExpandLoaded(e){let{fullAllDataRowIdData:l,treeExpandedMaps:r}=W;var t=oe.value.transform;return e?(e=_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{var e=(0,_util.getRowid)(ie,e),t=l[e];t&&(t.treeLoaded=!1,r[e])&&delete r[e]}):_xeUtils.default.each(l,e=>{e.treeLoaded=!1}),W.treeExpandedMaps={},B.treeExpandedFlag++,t?(Vt(),ie.handleTableData()):(0,_vue.nextTick)()},reloadTreeExpand(e){var t=W.treeExpandLazyLoadedMaps,l=oe.value,r=l.hasChild||l.hasChildField;let{transform:a,lazy:o}=l;l=(0,_util.getRowid)(ie,e);return o&&e[r]&&!t[l]?P.clearTreeExpandLoaded(e).then(()=>Kt(e)).then(()=>{if(a)return Vt(),Y.handleTableData()}).then(()=>P.recalculate()):(0,_vue.nextTick)()},reloadTreeChilds(e){return"development"===process.env.NODE_ENV&&(0,_log.warnLog)("vxe.error.delFunc",["reloadTreeChilds","reloadTreeExpand"]),P.reloadTreeExpand(e)},toggleTreeExpand(e){return P.setTreeExpand(e,!P.isTreeExpandByRow(e))},setAllTreeExpand(e){var t=W.tableFullData,l=oe.value;let{transform:r,lazy:a}=l,o=l.children||l.childrenField,i=[];return _xeUtils.default.eachTree(t,e=>{var t=e[o];(a||t&&t.length)&&i.push(e)},{children:o}),P.setTreeExpand(i,e).then(()=>{if(r)return Vt(),P.recalculate()})},setTreeExpand(e,t){var l,r=oe.value.transform;return e&&(e=_xeUtils.default.isArray(e)?e:[e]).length?r?(r=e,l=t,cl(r,l).then(()=>(Vt(),Y.handleTableData(),Pt(),(0,_vue.nextTick)())).then(()=>P.recalculate(!0)).then(()=>{setTimeout(()=>{P.updateCellAreas()},30)})):cl(e,t):(0,_vue.nextTick)()},isTreeExpandByRow(e){var t=B.treeExpandedFlag,l=W.treeExpandedMaps;return!!t&&!!l[(0,_util.getRowid)(ie,e)]},clearTreeExpand(){var e=W.tableFullTreeData,t=oe.value,l=t.children||t.childrenField;let{transform:r,reserve:a}=t,o=ie.getTreeExpandRecords();return W.treeExpandedMaps={},B.treeExpandedFlag++,a&&_xeUtils.default.eachTree(e,e=>Gt(e,!1),{children:l}),ie.handleTableData().then(()=>{if(r)return Vt(),ie.handleTableData()}).then(()=>{if(o.length)return ie.recalculate()})},clearTreeExpandReserve(){return W.treeExpandedReserveRowMap={},(0,_vue.nextTick)()},getScroll(){var{scrollXLoad:e,scrollYLoad:t}=B,l=W.elemStore,l=(0,_util.getRefElem)(l["main-body-scroll"]);return{virtualX:e,virtualY:t,scrollTop:l?l.scrollTop:0,scrollLeft:l?l.scrollLeft:0}},scrollTo(e,t){var l=W.elemStore,r=(0,_util.getRefElem)(l["main-header-scroll"]),a=(0,_util.getRefElem)(l["main-body-scroll"]),o=(0,_util.getRefElem)(l["main-footer-scroll"]),i=(0,_util.getRefElem)(l["left-body-scroll"]),l=(0,_util.getRefElem)(l["right-body-scroll"]),n=S.value,d=T.value;return W.intoRunScroll=!0,_xeUtils.default.isNumber(e)&&((0,_dom.setScrollLeft)(n,e),(0,_dom.setScrollLeft)(a,e),(0,_dom.setScrollLeft)(r,e),(0,_dom.setScrollLeft)(o,e)),_xeUtils.default.isNumber(t)&&((0,_dom.setScrollTop)(d,t),(0,_dom.setScrollTop)(a,t),(0,_dom.setScrollTop)(i,t),(0,_dom.setScrollTop)(l,t)),B.scrollXLoad||B.scrollYLoad?new Promise(e=>{setTimeout(()=>{(0,_vue.nextTick)(()=>{W.intoRunScroll=!1,e()})},30)}):(0,_vue.nextTick)()},scrollToRow(e,t){let{isAllOverflow:l,scrollYLoad:r,scrollXLoad:a}=B;var o,i,n=[];return e&&(V.treeConfig?n.push(Y.scrollToTreeRow(e)):n.push((0,_util.rowToVisible)(ie,e))),t&&n.push((t=t,o=e,i=W.fullColumnIdData,(t=(0,_util.handleFieldOrColumn)(ie,t))&&i[t.id]?(0,_util.colToVisible)(ie,t,o):(0,_vue.nextTick)())),Promise.all(n).then(()=>{if(e)return l||!r&&!a||(zt(),At()),(0,_vue.nextTick)()})},scrollToColumn(e){var t=W.fullColumnIdData,e=(0,_util.handleFieldOrColumn)(ie,e);return e&&t[e.id]?(0,_util.colToVisible)(ie,e):(0,_vue.nextTick)()},clearScroll(){var{elemStore:e,scrollXStore:t,scrollYStore:l}=W,r=(0,_util.getRefElem)(e["main-header-scroll"]),a=(0,_util.getRefElem)(e["main-body-scroll"]),o=(0,_util.getRefElem)(e["main-footer-scroll"]),i=(0,_util.getRefElem)(e["left-body-scroll"]),e=(0,_util.getRefElem)(e["right-body-scroll"]),n=S.value,d=T.value;return W.intoRunScroll=!0,(0,_dom.setScrollLeft)(n,0),(0,_dom.setScrollLeft)(a,0),(0,_dom.setScrollLeft)(r,0),(0,_dom.setScrollLeft)(o,0),(0,_dom.setScrollTop)(d,0),(0,_dom.setScrollTop)(a,0),(0,_dom.setScrollTop)(i,0),(0,_dom.setScrollTop)(e,0),t.startIndex=0,t.visibleStartIndex=0,t.endIndex=t.visibleSize,t.visibleEndIndex=t.visibleSize,l.startIndex=0,l.visibleStartIndex=0,l.endIndex=l.visibleSize,l.visibleEndIndex=l.visibleSize,(0,_vue.nextTick)().then(()=>{W.intoRunScroll=!1})},updateFooter(){var{showFooter:e,footerData:t,footerMethod:l}=V,{visibleColumn:r,afterFullData:a}=W;let o=[];return e&&t&&t.length?o=t.slice(0):e&&l&&(o=r.length?l({columns:r,data:a,$table:ie,$grid:K}):[]),B.footerTableData=o,(0,_vue.nextTick)()},updateStatus(t,l){return(0,_vue.nextTick)().then(()=>{var e=V.editRules;if(t&&e)return ie.handleCellRuleUpdateStatus("change",t,l)})},setMergeCells(e){return V.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]),Tt(e,B.mergeList,W.afterFullData),(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b()))},removeMergeCells(e){V.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]);let t=Dt(e,B.mergeList,W.afterFullData);return(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b(),t))},getMergeCells(){return B.mergeList.slice(0)},clearMergeCells(){return B.mergeList=[],(0,_vue.nextTick)().then(()=>b())},setMergeFooterItems(e){return V.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]),Tt(e,B.mergeFooterList),(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b()))},removeMergeFooterItems(e){V.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]);let t=Dt(e,B.mergeFooterList);return(0,_vue.nextTick)().then(()=>(P.updateCellAreas(),b(),t))},getMergeFooterItems(){return B.mergeFooterList.slice(0)},clearMergeFooterItems(){return B.mergeFooterList=[],(0,_vue.nextTick)().then(()=>b())},updateCellAreas(){var e=V.mouseConfig,t=le.value;return e&&t.area&&ie.handleRecalculateCellAreaEvent?ie.handleRecalculateCellAreaEvent():(0,_vue.nextTick)()},getCustomStoreData(){var e=V.id,t=I.value,l=W.collectColumn;let{storage:r,checkMethod:s}=t;var t=!0===r,a=t?{}:Object.assign({},r||{});let c=t||a.resizable,g=t||a.visible,v=t||a.fixed,h=t||a.sort,f={},m={},p={},x={};t={resizableData:void 0,sortData:void 0,visibleData:void 0,fixedData:void 0};if(e){let i=0,n=0,d=0,u=0;_xeUtils.default.eachTree(l,(e,t,l,r,a)=>{var o=e.getKey();o?(a||(h&&(n=1,m[o]=e.renderSortNumber),v&&e.fixed!==e.defaultFixed&&(d=1,x[o]=e.fixed)),c&&e.resizeWidth&&(i=1,f[o]=e.renderWidth),!g||s&&!s({column:e})||(!e.visible&&e.defaultVisible?(u=1,p[o]=!1):e.visible&&!e.defaultVisible&&(u=1,p[o]=!0))):(0,_log.errLog)("vxe.error.reqProp",[`${e.getTitle()||e.type||""} -> column.field=?`])}),i&&(t.resizableData=f),n&&(t.sortData=m),d&&(t.fixedData=x),u&&(t.visibleData=p)}else(0,_log.errLog)("vxe.error.reqProp",["id"]);return t},focus(){return W.isActivated=!0,(0,_vue.nextTick)()},blur(){return(W.isActivated=!1,_vue.nextTick)()},connect(e){return e?(U=e).syncUpdate({collectColumn:W.collectColumn,$table:ie}):(0,_log.errLog)("vxe.error.barUnableLink"),(0,_vue.nextTick)()}},l=>{var{editStore:e,ctxMenuStore:t,filterStore:r,customStore:a}=B;let{mouseConfig:o,editRules:i}=V,n=q.value,d=te.value,u=Ue.value;var s=qe.value;let c=e.actived;var e=me.value,g=xe.value,v=_e.value,h=pe.value;if(!g||(0,_dom.getEventTargetNode)(l,n,"vxe-cell--filter").flag||(0,_dom.getEventTargetNode)(l,g.$el).flag||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||Y.preventEvent(l,"event.clearFilter",r.args,P.closeFilter),!v||a.btnEl===l.target||(0,_dom.getEventTargetNode)(l,document.body,"vxe-toolbar-custom-target").flag||(0,_dom.getEventTargetNode)(l,v.$el).flag||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||Y.preventEvent(l,"event.clearCustom",{},()=>{ie.closeCustom&&ie.closeCustom()}),c.row)!1===d.autoClear||(g=c.args.cell)&&(0,_dom.getEventTargetNode)(l,g).flag||e&&(0,_dom.getEventTargetNode)(l,e.$el).flag||W._lastCallTime&&!(W._lastCallTime+50<Date.now())||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||Y.preventEvent(l,"event.clearEdit",c.args,()=>{let e;var t;(e=(e=(e="row"===d.mode?!!(t=(t=(0,_dom.getEventTargetNode)(l,n,"vxe-body--row")).flag?P.getRowNode(t.targetElem):null)&&!ie.eqRow(t.item,c.args.row):!(0,_dom.getEventTargetNode)(l,n,"col--edit").flag)||(0,_dom.getEventTargetNode)(l,n,"vxe-header--row").flag)||(0,_dom.getEventTargetNode)(l,n,"vxe-footer--row").flag)||!V.height||B.overflowY||(t=l.target,(0,_dom.hasClass)(t,"vxe-table--body-wrapper")&&(e=l.offsetY<t.clientHeight)),!e&&(0,_dom.getEventTargetNode)(l,n).flag||setTimeout(()=>{ie.handleClearEdit(l).then(()=>{!W.isActivated&&i&&u.autoClear&&(B.validErrorMaps={})})})});else if(o&&!((0,_dom.getEventTargetNode)(l,n).flag||K&&(0,_dom.getEventTargetNode)(l,K.getRefMaps().refElem.value).flag||h&&(0,_dom.getEventTargetNode)(l,h.getRefMaps().refElem.value).flag||U&&(0,_dom.getEventTargetNode)(l,U.getRefMaps().refElem.value).flag)&&(ie.clearSelected&&ie.clearSelected(),s.autoClear)&&ie.getCellAreas){let e=ie.getCellAreas();e&&e.length&&!(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-areas-clear").flag&&Y.preventEvent(l,"event.clearAreas",{},()=>{ie.clearCellAreas(),ie.clearCopyCellArea(),ne("clear-cell-area-selection",{cellAreas:e},l)})}ie.closeMenu&&t.visible&&h&&!(0,_dom.getEventTargetNode)(l,h.getRefMaps().refElem.value).flag&&ie.closeMenu();r=(0,_dom.getEventTargetNode)(l,K?K.getRefMaps().refElem.value:n).flag;!r&&i&&u.autoClear&&(B.validErrorMaps={}),W.isActivated=r}),Cl=()=>{P.closeFilter(),ie.closeMenu&&ie.closeMenu()},bl=()=>{P.closeTooltip(),ie.closeMenu&&ie.closeMenu()},Rl=t=>{let{mouseConfig:e,keyboardConfig:l}=V,{filterStore:r,ctxMenuStore:a,editStore:o}=B,i=le.value,n=re.value,d=o.actived;globalEvents.hasKey(t,GLOBAL_EVENT_KEYS.ESCAPE)&&Y.preventEvent(t,"event.keydown",null,()=>{if(ne("keydown-start",{},t),l&&e&&i.area&&ie.handleKeyboardCellAreaEvent)ie.handleKeyboardCellAreaEvent(t);else if((d.row||r.visible||a.visible)&&(t.stopPropagation(),ie.closeMenu&&ie.closeMenu(),P.closeFilter(),l)&&n.isEsc&&d.row){let e=d.args;ie.handleClearEdit(t),i.selected&&(0,_vue.nextTick)(()=>ie.handleSelected(e,t))}ne("keydown",{},t),ne("keydown-end",{},t)})},El=N=>{W.isActivated&&Y.preventEvent(N,"event.keydown",null,()=>{var{mouseConfig:e,keyboardConfig:t,treeConfig:l,editConfig:r,highlightCurrentRow:a}=V;let{ctxMenuStore:o,editStore:i,currentRow:n}=B;var d=W.afterFullData,u=et.value,s=Je.value,c=re.value,g=le.value,v=te.value,h=oe.value,f=tt.value,m=Z.value,{selected:p,actived:x}=i,h=h.children||h.childrenField,_=N.keyCode,w=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.ESCAPE),C=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.BACKSPACE),O=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.TAB),b=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.ENTER),R=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.SPACEBAR),E=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.ARROW_LEFT),y=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.ARROW_UP),S=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.ARROW_RIGHT),T=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.ARROW_DOWN),H=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.DELETE),D=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.F2),I=globalEvents.hasKey(N,GLOBAL_EVENT_KEYS.CONTEXT_MENU),z=N.metaKey,M=N.ctrlKey,L=N.shiftKey,F=N.altKey,k=E||y||S||T,u=u&&o.visible&&(b||R||k),U=(0,_utils.isEnableConf)(r)&&x.column&&x.row;let A=v.beforeEditMethod||v.activeMethod;if(u)N.preventDefault(),o.showChild&&(0,_utils.hasChildrenList)(o.selected)?ie.moveCtxMenu(N,o,"selectChild",E,!1,o.selected.children):ie.moveCtxMenu(N,o,"selected",S,!0,f);else if(t&&e&&g.area&&ie.handleKeyboardCellAreaEvent)ie.handleKeyboardCellAreaEvent(N);else if(w){if(ie.closeMenu&&ie.closeMenu(),P.closeFilter(),t&&c.isEsc&&x.row){let e=x.args;ie.handleClearEdit(N),g.selected&&(0,_vue.nextTick)(()=>ie.handleSelected(e,N))}}else if(R&&t&&c.isChecked&&p.row&&p.column&&("checkbox"===p.column.type||"radio"===p.column.type))N.preventDefault(),"checkbox"===p.column.type?Y.handleToggleCheckRowEvent(N,p.args):Y.triggerRadioRowEvent(N,p.args);else if(D&&(0,_utils.isEnableConf)(r))U||p.row&&p.column&&(N.preventDefault(),ie.handleEdit(p.args,N));else if(I)W._keyCtx=p.row&&p.column&&s.length,clearTimeout(W.keyCtxTimeout),W.keyCtxTimeout=setTimeout(()=>{W._keyCtx=!1},1e3);else if(b&&!F&&t&&c.isEnter&&(p.row||x.row||l&&(m.isCurrent||a)&&n)){var{isLastEnterAppendRow:u,beforeEnterMethod:f,enterMethod:e}=c;if(M){if(x.row){let e=x.args;ie.handleClearEdit(N),g.selected&&(0,_vue.nextTick)(()=>{ie.handleSelected(e,N)})}}else if(p.row||x.row){let l=(p.row?p:x).args;if(L)c.enterToTab?ie.moveTabSelected(l,L,N):ie.moveEnterSelected(l,E,!0,S,!1,N);else if(c.enterToTab)ie.moveTabSelected(l,L,N);else{var w=p.row||x.row;let t=p.column||x.column;D=ie.getVTRowIndex(w),I={row:w,rowIndex:ie.getRowIndex(w),$rowIndex:ie.getVMRowIndex(w),_rowIndex:D,column:t,columnIndex:ie.getColumnIndex(t),$columnIndex:ie.getVMColumnIndex(t),_columnIndex:ie.getVTColumnIndex(t),$table:ie};if(!f||!1!==f(I)){if(u&&D>=d.length-1)return ie.insertAt({},-1).then(({row:e})=>{ie.scrollToRow(e,t),ie.handleSelected(Object.assign(Object.assign({},l),{row:e}),N)}),void ie.dispatchEvent("enter-append-row",I,N);ie.moveEnterSelected(l,E,!1,S,!0,N),e&&e(I)}}}else if(l&&(m.isCurrent||a)&&n){s=n[h];if(s&&s.length){N.preventDefault();let e=s[0],t={$table:ie,row:e,rowIndex:P.getRowIndex(e),$rowIndex:P.getVMRowIndex(e)};P.setTreeExpand(n,!0).then(()=>P.scrollToRow(e)).then(()=>Y.triggerCurrentRowEvent(N,t))}}}else if(k&&t&&c.isArrow)U||p.row&&p.column&&ie.moveArrowSelected(p.args,E,y,S,T,N);else if(O&&t&&c.isTab)p.row||p.column?ie.moveTabSelected(p.args,L,N):(x.row||x.column)&&ie.moveTabSelected(x.args,L,N);else if(t&&c.isDel&&H&&(0,_utils.isEnableConf)(r)&&(p.row||p.column))U||(b=c.delMethod,F={row:p.row,rowIndex:P.getRowIndex(p.row),column:p.column,columnIndex:P.getColumnIndex(p.column),$table:ie,$grid:K},A&&!A(F))||(b?b(F):(0,_util.setCellValue)(p.row,p.column,null),P.updateFooter(),ne("cell-delete-value",F,N));else if(C&&t&&c.isBack&&(0,_utils.isEnableConf)(r)&&(p.row||p.column))U||(g=c.backMethod,c.isDel&&(0,_utils.isEnableConf)(r)&&(p.row||p.column)&&(w={row:p.row,rowIndex:P.getRowIndex(p.row),column:p.column,columnIndex:P.getColumnIndex(p.column),$table:ie,$grid:K},A&&!A(w)||(g?g(w):((0,_util.setCellValue)(p.row,p.column,null),ie.handleEdit(p.args,N)),ne("cell-backspace-value",w,N))));else if(C&&t&&l&&c.isBack&&(m.isCurrent||a)&&n){let t=_xeUtils.default.findTree(W.afterTreeFullData,e=>e===n,{children:h}).parent;if(t){N.preventDefault();let e={row:t,rowIndex:P.getRowIndex(t),$rowIndex:P.getVMRowIndex(t),$table:ie,$grid:K};P.setTreeExpand(t,!1).then(()=>P.scrollToRow(t)).then(()=>Y.triggerCurrentRowEvent(N,e))}}else if(t&&(0,_utils.isEnableConf)(r)&&c.isEdit&&!M&&!z&&(R||48<=_&&_<=57||65<=_&&_<=90||96<=_&&_<=111||186<=_&&_<=192||219<=_&&_<=222)){var{editMode:f,editMethod:u}=c;if(p.column&&p.row&&(0,_utils.isEnableConf)(p.column.editRender)){let e=v.beforeEditMethod||v.activeMethod;D={row:p.row,rowIndex:P.getRowIndex(p.row),column:p.column,columnIndex:P.getColumnIndex(p.column),$table:ie,$grid:K};e&&!e(Object.assign(Object.assign({},p.args),{$table:ie,$grid:K}))||(u?u(D):("insert"!==f&&(0,_util.setCellValue)(p.row,p.column,null),ie.handleEdit(p.args,N)))}}ne("keydown",{},N)})},yl=e=>{var{keyboardConfig:t,mouseConfig:l}=V,{editStore:r,filterStore:a}=B,o=W.isActivated,i=le.value,n=re.value,r=r.actived;o&&!a.visible&&(r.row||r.column||t&&n.isClip&&l&&i.area&&ie.handlePasteCellAreaEvent&&ie.handlePasteCellAreaEvent(e),ne("paste",{},e))},Sl=e=>{var{keyboardConfig:t,mouseConfig:l}=V,{editStore:r,filterStore:a}=B,o=W.isActivated,i=le.value,n=re.value,r=r.actived;o&&!a.visible&&(r.row||r.column||t&&n.isClip&&l&&i.area&&ie.handleCopyCellAreaEvent&&ie.handleCopyCellAreaEvent(e),ne("copy",{},e))},Tl=e=>{var{keyboardConfig:t,mouseConfig:l}=V,{editStore:r,filterStore:a}=B,o=W.isActivated,i=le.value,n=re.value,r=r.actived;o&&!a.visible&&(r.row||r.column||t&&n.isClip&&l&&i.area&&ie.handleCutCellAreaEvent&&ie.handleCutCellAreaEvent(e),ne("cut",{},e))},Dl=()=>{ie.closeMenu&&ie.closeMenu();var e=q.value;if(!e||!e.clientWidth)return(0,_vue.nextTick)();P.recalculate(!0),P.updateCellAreas()},Il=e=>{var t=$.value;clearTimeout(W.tooltipTimeout),e?P.closeTooltip():t&&t.setActived&&t.setActived(!0)},Ml=()=>{var{dragRow:e,dragCol:t}=B;(e||t)&&(Fl(),Ll(),Ul(),B.dragRow=null,B.dragCol=null,B.isDragColMove=!1,B.isDragRowMove=!1)},Ll=()=>{var e=q.value;if(e){let t="row--drag-origin";_xeUtils.default.arrayEach(e.querySelectorAll("."+t),e=>{(e.draggable=!1,_dom.removeClass)(e,t)})}},Fl=()=>{var e=q.value;if(e){let t="col--drag-origin";_xeUtils.default.arrayEach(e.querySelectorAll("."+t),e=>{(e.draggable=!1,_dom.removeClass)(e,t)})}},kl=(e,l,r,t,a)=>{var o=q.value;if(o){var{overflowX:i,scrollbarWidth:n,overflowY:d,scrollbarHeight:u}=B,s=W.prevDragToChild,c=o.getBoundingClientRect(),d=d?n:0,n=i?u:0,i=o.clientWidth,u=o.clientHeight;if(l){var g=Ee.value;if(g)if(t){var v=Oe.value,h=l.getBoundingClientRect();let e=l.clientHeight;l=Math.max(1,h.y-c.y);l+e>u-n&&(e=u-l-n),g.style.display="block",g.style.left=`${v?d:0}px`,g.style.top=l+"px",g.style.height=e+"px",g.style.width=i-d+"px",g.setAttribute("drag-pos",a),g.setAttribute("drag-to-child",s?"y":"n")}else g.style.display=""}else if(r){h=ye.value;if(h)if(t){var v=Ae.value,l=N.value,g=l?l.clientWidth:0,l=X.value,l=l?l.clientWidth:0,f=r.getBoundingClientRect();let e=r.clientWidth;r=Math.max(0,f.y-c.y);let t=f.x-c.x;t<g&&(e-=g-t,t=g);g=i-l-(l?0:d);t+e>g&&(e=g-t),h.style.display="block",h.style.top=r+"px",h.style.left=t+"px",h.style.width=e+"px",h.style.height=s?f.height+"px":u-r-(v?0:n)+"px",h.setAttribute("drag-pos",a),h.setAttribute("drag-to-child",s?"y":"n")}else h.style.display=""}i=Re.value;i&&(i.style.display="block",i.style.top=Math.min(o.clientHeight-o.scrollTop-i.clientHeight,e.clientY-c.y)+"px",i.style.left=Math.min(o.clientWidth-o.scrollLeft-i.clientWidth-16,e.clientX-c.x)+"px",i.setAttribute("drag-status",t?s?"sub":"normal":"disabled"))}},Ul=()=>{var e=Re.value,t=Ee.value,l=ye.value;e&&(e.style.display=""),t&&(t.style.display=""),l&&(l.style.display="")},Al=(e,r,a,o,i)=>{let n=a||r;if(n){i.cell=r;var a=B.tooltipStore,{column:r,row:d}=i,{showAll:u,contentMethod:s}=Pe.value,i=s?s(i):null,s=s&&!_xeUtils.default.eqNull(i);let t=s?i:_xeUtils.default.toString("html"===r.type?n.innerText:n.textContent).trim(),l=n.scrollWidth>n.clientWidth;t&&(u||s||l)&&(Object.assign(a,{row:d,column:r,visible:!0,currOpts:{}}),(0,_vue.nextTick)(()=>{var e=$.value;e&&e.open&&e.open(l?n:o,(0,_utils.formatText)(t))}))}return(0,_vue.nextTick)()},Ol=(e,t)=>{if(e){if(K)return K.callSlot(e,t);if(_xeUtils.default.isFunction(e))return(0,_vn.getSlotVNs)(e(t))}return[]},Hl=(Y={getSetupOptions(){return getConfig()},updateAfterDataIndex:Pt,callSlot:Ol,getParentElem(){var e,t=q.value;return K?(e=K.getRefMaps().refElem.value)?e.parentNode:null:t?t.parentNode:null},getParentHeight(){var t=V.height,l=q.value;if(l){l=l.parentNode,t="100%"===t||"auto"===t?(0,_dom.getPaddingTopBottomSize)(l):0;let e=0;return l&&(e=K&&(0,_dom.hasClass)(l,"vxe-grid--table-wrapper")?K.getParentHeight():l.clientHeight),Math.floor(e-t)}return 0},getExcludeHeight(){return K?K.getExcludeHeight():0},defineField(e){let t=V.treeConfig,l=ae.value,r=oe.value,o=D.value,i=ee.value,n=r.children||r.childrenField,d=(0,_util.getRowkey)(ie);return(e=_xeUtils.default.isArray(e)?e:[e]).map(a=>(W.tableFullColumn.forEach(t=>{var{field:l,editRender:r}=t;if(l&&!_xeUtils.default.has(a,l)&&!a[l]){let e=null;r&&(r=r.defaultValue,_xeUtils.default.isFunction(r)?e=r({column:t}):_xeUtils.default.isUndefined(r)||(e=r)),_xeUtils.default.set(a,l,e)}}),[o.labelField,i.checkField,i.labelField,l.labelField].forEach(e=>{e&&(0,_utils.eqEmptyValue)(_xeUtils.default.get(a,e))&&_xeUtils.default.set(a,e,null)}),t&&r.lazy&&_xeUtils.default.isUndefined(a[n])&&(a[n]=null),(0,_utils.eqEmptyValue)(_xeUtils.default.get(a,d))&&_xeUtils.default.set(a,d,(0,_util.getRowUniqueId)()),a))},handleTableData(e){var t=B.scrollYLoad;let{scrollYStore:l,fullDataRowIdData:r}=W,a=W.afterFullData;e&&((()=>{var e=V.treeConfig,{tableFullColumn:t,tableFullData:l,tableFullTreeData:r}=W,a=Ye.value,n=R.value,d=oe.value,u=d.children||d.childrenField,{transform:s,rowField:c,parentField:g,mapChildrenField:v}=d;let{isEvery:h,remote:f,filterMethod:m}=a,{remote:p,sortMethod:x,multiple:_,chronological:w}=n,C=[],b=[];if(f&&p)e&&s?(b=_xeUtils.default.searchTree(r,()=>!0,{original:!0,isEvery:h,children:d.mapChildrenField,mapChildren:u}),C=b):(C=(e?r:l).slice(0),b=C);else{let o=[],i=[];t.forEach(e=>{var{field:t,sortable:l,order:r,filters:a}=e;if(!f&&a&&a.length){let t=[],l=[];a.forEach(e=>{e.checked&&(l.push(e),t.push(e.value))}),l.length&&o.push({column:e,valueList:t,itemList:l})}!p&&l&&r&&i.push({column:e,field:t,property:t,order:r,sortTime:e.sortTime})}),_&&w&&1<i.length&&(i=_xeUtils.default.orderBy(i,"sortTime")),!f&&o.length?(a=u=>o.every(({column:t,valueList:e,itemList:l})=>{let{filterMethod:r,filterRender:a}=t;var o=(0,_utils.isEnableConf)(a)?renderer.get(a.name):null;let i=o?o.tableFilterMethod||o.filterMethod:null,n=o?o.tableFilterDefaultMethod||o.defaultTableFilterMethod||o.defaultFilterMethod:null,d=(0,_util.getCellValue)(u,t);return r?l.some(e=>r({value:e.value,option:e,cellValue:d,row:u,column:t,$table:ie})):i?l.some(e=>i({value:e.value,option:e,cellValue:d,row:u,column:t,$table:ie})):m?m({options:l,values:e,cellValue:d,row:u,column:t}):n?l.some(e=>n({value:e.value,option:e,cellValue:d,row:u,column:t,$table:ie})):-1<e.indexOf(_xeUtils.default.get(u,t.field))}),e&&s?(b=_xeUtils.default.searchTree(r,a,{original:!0,isEvery:h,children:v,mapChildren:u}),C=b):(C=(e?r:l).filter(a),b=C)):e&&s?(b=_xeUtils.default.searchTree(r,()=>!0,{original:!0,isEvery:h,children:v,mapChildren:u}),C=b):(C=(e?r:l).slice(0),b=C),!p&&i.length&&(e&&s?(b=x?(n=x({data:b,sortList:i,$table:ie}),_xeUtils.default.isArray(n)?n:b):(d=_xeUtils.default.toTreeArray(b,{children:v}),_xeUtils.default.toArrayTree(_xeUtils.default.orderBy(d,i.map(({column:e,order:t})=>[Nt(e),t])),{key:c,parentKey:g,children:u,mapChildren:v})),C=b):(C=x?(t=x({data:C,sortList:i,$table:ie}),_xeUtils.default.isArray(t)?t:C):_xeUtils.default.orderBy(C,i.map(({column:e,order:t})=>[Nt(e),t])),b=C))}W.afterFullData=C,W.afterTreeFullData=b,Pt()})(),a=Vt());e=t?a.slice(l.startIndex,l.endIndex):a.slice(0);return e.forEach((e,t)=>{e=(0,_util.getRowid)(ie,e),e=r[e];e&&(e.$index=t)}),B.tableData=e,(0,_vue.nextTick)()},cacheRowMap(){let n=V.treeConfig,{fullAllDataRowIdData:e,tableFullData:t,tableFullTreeData:l,treeExpandedMaps:d}=W;var r=oe.value;let u=r.children||r.childrenField,s=r.hasChild||r.hasChildField,c=r.lazy,g=Object.assign({},e),v={},h=(0,_util.createHandleUpdateRowId)(ie).handleUpdateRowId,f=(e,t,l,r,a,o,i,n)=>{let d=g[o];d||(d={row:e,rowid:o,seq:n,index:-1,_index:-1,$index:-1,treeIndex:t,items:l,parent:a,level:i,height:0,resizeHeight:0,oTop:0,expandHeight:0},v[o]=d,g[o]=d),d.treeLoaded=!1,d.expandLoaded=!1,d.row=e,d.items=l,d.parent=a,d.level=i,d.index=r,d.treeIndex=t,v[o]=d,g[o]=d};n?_xeUtils.default.eachTree(l,(e,t,l,r,a,o)=>{var i=h(e);n&&c&&(e[s]&&void 0===e[u]&&(e[u]=null),!d[i]||e[u]&&e[u].length||delete d[i]),f(e,t,l,a?-1:t,a,i,o.length-1,(0,_util.toTreePathSeq)(r))},{children:u}):t.forEach((e,t,l)=>{f(e,t,l,t,null,h(e),0,t+1)}),W.fullDataRowIdData=v,W.fullAllDataRowIdData=g,B.treeExpandedFlag++},cacheSourceMap(e){var t=V.treeConfig,l=oe.value,e=_xeUtils.default.clone(e,!0);let r=(0,_util.createHandleUpdateRowId)(ie).handleUpdateRowId,a={};var o=e=>{var t=r(e);a[t]=e};t?(t=l.children||l.childrenField,_xeUtils.default.eachTree(e,o,{children:l.transform?l.mapChildrenField:t})):e.forEach(o),W.sourceDataRowIdData=a,W.tableSourceData=e},analyColumnWidth(){var e=W.tableFullColumn;let{width:t,minWidth:l}=G.value,r=[],a=[],o=[],i=[],n=[],d=[],u=[],s=[];e.forEach(e=>{t&&!e.width&&(e.width=t),l&&!e.minWidth&&(e.minWidth=l),e.visible&&(e.resizeWidth?r:"auto"===e.width?u:(0,_dom.isPx)(e.width)?a:(0,_dom.isScale)(e.width)?n:(0,_dom.isPx)(e.minWidth)?o:"auto"===e.minWidth?i:(0,_dom.isScale)(e.minWidth)?d:s).push(e)}),Object.assign(B.columnStore,{resizeList:r,pxList:a,pxMinList:o,autoMinList:i,scaleList:n,scaleMinList:d,autoList:u,remainList:s})},handleColResizeMousedownEvent(e,R,r){e.stopPropagation(),e.preventDefault();var t=r.column,{overflowX:l,scrollbarHeight:a}=B;let{elemStore:o,visibleColumn:i}=W,E=Ne.value,y=l?a:0,S=q.value,T=N.value,D=X.value,I=we.value;if(I){let f=I.firstElementChild,m=Ae.value,p=e.clientX,x=q.value;l=e.target;let _=t,w=(t.children&&t.children.length&&_xeUtils.default.eachTree(t.children,e=>{_=e}),l.parentNode);a=Object.assign(r,{cell:w});let C=0,b=(0,_util.getRefElem)(o["main-body-scroll"]);if(b){var t=(0,_dom.getOffsetPos)(l,x),l=l.clientWidth,n=Math.floor(l/2);let u=(0,_util.getColReMinWidth)(a)-n,s=t.left-w.clientWidth+l+u,c=t.left+n,g="left"===R,v="right"===R,h=0;if(g||v){var d=g?"nextElementSibling":"previousElementSibling";let e=w[d];for(;e&&!(0,_dom.hasClass)(e,"fixed--hidden");)(0,_dom.hasClass)(e,"col--group")||(h+=e.offsetWidth),e=e[d];v&&D&&(c=D.offsetLeft+h)}a=t=>{t.stopPropagation(),t.preventDefault();var l=S.clientHeight,r=t.clientX-p;let e=c+r;r=R?0:b.scrollLeft,g?e=Math.min(e,(D?D.offsetLeft:b.clientWidth)-h-u):v?(s=(T?T.clientWidth:0)+h+u,e=Math.min(e,c+w.clientWidth-u)):s=Math.max(b.scrollLeft,s),C=Math.max(e,s),r=Math.max(1,C-r);if(I.style.left=r+"px",I.style.top=`${m?y:0}px`,I.style.height=`${m?l-y:l}px`,E.showDragTip&&f){f.textContent=getI18n("vxe.table.resizeColTip",[_.renderWidth+(v?c-C:C-c)]);var a=S.clientWidth,o=x.getBoundingClientRect(),i=I.clientWidth,n=f.clientWidth,d=f.clientHeight;let e=-n;r<n+i?e=0:a<r&&(e+=a-r),f.style.left=e+"px",f.style.top=Math.min(l-d,Math.max(0,t.clientY-o.y-d/2))+"px"}B.isDragResize=!0};B.isDragResize=!0,(0,_dom.addClass)(S,"col-drag--resize"),I.style.display="block",document.onmousemove=a,document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null,I.style.display="none",W._lastResizeTime=Date.now(),setTimeout(()=>{B.isDragResize=!1},50);var t=_.renderWidth+(v?c-C:C-c),l=Object.assign(Object.assign({},r),{resizeWidth:t,resizeColumn:_});"fixed"===E.dragMode&&i.forEach(e=>{e.id===_.id||e.resizeWidth||(e.resizeWidth=e.renderWidth)}),ie.handleColResizeCellAreaEvent?ie.handleColResizeCellAreaEvent(e,l):(_.resizeWidth=t,fl(e,l)),(0,_dom.removeClass)(S,"col-drag--resize")},a(e),ie.closeMenu&&ie.closeMenu()}}},handleColResizeDblclickEvent(l,r){var a=Ne.value.isDblclickAutoWidth,o=q.value;if(a&&o){l.stopPropagation(),l.preventDefault();var a=W.fullColumnIdData,i=r.column;let t=i;i.children&&i.children.length&&_xeUtils.default.eachTree(i.children,e=>{t=e});i=a[t.id],a=l.target.parentNode,a=Object.assign(r,{cell:a}),a=(0,_util.getColReMinWidth)(a);o.setAttribute("data-calc-col","Y");let e=Ut(t,o);o.removeAttribute("data-calc-col"),i&&(e=Math.max(e,i.width)),e=Math.max(a,e);o=Object.assign(Object.assign({},r),{resizeWidth:e,resizeColumn:t});B.isDragResize=!1,W._lastResizeTime=Date.now(),ie.handleColResizeDblclickCellAreaEvent?ie.handleColResizeDblclickCellAreaEvent(l,o):(t.resizeWidth=e,fl(l,o))}},handleRowResizeMousedownEvent(r,a){r.stopPropagation(),r.preventDefault();let o=a.row;var{overflowX:i,scrollbarWidth:n,overflowY:h,scrollbarHeight:f}=B,{elemStore:m,fullAllDataRowIdData:p}=W;let x=h?n:0,_=i?f:0,w=Oe.value,C=Ne.value;h=Z.value,n=y.value;let b=q.value,R=Ce.value;if(R){let g=r.clientY,v=R.firstElementChild;i=r.currentTarget.parentNode,f=i.parentNode;if((0,_util.getRefElem)(m["main-body-scroll"])){let l=p[(0,_util.getRowid)(ie,o)];if(l){m=E.value;let d=l.resizeHeight||n.height||h.height||l.height||m,u=b.getBoundingClientRect();p=f.getBoundingClientRect();let e=g-p.y-f.clientHeight,s=d;n=i.querySelector(".vxe-cell");let t=0,c=(n&&(h=getComputedStyle(n),t=Math.max(1,Math.ceil(_xeUtils.default.toNumber(h.paddingTop)+_xeUtils.default.toNumber(h.paddingBottom)))),p.y-u.y+t);m=l=>{l.stopPropagation(),l.preventDefault();var r=b.clientWidth-x,a=b.clientHeight-_;let o=l.clientY-u.y-e;if(o<c?o=c:s=Math.max(t,d+l.clientY-g),R.style.left=`${w?x:0}px`,R.style.top=o+"px",R.style.width=r+"px",C.showDragTip&&v){v.textContent=getI18n("vxe.table.resizeRowTip",[s]);var i=v.clientWidth,n=v.clientHeight;let e=Math.max(2,l.clientX-u.x),t=0;e+i>=r-2&&(e=r-i-2),o+n>=a&&(t=a-(o+n)),v.style.left=e+"px",v.style.top=t+"px"}B.isDragResize=!0};B.isDragResize=!0,(0,_dom.addClass)(b,"row-drag--resize"),R.style.display="block",document.onmousemove=m,document.onmouseup=function(e){var t;document.onmousemove=null,document.onmouseup=null,R.style.display="none",W._lastResizeTime=Date.now(),setTimeout(()=>{B.isDragResize=!1},50),s!==d&&(t=Object.assign(Object.assign({},a),{resizeHeight:s,resizeRow:o}),W.isResizeCellHeight=!0,ie.handleRowResizeCellAreaEvent?ie.handleRowResizeCellAreaEvent(e,t):(l.resizeHeight=s,ml(e,t),M())),(0,_dom.removeClass)(b,"row-drag--resize")},m(r)}}}},handleRowResizeDblclickEvent(a,o){var e=Ne.value.isDblclickAutoHeight;let i=q.value;if(e&&i){a.stopPropagation(),a.preventDefault();var e=B.editStore,t=W.fullAllDataRowIdData,e=e.actived;let l=o.row,r=t[(0,_util.getRowid)(ie,l)];r&&(t=()=>{i.setAttribute("data-calc-row","Y");var e=Ht(r,i),t=(i.removeAttribute("data-calc-row"),Object.assign(Object.assign({},o),{resizeHeight:e,resizeRow:l}));B.isDragResize=!1,W._lastResizeTime=Date.now(),ie.handleRowResizeDblclickCellAreaEvent?ie.handleRowResizeDblclickCellAreaEvent(a,t):(r.resizeHeight=e,ml(a,t))},e.row||e.column?ie.clearEdit().then(t):t())}},saveCustomStore(e){var t=V.customConfig,l=A.value,r=I.value,{updateStore:a,storage:o}=r,i=!0===o,o=i?{}:Object.assign({},o||{}),n=i||o.resizable,d=i||o.visible,u=i||o.fixed,i=i||o.sort;if("reset"!==e&&(B.isCustomStatus=!0),(t?(0,_utils.isEnableConf)(r):r.enabled)&&(n||d||u||i)){if(!l)return(0,_log.errLog)("vxe.error.reqProp",["id"]),(0,_vue.nextTick)();o="reset"===e?{resizableData:{},sortData:{},visibleData:{},fixedData:{}}:P.getCustomStoreData();if(a)return a({id:l,type:e,storeData:o});t=l,r="reset"===e?null:o,n=getConfig().version,(d=_t())[t]=r||void 0,d._v=n,localStorage.setItem(customStorageKey,_xeUtils.default.toJSONString(d))}return(0,_vue.nextTick)()},handleCustom(){var e=V.mouseConfig;return e&&(ie.clearSelected&&ie.clearSelected(),ie.clearCellAreas)&&(ie.clearCellAreas(),ie.clearCopyCellArea()),Y.analyColumnWidth(),P.refreshColumn(!0)},handleUpdateDataQueue(){B.upDataFlag++},handleRefreshColumnQueue(){B.reColumnFlag++},preventEvent(t,e,l,r,a){let o=interceptor.get(e),i=(o.length||"event.clearEdit"!==e||(o=interceptor.get("event.clearActived"),"development"===process.env.NODE_ENV&&o.length&&(0,_log.warnLog)("vxe.error.delEvent",["event.clearActived","event.clearEdit"])),null),n=!1;for(let e=0;e<o.length;e++){var d=(0,o[e])(Object.assign({$grid:K,$table:ie,$event:t},l));if(!1===d){n=!0;break}if(d&&!1===d.status){i=d.result,n=!0;break}}return n||r&&(i=r()),a&&a(),i},updateCheckboxStatus(){var e=V.treeConfig;let{selectCheckboxMaps:d,treeIndeterminateRowMaps:u}=W;var t=oe.value;let{transform:o,mapChildrenField:i}=t,s=t.children||t.childrenField,{checkField:c,checkStrictly:l,checkMethod:g}=ee.value;t=W.afterTreeFullData;if(!l){if(e){let n=(0,_util.createHandleGetRowId)(ie).handleGetRowId,r={},a=[];_xeUtils.default.eachTree(t,e=>{var t=n(e),l=e[o?i:s];l&&l.length&&!r[t]&&(r[t]=1,a.unshift([e,t,l]))},{children:o?i:s}),a.forEach(e=>{var t=e[0],l=e[1];let r=0,a=0,o=0;e[2].forEach(g?e=>{var t=n(e),l=c?_xeUtils.default.get(e,c):d[t];g({row:e})?(l?r++:u[t]&&a++,o++):l?r++:u[t]&&a++}:e=>{var t=n(e);(c?_xeUtils.default.get(e,c):d[t])?r++:u[t]&&a++,o++});var e=r>=o,i=!e&&(1<=r||1<=a);c&&_xeUtils.default.set(t,c,e),e?(c||(d[l]=t),u[l]&&delete u[l]):(c||d[l]&&delete d[l],i?u[l]=t:u[l]&&delete u[l])})}B.updateCheckboxFlag++}},updateAllCheckboxStatus(){var e=V.treeConfig;let{afterFullData:t,afterTreeFullData:l,checkboxReserveRowMap:r,selectCheckboxMaps:a,treeIndeterminateRowMaps:o}=W,{checkField:i,checkMethod:n,showReserveStatus:d}=ee.value,u=(0,_util.createHandleGetRowId)(ie).handleGetRowId,s=0,c=0,g=0;e=e?l:t,e.forEach(n?e=>{var t=u(e),l=i?_xeUtils.default.get(e,i):a[t];n({row:e})?(l?s++:o[t]&&c++,g++):l?s++:o[t]&&c++}:e=>{var t=u(e);(i?_xeUtils.default.get(e,i):a[t])?s++:o[t]&&c++,g++}),e=0<e.length&&(0<g?s>=g:s>=e.length);let v=!e&&(1<=s||1<=c);e||v||!d||(v=!_xeUtils.default.isEmpty(r)),B.isAllSelected=e,B.isIndeterminate=v},checkSelectionStatus(){ie.updateCheckboxStatus(),ie.updateAllCheckboxStatus()},handleBatchSelectRows(e,l,r){var t=V.treeConfig;let a=W.selectCheckboxMaps;var o=oe.value,{transform:i,mapChildrenField:n}=o,o=o.children||o.childrenField,d=ee.value;let{checkField:u,checkStrictly:s,checkMethod:c}=d,g=(0,_util.createHandleGetRowId)(ie).handleGetRowId,v=d.indeterminateField||d.halfField;u?(t&&!s?_xeUtils.default.eachTree(e,e=>{!r&&c&&!c({row:e})||(_xeUtils.default.set(e,u,l),v&&_xeUtils.default.set(e,v,!1),$t(e,l))},{children:i?n:o}):e.forEach(e=>{!r&&c&&!c({row:e})||(_xeUtils.default.set(e,u,l),$t(e,l))}),B.updateCheckboxFlag++):t&&!s?(_xeUtils.default.eachTree(e,e=>{var t=g(e);!r&&c&&!c({row:e})||(l?a[t]=e:a[t]&&delete a[t],$t(e,l))},{children:i?n:o}),B.updateCheckboxFlag++):e.forEach(e=>{var t=g(e);!r&&c&&!c({row:e})||(l?a[t]||(a[t]=e):a[t]&&delete a[t],$t(e,l),B.updateCheckboxFlag++)})},handleSelectRow({row:e},t,l){ie.handleBatchSelectRows([e],t,l)},triggerHeaderTitleEvent(l,e,r){var a=e.content||e.message;if(a){var o=B.tooltipStore,r=r.column;let t=(0,_utils.getFuncText)(a);Il(!0),o.row=null,o.column=r,o.visible=!0,o.currOpts=e,(0,_vue.nextTick)(()=>{var e=$.value;e&&e.open&&e.open(l.currentTarget,t)})}},triggerHeaderTooltipEvent(e,t){var l,r=B.tooltipStore,a=t.column,e=(Il(!0),e.currentTarget);!e||!(e=e.parentElement)||!(l=e.parentElement)||r.column===a&&r.visible||Al(0,l,l.querySelector(".vxe-cell--wrapper"),l.querySelector(".vxe-cell--title")||e,t)},triggerBodyTooltipEvent(e,t){var l=V.editConfig,r=B.editStore,a=B.tooltipStore,o=te.value,r=r.actived,{row:i,column:n}=t,e=e.currentTarget;if(Il(a.column!==n||a.row!==i),n.editRender&&(0,_utils.isEnableConf)(l)){if("row"===o.mode&&r.row===i)return;if(r.row===i&&r.column===n)return}a.column===n&&a.row===i&&a.visible||Al(0,e,e.querySelector(".vxe-cell--wrapper"),e.querySelector(".vxe-cell--label")||e.querySelector(".vxe-cell--wrapper"),t)},triggerFooterTooltipEvent(e,t){var l=t.column,r=B.tooltipStore,e=e.currentTarget;Il(r.column!==l||!!r.row),r.column===l&&r.visible||Al(0,e,e.querySelector(".vxe-cell--wrapper"),e.querySelector(".vxe-cell--label")||e.querySelector(".vxe-cell--wrapper"),t)},handleTargetLeaveEvent(){var e=Pe.value;let t=$.value;t&&t.setActived&&t.setActived(!1),e.enterable?W.tooltipTimeout=setTimeout(()=>{(t=$.value)&&t.isActived&&!t.isActived()&&ie.closeTooltip()},e.leaveDelay):ie.closeTooltip()},triggerHeaderCellClickEvent(e,t){var l=W._lastResizeTime,r=R.value,a=G.value,o=He.value,i=t.column,n=e.currentTarget,l=l&&l>Date.now()-300,d=(0,_dom.getEventTargetNode)(e,n,"vxe-cell--sort").flag,u=(0,_dom.getEventTargetNode)(e,n,"vxe-cell--filter").flag;"cell"!==r.trigger||l||d||u||ie.triggerSortEvent(e,i,xt(i)),ne("header-cell-click",Object.assign({triggerResizable:l,triggerSort:d,triggerFilter:u,cell:n},t),e),!a.isCurrent&&!V.highlightCurrentColumn||o.trigger&&!["header","default"].includes(o.trigger)||ie.triggerCurrentColumnEvent(e,t)},triggerHeaderCellDblclickEvent(e,t){ne("header-cell-dblclick",Object.assign({cell:e.currentTarget},t),e)},triggerCellClickEvent(e,t){var l,r,a,o,i,n,d,u,s,c,g,v,h,f,m,p,x,_,w,C,{highlightCurrentRow:b,highlightCurrentColumn:R,editConfig:E}=V,{editStore:y,isDragResize:S}=B;S||(S=ae.value,l=te.value,r=oe.value,a=D.value,o=ee.value,i=re.value,n=Z.value,d=G.value,u=He.value,{actived:y,focused:s}=y,{row:c,column:g}=t,{type:h,treeNode:v}=g,f="checkbox"===h,m="expand"===h,p=e.currentTarget,x=(h="radio"===h)&&(0,_dom.getEventTargetNode)(e,p,"vxe-cell--radio").flag,_=f&&(0,_dom.getEventTargetNode)(e,p,"vxe-cell--checkbox").flag,w=v&&(0,_dom.getEventTargetNode)(e,p,"vxe-tree--btn-wrapper").flag,C=m&&(0,_dom.getEventTargetNode)(e,p,"vxe-table--expanded").flag,t=Object.assign({cell:p,triggerRadio:x,triggerCheckbox:_,triggerTreeNode:w,triggerExpandNode:C},t),!_&&!x&&(!C&&("row"===S.trigger||m&&"cell"===S.trigger)&&ie.triggerRowExpandEvent(e,t),"row"===r.trigger||v&&"cell"===r.trigger)&&ie.triggerTreeExpandEvent(e,t),w||(C||(!n.isCurrent&&!b||_||x||ie.triggerCurrentRowEvent(e,t),!d.isCurrent&&!R||u.trigger&&!["cell","default"].includes(u.trigger)||_||x||ie.triggerCurrentColumnEvent(e,t),!x&&("row"===a.trigger||h&&"cell"===a.trigger)&&ie.triggerRadioRowEvent(e,t),!_&&("row"===o.trigger||f&&"cell"===o.trigger)&&ie.handleToggleCheckRowEvent(e,t)),(0,_utils.isEnableConf)(E)&&(i.arrowCursorLock&&e&&"cell"===l.mode&&e.target&&/^input|textarea$/i.test(e.target.tagName)&&(s.column=g,s.row=c),"manual"===l.trigger?y.args&&y.row===c&&g!==y.column&&Yt(e,t):y.args&&c===y.row&&g===y.column||("click"===l.trigger||"dblclick"===l.trigger&&"row"===l.mode&&y.row===c)&&Yt(e,t))),(0,_utils.isEnableConf)(E)&&"dblclick"===l.trigger&&y.row&&y.column&&("row"===l.mode?ie.eqRow(y.row,c)||ie.handleClearEdit(e):"cell"!==l.mode||ie.eqRow(y.row,c)&&y.column.id===g.id||ie.handleClearEdit(e)),ne("cell-click",t,e))},triggerCellDblclickEvent(e,t){var l,r=V.editConfig,{editStore:a,isDragResize:o}=B;o||(o=te.value,a=a.actived,l=e.currentTarget,t=Object.assign({cell:l},t),!(0,_utils.isEnableConf)(r)||"dblclick"!==o.trigger||a.args&&e.currentTarget===a.args.cell||("row"===o.mode?Bt("blur").catch(e=>e).then(()=>{ie.handleEdit(t,e).then(()=>Bt("change")).catch(e=>e)}):"cell"===o.mode&&ie.handleEdit(t,e).then(()=>Bt("change")).catch(e=>e)),ne("cell-dblclick",t,e))},handleToggleCheckRowEvent(t,l){var r=W.selectCheckboxMaps,{checkField:a,trigger:e}=ee.value,o=l.row;if("manual"!==e){let e=!1;e=a?!_xeUtils.default.get(o,a):!r[(0,_util.getRowid)(ie,o)],t?ie.triggerCheckRowEvent(t,l,e):(ie.handleBatchSelectRows([o],e),ie.checkSelectionStatus())}},triggerCheckRowEvent(t,l,e){var r=l.row,a=W.afterFullData,o=ee.value,{checkMethod:i,trigger:n}=o;if("manual"!==n){if(t.stopPropagation(),o.isShiftKey&&t.shiftKey&&!V.treeConfig){n=ie.getCheckboxRecords();if(n.length){o=n[0],n=ie.getVTRowIndex(r),o=ie.getVTRowIndex(o);if(n!==o){ie.setAllCheckboxRow(!1);let e=n<o?a.slice(n,o+1):a.slice(o,n+1);return(0,_vue.nextTick)(()=>{p(e,!0,!1)}),void ne("checkbox-range-select",Object.assign({rangeRecords:e},l),t)}}}i&&!i({row:r})||(ie.handleBatchSelectRows([r],e),ie.checkSelectionStatus(),ne("checkbox-change",Object.assign({records:()=>ie.getCheckboxRecords(),reserves:()=>ie.getCheckboxReserveRecords(),indeterminates:()=>ie.getCheckboxIndeterminateRecords(),checked:e},l),t))}},triggerCheckAllEvent(e,t){var l=ee.value.trigger;"manual"!==l&&(e&&e.stopPropagation(),gl(e,t))},triggerRadioRowEvent(l,r){var a=B.selectRadioRow,o=r.row,i=D.value,e=i.trigger;if("manual"!==e){l.stopPropagation();let e=o,t=a!==e;t?Xt(e):i.strict||(t=a===e)&&(e=null,P.clearRadioRow()),t&&ne("radio-change",Object.assign({oldValue:a,newValue:e},r),l)}},triggerCurrentColumnEvent(e,t){var l=G.value.currentMethod,t=t.column;l&&!l({column:t})||P.setCurrentColumn(t)},triggerCurrentRowEvent(e,t){var l=B.currentRow,r=Z.value.currentMethod,a=t.row,o=l!==a;r&&!r({row:a})||(P.setCurrentRow(a),o&&ne("current-change",Object.assign({oldValue:l,newValue:a},t),e))},triggerRowExpandEvent(e,t){var l=B.expandColumn,r=W.rowExpandLazyLoadedMaps,t=t.row,{lazy:a,trigger:o}=ae.value;"manual"===o||(e.stopPropagation(),o=(0,_util.getRowid)(ie,t),a&&r[o])||(a=!ie.isRowExpandByRow(t),r=ie.getColumnIndex(l),o=ie.getVMColumnIndex(l),ie.setRowExpand(t,a),ne("toggle-row-expand",{expanded:a,column:l,columnIndex:r,$columnIndex:o,row:t,rowIndex:ie.getRowIndex(t),$rowIndex:ie.getVMRowIndex(t)},e))},triggerTreeExpandEvent(e,t){var l=W.treeExpandLazyLoadedMaps,{row:t,column:r}=t,{lazy:a,trigger:o}=oe.value;"manual"===o||(e.stopPropagation(),o=(0,_util.getRowid)(ie,t),a&&l[o])||(a=!ie.isTreeExpandByRow(t),l=ie.getColumnIndex(r),o=ie.getVMColumnIndex(r),ie.setTreeExpand(t,a),ne("toggle-tree-expand",{expanded:a,column:r,columnIndex:l,$columnIndex:o,row:t},e))},handleColumnSortEvent(e,t){var l=V.mouseConfig,r=le.value,{field:a,sortable:o}=t;o&&(o={$table:ie,$event:e,column:t,field:a,property:a,order:t.order,sortList:P.getSortColumns(),sortTime:t.sortTime},l&&r.area&&ie.handleSortEvent&&ie.handleSortEvent(e,o),ne("sort-change",o,e))},triggerSortEvent(e,t,l){var{multiple:r,allowClear:a}=R.value,{field:o,sortable:i}=t;i&&(l&&t.order!==l?P.sort({field:o,order:l}):a&&P.clearSort(r?t:null),ie.handleColumnSortEvent(e,t))},handleCellRuleUpdateStatus(e,t,r){let a=B.validStore,{row:o,column:i}=t;if(ie.hasCellRules&&ie.hasCellRules(e,o,i)){let l=ie.getCellElement(o,i);if(l){let t=!_xeUtils.default.isUndefined(r);return ie.validCellRules(e,o,i,r).then(()=>{t&&a.visible&&(0,_util.setCellValue)(o,i,r),ie.clearValidate(o,i)}).catch(({rule:e})=>{t&&(0,_util.setCellValue)(o,i,r),ie.showValidTooltip({rule:e,row:o,column:i,cell:l})})}}return(0,_vue.nextTick)()},triggerHeaderCellMousedownEvent(e,t){var l=V.mouseConfig,r=le.value,a=G.value,{trigger:o,isCrossDrag:i,isPeerDrag:n,disabledMethod:d}=Q.value,u=e.currentTarget,s=u&&u.tagName&&"input"===u.tagName.toLowerCase(),c=(0,_dom.getEventTargetNode)(e,u,"vxe-cell--checkbox").flag,g=(0,_dom.getEventTargetNode)(e,u,"vxe-cell--sort").flag,v=(0,_dom.getEventTargetNode)(e,u,"vxe-cell--filter").flag;let h=!1;a=a.drag&&"cell"===o;s||c||g||v||(o=t.column,!a)||o.fixed||!i&&!n&&o.parentId||d&&d(t)||(h=!0,ie.handleHeaderCellDragMousedownEvent(e,t)),!h&&l&&r.area&&ie.handleHeaderCellAreaEvent&&ie.handleHeaderCellAreaEvent(e,Object.assign({cell:u,triggerSort:g,triggerFilter:v},t)),ie.focus(),ie.closeMenu&&ie.closeMenu()},triggerCellMousedownEvent(e,t){var l=t.column,{type:r,treeNode:a}=l,o="radio"===r,i="checkbox"===r,r="expand"===r,n=Z.value,{trigger:d,isCrossDrag:u,isPeerDrag:s,disabledMethod:c}=J.value,g=e.currentTarget,v=(t.cell=g)&&g.tagName&&"input"===g.tagName.toLowerCase(),o=o&&(0,_dom.getEventTargetNode)(e,g,"vxe-cell--radio").flag,i=i&&(0,_dom.getEventTargetNode)(e,g,"vxe-cell--checkbox").flag,a=a&&(0,_dom.getEventTargetNode)(e,g,"vxe-tree--btn-wrapper").flag,r=r&&(0,_dom.getEventTargetNode)(e,g,"vxe-table--expanded").flag;let h=!1,f=(n.drag&&(h="row"===d||l.dragSort&&"cell"===d),!1);v||o||i||a||r||!h||!u&&!s&&t.level||c&&c(t)||(f=!0,ie.handleCellDragMousedownEvent(e,t)),!f&&ie.handleCellMousedownEvent&&ie.handleCellMousedownEvent(e,t),ie.focus(),ie.closeFilter(),ie.closeMenu&&ie.closeMenu()},triggerCellMouseupEvent(){Ml()},handleRowDragDragstartEvent(e){e.dataTransfer&&e.dataTransfer.setDragImage((0,_dom.getTpImg)(),0,0)},handleRowDragSwapEvent(d,e,u,s,c,t){let{treeConfig:g,dragConfig:l}=V;var r=J.value;let{afterFullData:v,tableFullData:h,fullAllDataRowIdData:f}=W,{isPeerDrag:m,isCrossDrag:p,isSelfToChildDrag:x,dragEndMethod:a,dragToChildMethod:o}=r;r=oe.value;let{transform:_,rowField:w,mapChildrenField:C,parentField:b}=r,R=r.children||r.childrenField;r=a||(l?l.dragEndMethod:null);let E="bottom"===c?1:0,y={status:!1};if(s&&u&&s!==u){var i={oldRow:u,newRow:s,dragRow:u,dragPos:c,dragToChild:!!t,offsetIndex:E};let n=x&&o?o(i):t;return Promise.resolve(!r||r(i)).then(l=>{if(!l)return y;let e=-1,t=-1;if(g){if(_){var l=(0,_util.getRowid)(ie,u),l=f[l],r=(0,_util.getRowid)(ie,s),a=f[r];if(l&&a){var o=l.level,i=a.level;let t={},e=(_xeUtils.default.eachTree([u],e=>{t[(0,_util.getRowid)(ie,e)]=e},{children:C}),!1);if(o&&i)if(m&&!p){if(l.row[b]!==a.row[b])return y}else{if(!p)return y;if(t[r]&&(e=!0,!p||!x))return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.error.treeDragChild")}),y}else if(o){if(!p)return y}else if(i){if(!p)return y;if(t[r]&&(e=!0,!p||!x))return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.error.treeDragChild")}),y}l=_xeUtils.default.toTreeArray(W.afterTreeFullData,{key:w,parentKey:b,children:C}),a=ie.findRowIndexOf(l,u),o=(l.splice(a,1),ie.findRowIndexOf(l,s)),i=o+E;l.splice(i,0,u),e&&p&&x&&_xeUtils.default.each(u[R],e=>{e[b]=u[b]}),u[b]=n?s[w]:s[b],W.tableFullTreeData=_xeUtils.default.toArrayTree(l,{key:w,parentKey:b,children:R,mapChildren:C})}}}else{e=ie.findRowIndexOf(v,u);r=ie.findRowIndexOf(h,u),a=(v.splice(e,1),h.splice(r,1),ie.findRowIndexOf(v,s)),o=ie.findRowIndexOf(h,s),i=(t=a+E,o+E);v.splice(t,0,u),h.splice(i,0,u)}return B.isDragRowMove=!0,ie.handleTableData(g&&_),ie.cacheRowMap(!1),sl(),g&&_||ie.updateAfterDataIndex(),ie.checkSelectionStatus(),B.scrollYLoad&&ie.updateScrollYSpace(),d&&ne("row-dragend",{oldRow:u,newRow:s,dragRow:u,dragPos:c,dragToChild:n,offsetIndex:E,_index:{newIndex:t,oldIndex:e}},d),(0,_vue.nextTick)().then(()=>{ie.updateCellAreas(),ie.recalculate()}).then(()=>({status:!0}))}).catch(()=>y)}return Promise.resolve(y)},handleRowDragDragendEvent(e){var t=V.treeConfig,{fullAllDataRowIdData:l,prevDragToChild:r}=W,a=B.dragRow,o=oe.value,i=o.lazy,o=o.hasChild||o.hasChildField,{prevDragRow:n,prevDragPos:d}=W;t&&i&&r&&(t=l[(0,_util.getRowid)(ie,n)],n[o])&&(!t||!t.treeLoaded)||ie.handleRowDragSwapEvent(e,!0,a,n,d,r),Ul(),Ll(),W.prevDragToChild=!1,B.dragRow=null,B.dragCol=null,setTimeout(()=>{B.isDragRowMove=!1},500)},handleRowDragDragoverEvent(l){var r=V.treeConfig,a=W.fullAllDataRowIdData;let e=B.dragRow;var o=oe.value,{lazy:i,transform:n,parentField:d}=o,o=o.hasChild||o.hasChildField,{isPeerDrag:u,isCrossDrag:s,isToChildDrag:c}=J.value;if(e){var g=l.ctrlKey,v=l.currentTarget;let e=v.getAttribute("rowid")||"";var h=a[e];if(h){var f=h.row;let e=(0,_util.getRowid)(ie,f);a=a[e];l.preventDefault();let t=B.dragRow;var m=l.clientY-v.getBoundingClientRect().y<v.clientHeight/2?"top":"bottom";W.prevDragToChild=!!(r&&n&&s&&c&&g),W.prevDragRow=f,W.prevDragPos=m,ie.eqRow(t,f)||g&&r&&i&&f[o]&&a&&!a.treeLoaded||!s&&r&&n&&(u?t[d]!==f[d]:h.level)?kl(l,v,null,!1,m):(kl(l,v,null,!0,m),ne("row-dragover",{oldRow:t,targetRow:f,dragPos:m},l))}}else l.preventDefault()},handleCellDragMousedownEvent(e,t){var l=(e.stopPropagation(),V).dragConfig,{trigger:r,dragStartMethod:a}=J.value,o=t.row,i=e.currentTarget,i="cell"===r||"row"===r?i:null==(r=i.parentElement)?void 0:r.parentElement,r=i.parentElement,a=a||(l?l.dragStartMethod:null);Ll(),a&&!a(t)?(r.draggable=!1,B.dragRow=null,B.dragCol=null,Ul()):(B.dragRow=o,B.dragCol=null,r.draggable=!0,(e=>{var t=q.value;if(t){e=(0,_util.getRowid)(ie,e);_xeUtils.default.arrayEach(t.querySelectorAll(`[rowid="${e}"]`),e=>{(0,_dom.addClass)(e,"row--drag-origin")})}})(o),(e=>{var t=V.dragConfig,l=B.dragRow,r=J.value.tooltipMethod,r=r||(t?t.rowTooltipMethod:null);let a="";a=r?""+(r({row:l})||""):getI18n("vxe.table.dragTip",[e.textContent||""]),B.dragTipText=a})(i),ne("row-dragstart",t,e))},handleCellDragMouseupEvent(){Ml()},handleHeaderCellDragDragstartEvent(e){e.dataTransfer&&e.dataTransfer.setDragImage((0,_dom.getTpImg)(),0,0)},handleColDragSwapColumn(){ol(),dl(!1).then(()=>{ie.updateCellAreas(),ie.saveCustomStore("update:sort")})},handleColDragSwapEvent(c,g,e,t,v,l){let h=V.mouseConfig;let{isPeerDrag:f,isCrossDrag:m,isSelfToChildDrag:p,isToChildDrag:x,dragEndMethod:r,dragToChildMethod:a}=Q.value,_=W.collectColumn,w="right"===v?1:0,C={status:!1};if(t&&e&&t!==e){let d=e,u=t;e={oldColumn:d,newColumn:u,dragColumn:d,dragPos:v,dragToChild:!!l,offsetIndex:w};let s=p&&a?a(e):l;return Promise.resolve(!r||r(e)).then(e=>{if(!e)return C;let t=-1,l=-1,r={},a=(_xeUtils.default.eachTree([d],e=>{r[e.id]=e}),!1);if(d.parentId&&u.parentId)if(f&&!m){if(d.parentId!==u.parentId)return C}else{if(!m)return C;if(r[u.id]&&(a=!0,!m||!p))return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.error.treeDragChild")}),C}else if(d.parentId){if(!m)return C}else if(u.parentId){if(!m)return C;if(r[u.id]&&(a=!0,!m||!p))return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.error.treeDragChild")}),C}var o,i,n,e=_xeUtils.default.findTree(_,e=>e.id===d.id),e=(a&&m&&p?e&&({items:o,index:n}=e,(i=d.children||[]).forEach(e=>{e.parentId=d.parentId}),o.splice(n,1,...i),d.children=[]):e&&({items:o,index:n,parent:i}=e,o.splice(n,1),i||(t=n)),_xeUtils.default.findTree(_,e=>e.id===u.id));return e&&({items:o,index:i,parent:n}=e,m&&x&&s?(d.parentId=u.id,u.children=(u.children||[]).concat([d])):(d.parentId=u.parentId,o.splice(i+w,0,d)),n||(l=i)),_xeUtils.default.eachTree(_,(e,t,l,r,a)=>{a||(e.renderSortNumber=t+1)}),B.isDragColMove=!0,h&&(ie.clearSelected&&ie.clearSelected(),ie.clearCellAreas)&&(ie.clearCellAreas(),ie.clearCopyCellArea()),c&&ne("column-dragend",{oldColumn:d,newColumn:u,dragColumn:d,dragPos:v,dragToChild:s,offsetIndex:w,_index:{newIndex:l,oldIndex:t}},c),g&&ie.handleColDragSwapColumn(),{status:!0}}).catch(()=>C)}return Promise.resolve(C)},handleHeaderCellDragDragendEvent(e){var t=B.dragCol,{prevDragCol:l,prevDragPos:r,prevDragToChild:a}=W;ie.handleColDragSwapEvent(e,!0,t,l,r,a),Ul(),Fl(),W.prevDragToChild=!1,B.dragRow=null,B.dragCol=null,setTimeout(()=>{B.isDragColMove=!1,ie.recalculate().then(()=>{il()})},500)},handleHeaderCellDragDragoverEvent(e){var t,l,r,a,o,i=B.dragCol,{isToChildDrag:n,isPeerDrag:d,isCrossDrag:u}=Q.value;i?(o=e.ctrlKey,r=(l=e.currentTarget).getAttribute("colid"),(r=ie.getColumnById(r))&&(e.preventDefault(),t=e.clientX,a=t-l.getBoundingClientRect().x<l.clientWidth/2?"left":"right",W.prevDragToChild=!!(u&&n&&o),W.prevDragCol=r,W.prevDragPos=a,r.fixed||i&&i.id===r.id||!u&&(d?i.parentId!==r.parentId:r.parentId)?kl(e,null,l,!1,a):(kl(e,null,l,!0,a),ne("column-dragover",{oldColumn:i,targetColumn:r,dragPos:a},e),(n=q.value)&&(o=S.value,d=(u=_.value)?u.$el:null,l=o||d)&&(i=n.getBoundingClientRect(),r=n.clientWidth,u=(a=N.value)?a.clientWidth:0,d=(o=X.value)?o.clientWidth:0,n=t-(i.x+u),a=i.x+r-d-t,0<n&&n<=28?(o=Math.floor(r/(14<n?240:120)),l.scrollLeft-=o*(28-n)):0<a&&a<=28&&(u=Math.floor(r/(14<a?240:120)),l.scrollLeft+=u*(28-a)))))):e.preventDefault()},handleHeaderCellDragMousedownEvent(e,t){e.stopPropagation();var l=Q.value,{trigger:l,dragStartMethod:r}=l,a=t.column,o=e.currentTarget,o="cell"===l?o:null==(l=o.parentElement)?void 0:l.parentElement;B.isDragColMove=!1,Fl(),r&&!r(t)?(o.draggable=!1,B.dragRow=null,B.dragCol=null,Ul()):(B.dragCol=a,B.dragRow=null,o.draggable=!0,(e=>{var l=q.value;if(l){let t=[];_xeUtils.default.eachTree([e],e=>{t.push(`[colid="${e.id}"]`)});_xeUtils.default.arrayEach(l.querySelectorAll(t.join(",")),e=>{(0,_dom.addClass)(e,"col--drag-origin")})}})(a),(e=>{var t=B.dragCol,l=Q.value.tooltipMethod;let r="";r=l?""+(l({column:t})||""):getI18n("vxe.table.dragTip",[e.textContent||""]),B.dragTipText=r})(o),ne("column-dragstart",t,e))},handleHeaderCellDragMouseupEvent(){Fl(),Ul(),B.dragRow=null,B.dragCol=null,B.isDragColMove=!1},handleScrollEvent(u,s,c,g,v,h){var f=V.highlightHoverRow,{lastScrollLeft:m,lastScrollTop:p}=W,x=S.value,_=T.value;if(x&&_){var w=Z.value,C=me.value,b=$.value,R=_.clientHeight,E=x.clientWidth,_=_.scrollHeight,x=x.scrollWidth;let e=!1,t=!1,l=!1,r=!1,a="",o=!1,i=!1,n=!1,d=!1;c&&(y=O.value,(l=v<=0)||(r=x<=v+E),m<v?(a="right",x-y<=v+E&&(d=!0)):(a="left",v<=y&&(n=!0)),ie.checkScrolling(),W.lastScrollLeft=v),s&&(m=z.value,(e=g<=0)||(t=_<=g+R),p<g?(a="bottom",_-m<=g+R&&(i=!0)):(a="top",g<=m&&(o=!0)),W.lastScrollTop=g),B.isDragColMove=!1,B.isDragRowMove=!1,B.lastScrollTime=Date.now();var y=Object.assign({scrollTop:g,scrollLeft:v,bodyHeight:R,bodyWidth:E,scrollHeight:_,scrollWidth:x,isX:c,isY:s,isTop:e,isBottom:t,isLeft:l,isRight:r,direction:a},h);xl(),((e,t)=>{let{scrollXLoad:l,scrollYLoad:r}=B;var a=W.lcsTimeout;a&&clearTimeout(a),W.lcsTimeout=setTimeout(()=>{W.lcsRunTime=Date.now(),W.lcsTimeout=void 0,W.intoRunScroll=!1,W.inVirtualScroll=!1,W.inWheelScroll=!1,W.inHeaderScroll=!1,W.inBodyScroll=!1,W.inFooterScroll=!1,W.scrollRenderType="",zt(),e&&l&&ie.updateScrollXData(),t&&r&&ie.updateScrollYData().then(()=>{zt(),ie.updateScrollYSpace()}),xl(),ie.updateCellAreas()},200)})(c,s),(w.isHover||f)&&ie.clearHoverRow(),C&&C.reactData.visible&&C.close(),b&&b.reactData.visible&&b.close(),(i||o||d||n)&&ne("scroll-boundary",y,u),ne("scroll",y,u)}},triggerScrollXEvent(){(f.value.immediate?il:()=>{var{lxTimeout:e,lxRunTime:t,scrollXStore:l}=W,l=l.visibleSize,l=Math.max(5,Math.min(10,Math.floor(l/3)));e&&clearTimeout(e),(!t||t+l<Date.now())&&(W.lxRunTime=Date.now(),il()),W.lxTimeout=setTimeout(()=>{W.lxTimeout=void 0,W.lxRunTime=void 0,il()},l)})()},triggerScrollYEvent(){(m.value.immediate?vl:()=>{var{lyTimeout:e,lyRunTime:t,scrollYStore:l}=W,l=l.visibleSize,l=Math.floor(Math.max(4,Math.min(10,l/3)));e&&clearTimeout(e),(!t||t+l<Date.now())&&(W.lyRunTime=Date.now(),vl()),W.lyTimeout=setTimeout(()=>{W.lyTimeout=void 0,W.lyRunTime=void 0,vl()},l)})()},triggerBodyScrollEvent(l,r){var{scrollYLoad:a,scrollXLoad:o}=B,{elemStore:i,intoRunScroll:n,lastScrollTop:d,lastScrollLeft:u,inWheelScroll:s,inVirtualScroll:c,inHeaderScroll:g,inBodyScroll:v,scrollRenderType:e,inFooterScroll:h}=W;if(!(s||c||g||h)){var s=S.value,c=T.value,g=(0,_util.getRefElem)(i["left-body-scroll"]),h=(0,_util.getRefElem)(i["main-body-scroll"]),f=(0,_util.getRefElem)(i["right-body-scroll"]),m=(0,_util.getRefElem)(i["main-header-scroll"]),i=(0,_util.getRefElem)(i["main-footer-scroll"]),p=j.value;if(!n&&h&&s&&c&&(!v||e===r)){let e=c.scrollTop,t=s.scrollLeft;g&&"left"===r?e=g.scrollTop:f&&"right"===r?e=f.scrollTop:(e=h.scrollTop,t=h.scrollLeft);n=t!==u,v=e!==d;W.inBodyScroll=!0,W.scrollRenderType=r,v&&("left"===r?((0,_dom.setScrollTop)(h,e),(0,_dom.setScrollTop)(f,e)):"right"===r?((0,_dom.setScrollTop)(h,e),(0,_dom.setScrollTop)(g,e)):((0,_dom.setScrollTop)(g,e),(0,_dom.setScrollTop)(f,e)),(0,_dom.setScrollTop)(c,e),(0,_dom.setScrollTop)(p,e),a)&&ie.triggerScrollYEvent(l),n&&((0,_dom.setScrollLeft)(s,t),(0,_dom.setScrollLeft)(m,t),(0,_dom.setScrollLeft)(i,t),o)&&ie.triggerScrollXEvent(l),ie.handleScrollEvent(l,v,n,e,t,{type:"body",fixed:r})}}},triggerHeaderScrollEvent(e,t){var l=B.scrollXLoad,{elemStore:r,intoRunScroll:a,inWheelScroll:o,inVirtualScroll:i,inBodyScroll:n,inFooterScroll:d}=W;o||i||n||d||(o=T.value,i=S.value,n=(0,_util.getRefElem)(r["main-body-scroll"]),d=(0,_util.getRefElem)(r["main-header-scroll"]),r=(0,_util.getRefElem)(r["main-footer-scroll"]),a)||d&&i&&o&&(a=o.scrollTop,o=d.scrollLeft,W.inHeaderScroll=!0,(0,_dom.setScrollLeft)(i,o),(0,_dom.setScrollLeft)(r,o),(0,_dom.setScrollLeft)(n,o),l&&ie.triggerScrollXEvent(e),ie.handleScrollEvent(e,!1,!0,a,o,{type:"header",fixed:t}))},triggerFooterScrollEvent(e,t){var l=B.scrollXLoad,{elemStore:r,intoRunScroll:a,inWheelScroll:o,inVirtualScroll:i,inHeaderScroll:n,inBodyScroll:d}=W;o||i||n||d||(o=T.value,i=S.value,n=(0,_util.getRefElem)(r["main-body-scroll"]),d=(0,_util.getRefElem)(r["main-header-scroll"]),r=(0,_util.getRefElem)(r["main-footer-scroll"]),a)||r&&i&&o&&(a=o.scrollTop,o=r.scrollLeft,W.inFooterScroll=!0,(0,_dom.setScrollLeft)(i,o),(0,_dom.setScrollLeft)(d,o),(0,_dom.setScrollLeft)(n,o),l&&ie.triggerScrollXEvent(e),ie.handleScrollEvent(e,!1,!0,a,o,{type:"footer",fixed:t}))},triggerBodyWheelEvent(v){var{target:h,deltaY:f,deltaX:m,shiftKey:p}=v;if(!h||!/^textarea$/i.test(h.tagName)){h=_props.default.highlightHoverRow;let{scrollXLoad:c,scrollYLoad:g,expandColumn:e}=B;var x=Ke.value,_=Ge.value;if(x||_||e){var{elemStore:x,lastScrollTop:_,lastScrollLeft:w}=W,C=Z.value;let r=S.value,a=T.value,o=(0,_util.getRefElem)(x["left-body-scroll"]),i=(0,_util.getRefElem)(x["main-header-scroll"]),n=(0,_util.getRefElem)(x["main-body-scroll"]),d=(0,_util.getRefElem)(x["main-footer-scroll"]),u=(0,_util.getRefElem)(x["right-body-scroll"]),s=j.value;if(r&&a&&n){var x=(e=>{let t=1;var l=Date.now();return l<e+25?t=1.18:l<e+30?t=1.15:l<e+40?t=1.12:l<e+55?t=1.09:l<e+75?t=1.06:l<e+100&&(t=1.03),t})(B.lastScrollTime),b=p?0:Math.ceil(f*x),p=p?Math.ceil((p&&f||m)*x):0,f=b<0,m=n.scrollTop;if(!(f?m<=0:m>=n.scrollHeight-n.clientHeight)){var R,E,x=m+b,f=n.scrollLeft+p;let t=f!==w,l=x!==_;(C.isHover||h)&&ie.clearHoverRow(),t&&(v.preventDefault(),W.inWheelScroll=!0,R=f,E=e=>{W.inWheelScroll=!0;(0,_dom.setScrollLeft)(r,e),(0,_dom.setScrollLeft)(n,e),(0,_dom.setScrollLeft)(i,e),(0,_dom.setScrollLeft)(d,e),c&&ie.triggerScrollXEvent(v),ie.handleScrollEvent(v,l,t,n.scrollTop,e,{type:"table",fixed:""})},requestAnimationFrame(()=>{E(R)})),l&&(v.preventDefault(),W.inWheelScroll=!0,((l,r)=>{let a=Math.abs(l),o=performance.now(),i=0,n=e=>{let t=(e-o)/a;1<t&&(t=1);e=Math.pow(t,2),e=Math.floor(l*e)-i;i+=e,r(e),t<1&&requestAnimationFrame(n)};requestAnimationFrame(n)})(x-m,e=>{W.inWheelScroll=!0;e=n.scrollTop+e;(0,_dom.setScrollTop)(a,e),(0,_dom.setScrollTop)(n,e),(0,_dom.setScrollTop)(o,e),(0,_dom.setScrollTop)(u,e),(0,_dom.setScrollTop)(s,e),g&&ie.triggerScrollYEvent(v),ie.handleScrollEvent(v,l,t,e,n.scrollLeft,{type:"table",fixed:""})}))}}}}},triggerVirtualScrollXEvent(t){var l=B.scrollXLoad,{elemStore:r,inWheelScroll:a,lastScrollTop:o,inHeaderScroll:i,inBodyScroll:n,inFooterScroll:d}=W;if(!(i||n||d||a)){i=(0,_util.getRefElem)(r["main-header-scroll"]),n=(0,_util.getRefElem)(r["main-body-scroll"]),d=(0,_util.getRefElem)(r["main-footer-scroll"]),a=T.value,r=t.currentTarget.scrollLeft,a=a||n;let e=0;a=(e=a?a.scrollTop:e)!==o;W.inVirtualScroll=!0,(0,_dom.setScrollLeft)(n,r),(0,_dom.setScrollLeft)(i,r),(0,_dom.setScrollLeft)(d,r),l&&ie.triggerScrollXEvent(t),ie.handleScrollEvent(t,a,!0,e,r,{type:"table",fixed:""})}},triggerVirtualScrollYEvent(t){var l=B.scrollYLoad,{elemStore:r,inWheelScroll:a,lastScrollLeft:o,inHeaderScroll:i,inBodyScroll:n,inFooterScroll:d}=W;if(!(i||n||d||a)){var i=(0,_util.getRefElem)(r["left-body-scroll"]),n=(0,_util.getRefElem)(r["main-body-scroll"]),d=(0,_util.getRefElem)(r["right-body-scroll"]),a=j.value,r=S.value,u=t.currentTarget.scrollTop,r=r||n;let e=0;r=(e=r?r.scrollLeft:e)!==o;W.inVirtualScroll=!0,(0,_dom.setScrollTop)(n,u),(0,_dom.setScrollTop)(i,u),(0,_dom.setScrollTop)(d,u),(0,_dom.setScrollTop)(a,u),l&&ie.triggerScrollYEvent(t),ie.handleScrollEvent(t,!0,r,u,e,{type:"table",fixed:""})}},scrollToTreeRow(t){var e=V.treeConfig,r=W.tableFullData;let a=[];if(e){e=oe.value,e=e.children||e.childrenField,r=_xeUtils.default.findTree(r,e=>ie.eqRow(e,t),{children:e});if(r){let l=r.nodes;l.forEach((e,t)=>{t<l.length-1&&!P.isTreeExpandByRow(e)&&a.push(P.setTreeExpand(e,!0))})}}return Promise.all(a).then(()=>(0,_util.rowToVisible)(ie,t))},updateScrollYStatus:sl,updateScrollXSpace(){let{isGroup:o,scrollXLoad:i,overflowX:n,scrollXWidth:d}=B,{visibleColumn:u,scrollXStore:s,elemStore:c,fullColumnIdData:g}=W;var v=_.value;if(v?v.$el:null){var v=(0,_util.getRefElem)(c["main-body-scroll"]),h=(0,_util.getRefElem)(c["main-body-table"]),f=(0,_util.getRefElem)(c["main-header-table"]),m=(0,_util.getRefElem)(c["main-footer-table"]);let e=0;var p=u[s.startIndex];p&&(p=g[p.id]||{},e=p.oLeft);let t=0,l=(v&&(t=v.clientWidth),!1),r=d,a=(d>maxXWidth&&(e=v&&h&&v.scrollLeft+t>=maxXWidth?maxXWidth-h.clientWidth:(maxXWidth-t)*(e/(d-t)),r=maxXWidth,l=!0),"");i&&n&&(a=e+"px"),f&&(f.style.marginLeft=o?"":a),h&&(h.style.marginLeft=a),m&&(m.style.marginLeft=a),B.isScrollXBig=l;["main"].forEach(t=>{["header","body","footer"].forEach(e=>{e=(0,_util.getRefElem)(c[t+`-${e}-xSpace`]);e&&(e.style.width=i?r+"px":"")})});p=F.value;p&&(p.style.width=r+"px"),(0,_vue.nextTick)(()=>{b()})}},updateScrollYSpace(){var{isAllOverflow:e,scrollYLoad:t,expandColumn:l}=B;let{scrollYStore:r,elemStore:a,isResizeCellHeight:o,afterFullData:i,fullAllDataRowIdData:n,rowExpandedMaps:d}=W;var u=r.startIndex,s=ae.value,c=Z.value,g=y.value,v=E.value,h=(0,_util.getRefElem)(a["main-body-scroll"]),f=(0,_util.getRefElem)(a["main-body-table"]);let m=0,p=0,x=!1,_=(t?o||g.height||c.height||l||!e?(t=i[u],e=n[(0,_util.getRowid)(ie,t)]||{},m=e.oTop,t=i[i.length-1],e=n[t=(0,_util.getRowid)(ie,t)]||{},p=e.oTop+(e.resizeHeight||g.height||c.height||e.height||v),l&&d[t]&&(p+=e.expandHeight||s.height||0),p>maxYHeight&&(x=!0)):((p=i.length*v)>maxYHeight&&(x=!0),m=Math.max(0,u*v)):f&&(p=f.clientHeight),0),w=(h&&(_=h.clientHeight),p),C=m;x&&(C=h&&f&&h.scrollTop+_>=maxYHeight?maxYHeight-f.clientHeight:(maxYHeight-_)*(m/(p-_)),w=maxYHeight),["main","left","right"].forEach(t=>{var e=(0,_util.getRefElem)(a[t+"-body-table"]);e&&(e.style.marginTop=C?C+"px":""),["header","body","footer"].forEach(e=>{e=(0,_util.getRefElem)(a[t+`-${e}-ySpace`]);e&&(e.style.height=w?w+"px":"")})});g=k.value,g&&(g.style.height=w?w+"px":""),c=L.value;return c&&(c.style.height=w?w+"px":""),B.scrollYTop=C,B.scrollYHeight=p,B.isScrollYBig=x,(0,_vue.nextTick)().then(()=>{b()})},updateScrollXData(){let e=B.isAllOverflow;return al(),ie.updateScrollYSpace(),(0,_vue.nextTick)().then(()=>{al(),ie.updateScrollXSpace(),e||ie.updateScrollYSpace()})},updateScrollYData(){return ie.handleTableData(),ie.updateScrollYSpace(),(0,_vue.nextTick)().then(()=>{ie.handleTableData(),ie.updateScrollYSpace()})},checkScrolling(){var e=W.elemStore,e=(0,_util.getRefElem)(e["main-body-scroll"]),t=N.value,l=X.value,e=S.value||e;e&&(t&&(0<e.scrollLeft?(0,_dom.addClass):(0,_dom.removeClass))(t,"scrolling--middle"),l)&&(e.clientWidth<e.scrollWidth-Math.ceil(e.scrollLeft)?(0,_dom.addClass):(0,_dom.removeClass))(l,"scrolling--middle")},updateZindex(){V.zIndex?W.tZindex=V.zIndex:W.tZindex<(0,_utils.getLastZIndex)()&&(W.tZindex=(0,_utils.nextZIndex)())},handleCheckedCheckboxRow:p,triggerHoverEvent(e,{row:t}){Y.setHoverRow(t)},setHoverRow(e){var t=(0,_util.getRowid)(ie,e),l=q.value;Y.clearHoverRow(),l&&_xeUtils.default.arrayEach(l.querySelectorAll(`.vxe-body--row[rowid="${t}"]`),e=>(0,_dom.addClass)(e,"row--hover")),W.hoverRow=e},clearHoverRow(){var e=q.value;e&&_xeUtils.default.arrayEach(e.querySelectorAll(".vxe-body--row.row--hover"),e=>(0,_dom.removeClass)(e,"row--hover")),W.hoverRow=null},getCell(e,t){return P.getCellElement(e,t)},findRowIndexOf(e,t){return t?_xeUtils.default.findIndexOf(e,e=>ie.eqRow(e,t)):-1},eqRow(e,t){return!(!e||!t||e!==t&&(0,_util.getRowid)(ie,e)!==(0,_util.getRowid)(ie,t))}},"openExport,openPrint,exportData,openImport,importData,saveFile,readFile,importByFile,print".split(",").forEach(e=>{ie[e]=function(){(0,_log.errLog)("vxe.error.reqModule",["VxeTableExportModule"])}}),"clearValidate,fullValidate,validate".split(",").forEach(e=>{ie[e]=function(){(0,_log.errLog)("vxe.error.reqModule",["VxeTableValidatorModule"])}}),Object.assign(ie,P,Y),e=>{var{showHeader:t,showFooter:l}=V,{tableData:r,tableColumn:a,tableGroupColumn:o,columnStore:i,footerTableData:n}=B,d="left"===e,i=d?i.leftList:i.rightList;return(0,_vue.h)("div",{ref:d?N:X,class:`vxe-table--fixed-${e}-wrapper`},[t?(0,_vue.h)(_header.default,{ref:d?g:x,fixedType:e,tableData:r,tableColumn:a,tableGroupColumn:o,fixedColumn:i}):renderEmptyElement(ie),(0,_vue.h)(_body.default,{ref:d?v:w,fixedType:e,tableData:r,tableColumn:a,fixedColumn:i}),l?(0,_vue.h)(_footer.default,{ref:d?h:C,footerTableData:n,tableColumn:a,fixedColumn:i,fixedType:e}):renderEmptyElement(ie)])}),zl=()=>{var e=V.dragConfig,{dragRow:t,dragCol:l,dragTipText:r}=B,a=Q.value,e=(J.value.slots||{}).tip||(e&&e.slots?e.slots.rowTip:null),a=(a.slots||{}).tip;return t&&e?Ol(e,{row:t}):l&&a?Ol(a,{column:l}):[(0,_vue.h)("span",r)]},Nl=()=>{let f=V.treeConfig,m=B.expandColumn;var e=dt.value,t=ae.value.mode;if("fixed"!==t)return renderEmptyElement(ie);let p=[(0,_vue.h)("div",{key:"repY",ref:L})];if(m){let h=(0,_util.createHandleGetRowId)(ie).handleGetRowId;e.forEach(e=>{var{height:t,padding:l}=ae.value,r=W.fullAllDataRowIdData,a=oe.value,{transform:o,seqMode:i}=a,n={},d=h(e),r=r[d];let u=0,s=-1,c=0;var g=ie.getRowIndex(e),v=ie.getVMRowIndex(e),o=(r&&(u=r.level,s=f&&o&&"increasing"===i?r._index+1:r.seq,c=r._index),t&&(n.height=t+"px"),f&&(n.paddingLeft=u*a.indent+30+"px"),{$table:ie,seq:s,column:m,fixed:"",type:"body",level:u,row:e,rowIndex:g,$rowIndex:v,_rowIndex:c});p.push((0,_vue.h)("div",{key:d,class:["vxe-body--row-expanded-cell",{"is--padding":l,"is--ellipsis":t}],rowid:d,style:n},m.renderData(o)))})}return(0,_vue.h)("div",{ref:j,class:"vxe-table--row-expanded-wrapper"},p)},Wl=()=>(0,_vue.h)("div",{key:"vsx",ref:Se,class:"vxe-table--scroll-x-virtual"},[(0,_vue.h)("div",{ref:De,class:"vxe-table--scroll-x-left-corner"}),(0,_vue.h)("div",{ref:Le,class:"vxe-table--scroll-x-wrapper"},[(0,_vue.h)("div",{ref:S,class:"vxe-table--scroll-x-handle",onScroll:ie.triggerVirtualScrollXEvent},[(0,_vue.h)("div",{ref:F,class:"vxe-table--scroll-x-space"})])]),(0,_vue.h)("div",{ref:Ie,class:"vxe-table--scroll-x-right-corner"})]),Pl=()=>(0,_vue.h)("div",{ref:Te,class:"vxe-table--scroll-y-virtual"},[(0,_vue.h)("div",{ref:Me,class:"vxe-table--scroll-y-top-corner"}),(0,_vue.h)("div",{ref:Fe,class:"vxe-table--scroll-y-wrapper"},[(0,_vue.h)("div",{ref:T,class:"vxe-table--scroll-y-handle",onScroll:ie.triggerVirtualScrollYEvent},[(0,_vue.h)("div",{ref:k,class:"vxe-table--scroll-y-space"})])]),(0,_vue.h)("div",{ref:ke,class:"vxe-table--scroll-y-bottom-corner"})]),Vl=()=>{var{showHeader:e,showFooter:t}=V,{overflowX:l,tableData:r,tableColumn:a,tableGroupColumn:o,footerTableData:i,columnStore:n}=B,{leftList:n,rightList:d}=n;return(0,_vue.h)("div",{ref:u,class:"vxe-table--viewport-wrapper"},[(0,_vue.h)("div",{class:"vxe-table--main-wrapper"},[e?(0,_vue.h)(_header.default,{ref:s,tableData:r,tableColumn:a,tableGroupColumn:o}):renderEmptyElement(ie),(0,_vue.h)(_body.default,{ref:_,tableData:r,tableColumn:a}),t?(0,_vue.h)(_footer.default,{ref:c,footerTableData:i,tableColumn:a}):renderEmptyElement(ie)]),(0,_vue.h)("div",{class:"vxe-table--fixed-wrapper"},[n&&n.length&&l?Hl("left"):renderEmptyElement(ie),d&&d.length&&l?Hl("right"):renderEmptyElement(ie)]),Nl()])},Bl=()=>{var e=Oe.value;return(0,_vue.h)("div",{class:"vxe-table--layout-wrapper"},e?[Pl(),Vl()]:[Vl(),Pl()])};let Yl=(0,_vue.ref)(0),ql=((0,_vue.watch)(()=>V.data?V.data.length:-1,()=>{Yl.value++}),(0,_vue.watch)(()=>V.data,()=>{Yl.value++}),(0,_vue.watch)(Yl,()=>{let a=W.initStatus;var e=V.data||[];e&&5e4<=e.length&&(0,_log.warnLog)("vxe.error.errLargeData",["loadData(data), reloadData(data)"]),tl(e,!1).then(()=>{var{scrollXLoad:e,scrollYLoad:t,expandColumn:l}=B,r=ae.value;return W.inited=!0,W.initStatus=!0,a||ll(),(e||t)&&l&&"fixed"!==r.mode&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),P.recalculate()})}),(0,_vue.ref)(0)),$l=((0,_vue.watch)(()=>B.staticColumns.length,()=>{ql.value++}),(0,_vue.watch)(()=>B.staticColumns,()=>{ql.value++}),(0,_vue.watch)(ql,()=>{ul(_xeUtils.default.clone(B.staticColumns))}),(0,_vue.ref)(0)),Xl=((0,_vue.watch)(()=>B.tableColumn.length,()=>{$l.value++}),(0,_vue.watch)(()=>B.tableColumn,()=>{$l.value++}),(0,_vue.watch)($l,()=>{Y.analyColumnWidth()}),(0,_vue.watch)(()=>B.upDataFlag,()=>{(0,_vue.nextTick)(()=>{P.updateData()})}),(0,_vue.watch)(()=>B.reColumnFlag,()=>{(0,_vue.nextTick)(()=>{P.refreshColumn()})}),(0,_vue.ref)(0)),jl=((0,_vue.watch)(ve,()=>{Xl.value++}),(0,_vue.watch)(()=>V.showHeader,()=>{Xl.value++}),(0,_vue.watch)(()=>V.showFooter,()=>{Xl.value++}),(0,_vue.watch)(()=>B.overflowX,()=>{Xl.value++}),(0,_vue.watch)(()=>B.overflowY,()=>{Xl.value++}),(0,_vue.watch)(Xl,()=>{(0,_vue.nextTick)(()=>{P.recalculate(!0).then(()=>P.refreshScroll())})}),(0,_vue.ref)(0)),Kl=((0,_vue.watch)(()=>V.height,()=>{jl.value++}),(0,_vue.watch)(()=>V.maxHeight,()=>{jl.value++}),(0,_vue.watch)(Ae,()=>{jl.value++}),(0,_vue.watch)(Oe,()=>{jl.value++}),(0,_vue.watch)(()=>_ui.VxeUI.getLanguage(),()=>{jl.value++}),(0,_vue.watch)(jl,()=>{(0,_vue.nextTick)(()=>P.recalculate(!0))}),(0,_vue.ref)(0)),Gl=((0,_vue.watch)(()=>V.footerData?V.footerData.length:-1,()=>{Kl.value++}),(0,_vue.watch)(()=>V.footerData,()=>{Kl.value++}),(0,_vue.watch)(Kl,()=>{P.updateFooter()}),(0,_vue.watch)(()=>V.syncResize,e=>{e&&(hl(),(0,_vue.nextTick)(()=>{hl(),setTimeout(()=>hl())}))}),(0,_vue.ref)(0)),Zl=((0,_vue.watch)(()=>V.mergeCells?V.mergeCells.length:-1,()=>{Gl.value++}),(0,_vue.watch)(()=>V.mergeCells,()=>{Gl.value++}),(0,_vue.watch)(Gl,()=>{P.clearMergeCells(),(0,_vue.nextTick)(()=>{V.mergeCells&&P.setMergeCells(V.mergeCells)})}),(0,_vue.ref)(0));(0,_vue.watch)(()=>V.mergeFooterItems?V.mergeFooterItems.length:-1,()=>{Zl.value++}),(0,_vue.watch)(()=>V.mergeFooterItems,()=>{Zl.value++}),(0,_vue.watch)(Zl,()=>{P.clearMergeFooterItems(),(0,_vue.nextTick)(()=>{V.mergeFooterItems&&P.setMergeFooterItems(V.mergeFooterItems)})}),t&&(0,_vue.watch)(()=>t?t.reactData.resizeFlag:null,()=>{Dl()}),hooks.forEach(e=>{var e=e.setupTable;e&&(e=e(ie))&&_xeUtils.default.isObject(e)&&Object.assign(ie,e)}),Y.preventEvent(null,"created",{$table:ie});let Jl;return(0,_vue.onActivated)(()=>{P.recalculate().then(()=>P.refreshScroll()),Y.preventEvent(null,"activated",{$table:ie})}),(0,_vue.onDeactivated)(()=>{W.isActivated=!1,Y.preventEvent(null,"deactivated",{$table:ie})}),(0,_vue.onMounted)(()=>{var e=G.value,t=Z.value,l=I.value,e=((e.drag||t.drag||l.allowSort)&&(0,_dom.initTpImg)(),(0,_vue.nextTick)(()=>{let{data:e,exportConfig:t,importConfig:l,treeConfig:r,showOverflow:a}=V;var{scrollXStore:o,scrollYStore:i}=W,n=te.value,d=oe.value,u=D.value,s=ee.value,c=ae.value,g=Z.value,v=I.value,h=le.value;let f=lt.value,m=rt.value;V.rowId&&(0,_log.warnLog)("vxe.error.delProp",["row-id","row-config.keyField"]),V.rowKey&&(0,_log.warnLog)("vxe.error.delProp",["row-key","row-config.useKey"]),V.columnKey&&(0,_log.warnLog)("vxe.error.delProp",["column-id","column-config.useKey"]),V.rowId||g.keyField||!(s.reserve||s.checkRowKeys||u.reserve||u.checkRowKey||c.expandRowKeys||d.expandRowKeys)||(0,_log.warnLog)("vxe.error.reqProp",["row-config.keyField"]),V.editConfig&&(n.showStatus||n.showUpdateStatus||n.showInsertStatus)&&!V.keepSource&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),!r||!d.showLine&&!d.line||(V.rowKey||g.useKey)&&a||(0,_log.warnLog)("vxe.error.reqProp",["row-config.useKey | show-overflow"]),r&&!d.transform&&V.stripe&&(0,_log.warnLog)("vxe.error.noTree",["stripe"]),!V.showFooter||V.footerMethod||V.footerData||(0,_log.warnLog)("vxe.error.reqProp",["footer-data | footer-method"]),g.height&&(0,_log.warnLog)("vxe.error.delProp",["row-config.height","cell-config.height"]),V.highlightCurrentRow&&(0,_log.warnLog)("vxe.error.delProp",["highlight-current-row","row-config.isCurrent"]),V.highlightHoverRow&&(0,_log.warnLog)("vxe.error.delProp",["highlight-hover-row","row-config.isHover"]),V.highlightCurrentColumn&&(0,_log.warnLog)("vxe.error.delProp",["highlight-current-column","column-config.isCurrent"]),V.highlightHoverColumn&&(0,_log.warnLog)("vxe.error.delProp",["highlight-hover-column","column-config.isHover"]),l&&m.types&&!m.importMethod&&!_xeUtils.default.includeArrays(_xeUtils.default.keys(m._typeMaps),m.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+m.types.join(","),m.types.filter(e=>_xeUtils.default.includes(_xeUtils.default.keys(m._typeMaps),e)).join(",")||_xeUtils.default.keys(m._typeMaps).join(",")]),t&&f.types&&!f.exportMethod&&!_xeUtils.default.includeArrays(_xeUtils.default.keys(f._typeMaps),f.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+f.types.join(","),f.types.filter(e=>_xeUtils.default.includes(_xeUtils.default.keys(f._typeMaps),e)).join(",")||_xeUtils.default.keys(f._typeMaps).join(",")]),V.id||(V.customConfig?(0,_utils.isEnableConf)(v):v.enabled)&&v.storage&&(0,_log.errLog)("vxe.error.reqProp",["id"]),V.treeConfig&&s.range&&(0,_log.errLog)("vxe.error.noTree",["checkbox-config.range"]),g.height&&!V.showOverflow&&(0,_log.warnLog)("vxe.error.notProp",["table.show-overflow"]),!ie.handleCellAreaMousedownEvent&&(V.areaConfig&&(0,_log.warnLog)("vxe.error.notProp",["area-config"]),V.clipConfig&&(0,_log.warnLog)("vxe.error.notProp",["clip-config"]),V.fnrConfig&&(0,_log.warnLog)("vxe.error.notProp",["fnr-config"]),h.area)?(0,_log.errLog)("vxe.error.notProp",["mouse-config.area"]):(r&&g.drag&&!d.transform&&(0,_log.errLog)("vxe.error.notSupportProp",["column-config.drag","tree-config.transform=false","tree-config.transform=true"]),V.dragConfig&&(0,_log.warnLog)("vxe.error.delProp",["drag-config","row-drag-config"]),V.treeConfig&&d.children&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.children","tree-config.childrenField"]),V.treeConfig&&d.line&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.line","tree-config.showLine"]),h.area&&h.selected&&(0,_log.warnLog)("vxe.error.errConflicts",["mouse-config.area","mouse-config.selected"]),h.area&&V.treeConfig&&!d.transform&&(0,_log.errLog)("vxe.error.noTree",["mouse-config.area"]),V.editConfig&&n.activeMethod&&(0,_log.warnLog)("vxe.error.delProp",["edit-config.activeMethod","edit-config.beforeEditMethod"]),V.treeConfig&&s.isShiftKey&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config","checkbox-config.isShiftKey"]),s.halfField&&(0,_log.warnLog)("vxe.error.delProp",["checkbox-config.halfField","checkbox-config.indeterminateField"]),V.editConfig&&!ie.insert&&(0,_log.errLog)("vxe.error.reqModule",["Edit"]),V.editRules&&!ie.validate&&(0,_log.errLog)("vxe.error.reqModule",["Validator"]),(s.range||V.keyboardConfig||V.mouseConfig)&&!ie.handleCellMousedownEvent&&(0,_log.errLog)("vxe.error.reqModule",["Keyboard"]),(V.printConfig||V.importConfig||V.exportConfig)&&!ie.exportData&&(0,_log.errLog)("vxe.error.reqModule",["Export"]),Object.assign(i,{startIndex:0,endIndex:0,visibleSize:0}),Object.assign(o,{startIndex:0,endIndex:0,visibleSize:0}),tl(e||[],!0).then(()=>{e&&e.length&&(W.inited=!0,W.initStatus=!0,ll()),rl(),b()}),V.autoResize&&(u=q.value,c=Y.getParentElem(),Jl=globalResize.create(()=>{V.autoResize&&P.recalculate(!0)}),u&&Jl.observe(u),c)&&Jl.observe(c))}),u.value);e&&e.addEventListener("wheel",ie.triggerBodyWheelEvent,{passive:!1}),globalEvents.on(ie,"paste",yl),globalEvents.on(ie,"copy",Sl),globalEvents.on(ie,"cut",Tl),globalEvents.on(ie,"mousedown",wl),globalEvents.on(ie,"blur",Cl),globalEvents.on(ie,"mousewheel",bl),globalEvents.on(ie,"keydown",El),globalEvents.on(ie,"resize",Dl),globalEvents.on(ie,"contextmenu",ie.handleGlobalContextmenuEvent),Y.preventEvent(null,"mounted",{$table:ie})}),(0,_vue.onBeforeUnmount)(()=>{var e=u.value;e&&e.removeEventListener("wheel",ie.triggerBodyWheelEvent),Jl&&Jl.disconnect(),P.closeFilter(),ie.closeMenu&&ie.closeMenu(),Y.preventEvent(null,"beforeUnmount",{$table:ie})}),(0,_vue.onUnmounted)(()=>{globalEvents.off(ie,"paste"),globalEvents.off(ie,"copy"),globalEvents.off(ie,"cut"),globalEvents.off(ie,"mousedown"),globalEvents.off(ie,"blur"),globalEvents.off(ie,"mousewheel"),globalEvents.off(ie,"keydown"),globalEvents.off(ie,"resize"),globalEvents.off(ie,"contextmenu"),Y.preventEvent(null,"unmounted",{$table:ie})}),(0,_vue.nextTick)(()=>{!V.loading||ce||de.loading||(0,_log.errLog)("vxe.error.reqComp",["vxe-loading"]),!0!==V.showOverflow&&"tooltip"!==V.showOverflow&&!0!==V.showHeaderOverflow&&"tooltip"!==V.showHeaderOverflow&&!0!==V.showFooterOverflow&&"tooltip"!==V.showFooterOverflow&&!V.tooltipConfig&&!V.editRules||ge||(0,_log.errLog)("vxe.error.reqComp",["vxe-tooltip"])}),(0,_vue.provide)("$xeColgroup",null),(0,_vue.provide)("$xeTable",ie),ie.renderVN=()=>{var{loading:e,stripe:t,showHeader:l,height:r,treeConfig:a,mouseConfig:o,showFooter:i,highlightCell:n,highlightHoverRow:d,highlightHoverColumn:u,editConfig:s,editRules:c}=V,{isGroup:g,overflowX:v,overflowY:h,scrollXLoad:f,scrollYLoad:m,tableData:p,initStore:x,columnStore:_,filterStore:w,customStore:O}=B,{leftList:_,rightList:H}=_;let C=de.loading;var b=Ve.value,R=Be.value,E=Ue.value,z=ee.value,y=oe.value,N=Z.value,S=G.value,T=ve.value,D=gt.value,I=le.value,M=qe.value,L=it.value,W=et.value;let F=B.isColLoading||B.isRowLoading||e;var e=Ne.value,k=o&&I.area,P=Q.value,U=Ae.value,A=Oe.value;return(0,_vue.h)("div",{ref:q,class:["vxe-table","vxe-table--render-default","tid_"+ue,"border--"+D,"sx-pos--"+(U?"top":"bottom"),"sy-pos--"+(A?"left":"right"),{["size--"+T]:T,["valid-msg--"+E.msgMode]:!!c,"vxe-editable":!!s,"old-cell-valid":c&&"obsolete"===getConfig().cellVaildMode,"cell--highlight":n,"cell--selected":o&&I.selected,"cell--area":k,"header-cell--area":k&&M.selectCellByHeader,"body-cell--area":k&&M.selectCellByBody,"row--highlight":N.isHover||d,"column--highlight":S.isHover||u,"checkbox--range":z.range,"col--drag-cell":S.drag&&"cell"===P.trigger,"is--header":l,"is--footer":i,"is--group":g,"is--tree-line":a&&(y.showLine||y.line),"is--fixed-left":_.length,"is--fixed-right":H.length,"is--animat":!!V.animat,"is--round":V.round,"is--stripe":!a&&t,"is--loading":F,"is--empty":!F&&!p.length,"is--scroll-y":h,"is--scroll-x":v,"is--virtual-x":f,"is--virtual-y":m}],spellcheck:!1,onKeydown:Rl},[(0,_vue.h)("div",{class:"vxe-table-slots"},de.default?de.default({}):[]),(0,_vue.h)("div",{ref:he,class:"vxe-table-vars"},[(0,_vue.h)("div",{class:"vxe-table-var-default"}),(0,_vue.h)("div",{class:"vxe-table-var-medium"}),(0,_vue.h)("div",{class:"vxe-table-var-small"}),(0,_vue.h)("div",{class:"vxe-table-var-mini"})]),(0,_vue.h)("div",{key:"tw",class:"vxe-table--render-wrapper"},U?[Wl(),Bl()]:[Bl(),Wl()]),(0,_vue.h)("div",{key:"tn",ref:be,class:"vxe-table--empty-placeholder"},[(0,_vue.h)("div",{class:"vxe-table--empty-content"},(D=ot.value,A={$table:ie},de.empty?de.empty(A):(T=(T=D.name?renderer.get(D.name):null)?T.renderTableEmpty||T.renderTableEmptyView||T.renderEmpty:null)?(0,_vn.getSlotVNs)(T(D,A)):(0,_utils.getFuncText)(V.emptyText)||getI18n("vxe.table.emptyText")))]),(0,_vue.h)("div",{key:"tl",class:"vxe-table--border-line"}),(0,_vue.h)("div",{key:"tcl",ref:we,class:"vxe-table--resizable-col-bar"},e.showDragTip?[(0,_vue.h)("div",{class:"vxe-table--resizable-number-tip"})]:[]),(0,_vue.h)("div",{key:"trl",ref:Ce,class:"vxe-table--resizable-row-bar"},e.showDragTip?[(0,_vue.h)("div",{class:"vxe-table--resizable-number-tip"})]:[]),ce?(0,_vue.h)(ce,{key:"lg",class:"vxe-table--loading",modelValue:F,icon:L.icon,text:L.text},C?{default:()=>Ol(C,{$table:ie,$grid:K,loading:F})}:{}):C?(0,_vue.h)("div",{class:["vxe-loading--custom-wrapper",{"is--visible":F}]},Ol(C,{$table:ie,$grid:K,loading:F})):renderEmptyElement(ie),x.custom?(0,_vue.h)(_panel.default,{key:"cs",ref:_e,customStore:O}):renderEmptyElement(ie),x.filter?(0,_vue.h)(_panel2.default,{key:"tf",ref:xe,filterStore:w}):renderEmptyElement(ie),x.import&&V.importConfig?(0,_vue.h)(_importPanel.default,{key:"it",defaultOptions:B.importParams,storeData:B.importStore}):renderEmptyElement(ie),x.export&&(V.exportConfig||V.printConfig)?(0,_vue.h)(_exportPanel.default,{key:"et",defaultOptions:B.exportParams,storeData:B.exportStore}):renderEmptyElement(ie),W?(0,_vue.h)(_panel3.default,{key:"tm",ref:pe}):renderEmptyElement(ie),(()=>{var{dragRow:e,dragCol:t}=B,l=Z.value,r=G.value,a=J.value,o=Q.value;return l.drag||r.drag?(0,_vue.h)("div",{class:"vxe-table--drag-wrapper"},[(0,_vue.h)("div",{ref:Ee,class:["vxe-table--drag-row-line",{"is--guides":a.showGuidesStatus}]}),(0,_vue.h)("div",{ref:ye,class:["vxe-table--drag-col-line",{"is--guides":o.showGuidesStatus}]}),e&&a.showDragTip||t&&o.showDragTip?(0,_vue.h)("div",{ref:Re,class:"vxe-table--drag-sort-tip"},[(0,_vue.h)("div",{class:"vxe-table--drag-sort-tip-wrapper"},[(0,_vue.h)("div",{class:"vxe-table--drag-sort-tip-status"},[(0,_vue.h)("span",{class:["vxe-table--drag-sort-tip-normal-status",e?getIcon().TABLE_DRAG_STATUS_ROW:getIcon().TABLE_DRAG_STATUS_COLUMN]}),(0,_vue.h)("span",{class:["vxe-table--drag-sort-tip-sub-status",getIcon().TABLE_DRAG_STATUS_SUB_ROW]}),(0,_vue.h)("span",{class:["vxe-table--drag-sort-tip-disabled-status",getIcon().TABLE_DRAG_DISABLED]})]),(0,_vue.h)("div",{class:"vxe-table--drag-sort-tip-content"},zl())])]):renderEmptyElement(ie)]):renderEmptyElement(ie)})(),ge?(0,_vue.h)("div",{},[(0,_vue.h)(ge,{key:"ctp",ref:fe,isArrow:!1,enterable:!1}),(0,_vue.h)(ge,{key:"btp",ref:$,theme:b.theme,enterable:b.enterable,enterDelay:b.enterDelay,leaveDelay:b.leaveDelay}),V.editRules&&E.showMessage&&("default"===E.message?!r:"tooltip"===E.message)?(0,_vue.h)(ge,{key:"vtp",ref:me,class:[{"old-cell-valid":c&&"obsolete"===getConfig().cellVaildMode},"vxe-table--valid-error"],theme:R.theme,enterable:R.enterable,enterDelay:R.enterDelay,leaveDelay:R.leaveDelay}):renderEmptyElement(ie)]):renderEmptyElement(ie)])},ie},render(){return this.renderVN()}});