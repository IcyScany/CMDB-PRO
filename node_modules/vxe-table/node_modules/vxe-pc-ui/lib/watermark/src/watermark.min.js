"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_comp=require("../../ui/src/comp"),_xeUtils=_interopRequireDefault(require("xe-utils")),_ui=require("../../ui"),_dom=require("../../ui/src/dom"),_util=require("./util");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default=(0,_comp.defineVxeComponent)({name:"VxeWatermark",props:{width:String,height:String,imageUrl:String,rotate:{type:[Number,String],default:()=>(0,_ui.getConfig)().watermark.rotate},gap:{type:[Array,Number,String],default:()=>_xeUtils.default.clone((0,_ui.getConfig)().watermark.gap,!0)},content:[String,Array],font:Object,offset:Object,zIndex:[String,Number]},emits:[],setup(n,e){const u=e["emit"];var t=_xeUtils.default.uniqueId();const o=(0,_vue.ref)(),l=(0,_vue.reactive)({markUrl:""}),r={refElem:o},s=(0,_vue.computed)(()=>_xeUtils.default.assign({},_xeUtils.default.clone((0,_ui.getConfig)().watermark.font,!0),n.font)),a=(0,_vue.computed)(()=>{var{width:e,height:t,zIndex:r}=n,u=l["markUrl"],a={};return e&&(a.width=(0,_dom.toCssUnit)(e)),t&&(a.height=(0,_dom.toCssUnit)(t)),u&&(a.backgroundImage=`url(${u})`),r&&(a.zIndex=r),a}),i={},_={xID:t,props:n,context:e,reactData:l,getRefMaps:()=>r,getComputeMaps:()=>i};const d=()=>{var{content:e,gap:t,rotate:r,offset:u}=n,a=o.value,i=s.value;a&&e&&(0,_util.getContentUrl)(e,getComputedStyle(a).fontSize,{font:i,rotate:r,gap:t,offset:u}).then(e=>{l.markUrl=e})};Object.assign(_,{dispatchEvent:(e,t,r)=>{u(e,(0,_ui.createEvent)(r,{$watermark:_},t))}},{});return(0,_vue.watch)(()=>n.imageUrl,()=>{d()}),(0,_vue.watch)(()=>n.content,()=>{d()}),(0,_vue.watch)(()=>n.gap,()=>{d()}),(0,_vue.watch)(()=>n.rotate,()=>{d()}),(0,_vue.watch)(()=>n.width,()=>{d()}),(0,_vue.watch)(()=>n.height,()=>{d()}),(0,_vue.watch)(()=>n.font,()=>{d()}),(0,_vue.onMounted)(()=>{d(),_ui.globalEvents.on(_,"resize",_xeUtils.default.throttle(()=>{d()},300,{trailing:!0,leading:!0}))}),(0,_vue.onUnmounted)(()=>{_ui.globalEvents.off(_,"resize")}),_.renderVN=()=>{var e=a.value;return(0,_vue.h)("div",{ref:o,class:"vxe-watermark",style:e})},_},render(){return this.renderVN()}});