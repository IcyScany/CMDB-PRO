!function(e,l){"object"==typeof exports&&"undefined"!=typeof module?module.exports=l(require("vue")):"function"==typeof define&&define.amd?define(["vue"],l):(e="undefined"!=typeof globalThis?globalThis:e||self).ColorPicker=l(e.Vue)}(this,(function(e){"use strict";const l={hsb2rgb(e){var l={},t=Math.round(e.h),a=Math.round(255*e.s/100),o=Math.round(255*e.b/100);if(0==a)l.r=l.g=l.b=o;else{var r=o,n=(255-a)*o/255,i=t%60*(r-n)/60;360==t&&(t=0),t<60?(l.r=r,l.b=n,l.g=n+i):t<120?(l.g=r,l.b=n,l.r=r-i):t<180?(l.g=r,l.r=n,l.b=n+i):t<240?(l.b=r,l.r=n,l.g=r-i):t<300?(l.b=r,l.g=n,l.r=n+i):t<360?(l.r=r,l.g=n,l.b=r-i):(l.r=0,l.g=0,l.b=0)}return{r:Math.round(l.r),g:Math.round(l.g),b:Math.round(l.b),a:e.a}},hsba2rgba(e){const l=this.hsb2rgb(e);return`rgba(${l.r},${l.g},${l.b},${l.a})`},rgba2hex(e){const l=e=>{const l=e.toString(16);return l.length<2?"0"+l:l},t=e.a>=0?Math.round(255*e.a):0;let a="";return 255!==t&&(a=l(t)),"#"+l(e.r)+l(e.g)+l(e.b)+a},hex2rgba(e){const l=9===e.length;return`{r:${parseInt(e.slice(1,3),16)},g:${parseInt(e.slice(3,5),16)},b:${parseInt(e.slice(5,7),16)},a:${l?+(parseInt(e.slice(7,9),16)/255).toFixed(2):1})`},hex2hsb(e){const l=this.hex2rgba(e);return l.a=1,this.rgba2hsba(l)},rgba2hsba(e){var l={h:0,s:0,b:0,a:e.a},t=Math.min(e.r,e.g,e.b),a=Math.max(e.r,e.g,e.b),o=a-t;return l.b=a,l.s=0!=a?255*o/a:0,0!=l.s?e.r==a?l.h=(e.g-e.b)/o:e.g==a?l.h=2+(e.b-e.r)/o:l.h=4+(e.r-e.g)/o:l.h=-1,l.h*=60,l.h<0&&(l.h+=360),l.s*=100/255,l.b*=100/255,l.h=Math.round(l.h),l.s=Math.round(l.s),l.b=Math.round(l.b),l}},t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAEKADAAQAAAABAAAAEAAAAAA0VXHyAAAAM0lEQVQ4EWM8cuTIfwY8wMbGhhGPNAMTPkli5EYNYBgEgYg3jkHRSCidjEbjYIhGimMBAKIWB2rXs92IAAAAAElFTkSuQmCC",a=(e,l)=>{const t=e.__vccOpts||e;for(const[a,o]of l)t[a]=o;return t},o=l=>(e.pushScopeId("data-v-4e0790ec"),l=l(),e.popScopeId(),l),r={onselectstart:"return false",style:{position:"relative"}},n=["onContextmenu"],i=["onClick","onMousedown"],s=["onClick"],c={style:{"font-size":"10px",width:"32px","padding-left":"8px","user-select":"none"}},u={class:"palette-wrapper"},d=["onClick"],v=o((()=>e.createElementVNode("div",{class:"white"},null,-1))),p=o((()=>e.createElementVNode("div",{class:"black"},null,-1))),h={class:"huebar-wrapper"},f={class:"bar-wrapper"},b=["onClick"],g=["onClick"],m=["onClick"],A={class:"preview-wrapper"},y={name:"vue-colorpicker"},M=a(Object.assign(y,{props:{modelValue:{type:Object},size:{type:String,required:!1,default:"medium"},modebar:{type:String,required:!1,default:"show"}},emits:["update:modelValue","colorChanged"],setup(a,{emit:o}){const y=a,M=o,k=e.ref(null),E=e.ref(null),w=e.ref(null),x=e.ref(null),C=e.ref(null),V=e.ref(null),N=e.ref(null),$=e.ref(null),B=e.ref(null),S=e.ref(null),z=e.ref(null),I=e.ref(!1),L=e.ref(0),_=e.ref(""),T=e.ref(""),P=e.ref(""),Y=e.ref(!0),Q=e.reactive(l.rgba2hsba(y.modelValue.color||{r:0,g:0,b:0,a:1})),X=e.ref(y.modelValue.degree||90);X.value=X.value<0?0:X.value;const j=e.ref(y.modebar);["none","show"].includes(j.value)||(j.value="show");const D=e.ref(y.modelValue.mode||"solid");["solid","linear","radial"].includes(D.value)||(D.value="solid"),"none"==j.value&&(D.value="solid");const G=e.ref(y.modelValue.gradients||[{percent:0,color:{r:255,g:255,b:255,a:1}},{percent:100,color:{r:0,g:0,b:0,a:1}}]),O=e.ref([]);G.value.forEach(((e,t)=>{O.value.push({id:t,percent:e.percent,color:l.rgba2hsba(e.color)})}));let R=!1,K=138,F=0,q=null;function H(e){if(D.value=e,"solid"!==D.value){O.value.forEach(((e,l)=>{B.value.children[l].style.left=Math.round(1.41*e.percent-3)+"px"})),function(){const e=10,l=4;let t=X.value;t-360<0&&(t-=360);const a=-(t-90)*(Math.PI/180);z.value.style.left=Math.cos(a)*e+l+1+"px",z.value.style.top=-Math.sin(a)*e+l+1+"px"}();const e=O.value[L.value].color;Q.h=e.h,Q.s=e.s,Q.b=e.b,Q.a=e.a}ue(),oe(),re()}async function U(){if(!q)return!1;q.open().then((e=>{const t=l.hex2hsb(e.sRGBHex);Q.h=t.h,Q.s=t.s,Q.b=t.b,Q.a=t.a,ue()})).catch((e=>{}))}function W(){return!1}function J(l){27==l.keyCode?I.value=!1:32!=l.keyCode&&8!=l.keyCode||O.value.length>2&&(O.value.splice(L.value,1),L.value=O.value.length-1,e.nextTick((()=>re())))}function Z(e){let l=e.getBoundingClientRect(),t=e.ownerDocument,a=t.body,o=t.documentElement,r=o.clientTop||a.clientTop||0,n=o.clientLeft||a.clientLeft||0;return{top:l.top+(self.scrollY||o.scrollTop||a.scrollTop)-r,left:l.left+(self.scrollX||o.scrollLeft||a.scrollLeft)-n}}function ee(){let e=0,l=0,t=window.event;return t.pageX?(e=t.pageX,l=t.pageY):(e=t.clientX+document.body.scrollLeft-document.body.clientLeft,l=t.clientY+document.body.scrollTop-document.body.clientTop),{x:e,y:l}}function le(e){var l=e.target;if(R)return R=!1,!1;E.value.contains(l)||k.value.contains(l)||(I.value=!1)}function te(e,l,t){function a(){R=!0,l(e,t)}document.addEventListener("mousemove",a,!1),document.addEventListener("mouseup",(function e(){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",e)}),!1)}function ae(e,l){const t=Z(B.value),a=ee();let o=Math.max(-3,Math.min(138,a.x-t.left-6));e.style.left=o+"px",O.value[l].percent=Math.round((o+3)/141*100),L.value=l;const r=O.value[l].color;Q.h=r.h,Q.s=r.s,Q.b=r.b,Q.a=r.a,ue(),oe(),re()}function oe(){"solid"!==D.value&&(O.value[L.value].color.a=Q.a,O.value[L.value].color.h=Q.h,O.value[L.value].color.s=Q.s,O.value[L.value].color.b=Q.b)}function re(){const e=l.hsb2rgb(Q);_.value=`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`,T.value=_.value;let a="",o="",r=[...O.value],n=[];r.sort(((e,l)=>e.percent-l.percent)),r.forEach((e=>{a+=","+l.hsba2rgba(e.color)+" "+e.percent+"%",n.push({percent:e.percent,color:l.hsb2rgb(e.color)})}));const i={};switch(i.mode=D.value,D.value){case"solid":i.color=l.hsb2rgb(Q),i.hex=l.rgba2hex(i.color);break;case"linear":P.value=`linear-gradient(to right,${a.slice(1)}),url('${t}')`,T.value=`linear-gradient(${X.value}deg${a}),url('${t}')`,o=`background-image:linear-gradient(${X.value}deg${a})`,i.degree=X.value,i.color=n,i.css=o;break;case"radial":P.value=`linear-gradient(to right,${a.slice(1)}),url('${t}')`,T.value=`radial-gradient(${a.slice(1)}),url('${t}')`,o=`background-image:radial-gradient(${a.slice(1)})`,i.color=n,i.css=o}M("update:modelValue",i),M("colorChanged",i)}function ne(){const e=Z(S.value),l=ee(),t=Math.atan2(e.top+10-l.y,l.x-e.left-10);z.value.style.left=10*Math.cos(t)+4+1+"px",z.value.style.top=10*-Math.sin(t)+4+1+"px";let a=90-Math.floor(180*t/Math.PI);a<0&&(a+=360),X.value=a,oe(),re()}function ie(){const e=Z(w.value),l=ee(),t=Math.max(-6,Math.min(l.x-e.left-6,210)),a=Math.max(-6,Math.min(l.y-e.top-6,132));x.value.style.left=t+"px",x.value.style.top=a+"px",Q.s=Math.round(100*(t+6)/216),Q.b=Math.round(100*(K-a-6)/K)}function se(){const e=Z(N.value),t=ee(),a=Math.max(-3,Math.min(t.x-e.left-6,138));C.value.style.left=a+"px",Q.h=Math.round(360*(a+3)/141);const o=l.hsb2rgb({h:Q.h,s:100,b:100,a:Q.a});w.value.style.background=`rgb(${o.r},${o.g},${o.b},1)`}function ce(){const e=Z($.value),l=ee(),t=Math.max(-3,Math.min(138,l.x-e.left-6));V.value.style.left=t+"px",Q.a=((t+3)/141).toFixed(2)}function ue(){const e=l.hsb2rgb({h:Q.h,s:100,b:100,a:Q.a});w.value.style.background=`rgb(${e.r},${e.g},${e.b},1)`,x.value.style.left=2.16*Q.s-6+"px",x.value.style.top=K-1.38*Q.b-6+"px",C.value.style.left=141/360*Q.h-3+"px",V.value.style.left=141*Q.a-3+"px"}return"EyeDropper"in window?q=new EyeDropper:Y.value=!1,e.onMounted((()=>{H(D.value)})),e.watch(Q,(()=>{oe(),re()})),e.watch(I,(()=>{I.value?(document.addEventListener("click",le,!0),document.addEventListener("keyup",J,!1)):(document.removeEventListener("click",le,!0),document.removeEventListener("keyup",J,!1))})),(l,t)=>(e.openBlock(),e.createElementBlock("div",r,[e.createElementVNode("div",{class:e.normalizeClass(["cbtn",[y.size,{active:I.value}]]),onClick:t[0]||(t[0]=e.withModifiers((e=>I.value=!I.value),["stop"])),ref_key:"cbtnEl",ref:k},[e.createElementVNode("div",{class:"cbtn-inner",style:e.normalizeStyle({background:T.value})},null,4)],2),e.withDirectives(e.createElementVNode("div",{class:"panel",ref_key:"panelEl",ref:E,onContextmenu:e.withModifiers(W,["prevent"])},[e.createElementVNode("div",{class:"active-mode-wrapper",style:e.normalizeStyle({display:j.value})},[e.createElementVNode("div",{title:"solid",class:e.normalizeClass(["btn-active-mode solid",{gray:"solid"===D.value}]),onClick:t[1]||(t[1]=e.withModifiers((e=>H("solid")),["stop"]))},null,2),e.createElementVNode("div",{title:"linear",class:e.normalizeClass(["btn-active-mode linear",{gray:"linear"===D.value}]),onClick:t[2]||(t[2]=e.withModifiers((e=>H("linear")),["stop"]))},null,2),e.createElementVNode("div",{title:"radial",class:e.normalizeClass(["btn-active-mode radial",{gray:"radial"===D.value}]),onClick:t[3]||(t[3]=e.withModifiers((e=>H("radial")),["stop"]))},null,2)],4),e.createElementVNode("div",{class:"grad-wrapper",style:e.normalizeStyle("solid"===D.value?"display:none":"")},[e.createElementVNode("div",{class:"grad-bar",ref_key:"gradBarEl",ref:B,style:e.normalizeStyle({backgroundImage:P.value}),onClick:t[4]||(t[4]=e.withModifiers((l=>function(){if(O.value.length<10){const l=JSON.parse(JSON.stringify(O.value[L.value]));l.id=F++,O.value.push(l),L.value=O.value.length-1,e.nextTick((()=>ae(B.value.children[L.value],L.value)))}}()),["stop"]))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.value,((l,t)=>(e.openBlock(),e.createElementBlock("div",{key:l.id,style:{top:"-1px"},class:e.normalizeClass(["picker",t==L.value?"on":""]),onClick:e.withModifiers((e=>ae(e.target,t)),["stop"]),onMousedown:e.withModifiers((e=>te(e.target,ae,t)),["stop"])},null,42,i)))),128))],4),e.createElementVNode("div",{class:"flex-row",style:e.normalizeStyle("linear"===D.value?"":"visibility:hidden")},[e.createElementVNode("div",{class:"degree",ref_key:"degreeEl",ref:S,onClick:e.withModifiers(ne,["stop"]),onMousedown:t[6]||(t[6]=e.withModifiers((e=>te(e,ne)),["stop"]))},[e.createElementVNode("div",{class:"picker-deg",ref_key:"degreePickerEl",ref:z,onMousedown:t[5]||(t[5]=e.withModifiers((e=>te(e,ne)),["stop"]))},null,544)],40,s),e.createElementVNode("div",c,e.toDisplayString(X.value)+"Â°",1)],4)],4),e.createElementVNode("div",u,[e.createElementVNode("div",{class:"palette",ref_key:"paletteEl",ref:w,onClick:e.withModifiers(ie,["stop"]),onMousedown:t[8]||(t[8]=e.withModifiers((e=>te(e,ie)),["stop"]))},[v,p,e.createElementVNode("div",{class:"picker",ref_key:"palettePickerEl",ref:x,onMousedown:t[7]||(t[7]=e.withModifiers((e=>te(e,ie)),["stop"]))},null,544)],40,d)]),e.createElementVNode("div",h,[e.createElementVNode("div",{class:"dropper",onClick:U,style:e.normalizeStyle([{cursor:"pointer"},Y.value?"":"opacity: 50%;cursor:default"])},null,4),e.createElementVNode("div",f,[e.createElementVNode("div",{class:"hue-bar",ref_key:"hueBarEl",ref:N,onClick:e.withModifiers(se,["stop"]),onMousedown:t[10]||(t[10]=e.withModifiers((e=>te(e,se)),["stop"]))},[e.createElementVNode("div",{class:"picker",ref_key:"huePickerEl",ref:C,style:{top:"-1px"},onMousedown:t[9]||(t[9]=e.withModifiers((e=>te(e,se)),["stop"]))},null,544)],40,b),e.createElementVNode("div",{class:"opacity-bar",ref_key:"opactiyBarEl",ref:$,onClick:e.withModifiers(ce,["stop"]),onMousedown:t[12]||(t[12]=e.withModifiers((e=>te(e,ce)),["stop"]))},[e.createElementVNode("div",{class:"picker",ref_key:"opacityPickerEl",ref:V,style:{top:"-1px"},onClick:e.withModifiers(ce,["stop"]),onMousedown:t[11]||(t[11]=e.withModifiers((e=>te(e,ce)),["stop"]))},null,40,m)],40,g)]),e.createElementVNode("div",A,[e.createElementVNode("div",{class:"preview-color",style:e.normalizeStyle({background:_.value})},null,4)])])],40,n),[[e.vShow,I.value]])]))}}),[["__scopeId","data-v-4e0790ec"]]);return M.install=function(e){e.component("ColorPicker",M)},M}));
