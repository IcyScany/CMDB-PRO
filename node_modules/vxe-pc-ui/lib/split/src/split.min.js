"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_ui=require("../../ui"),_vn=require("../../ui/src/vn"),_dom=require("../../ui/src/dom"),_utils=require("../../ui/src/utils"),_xeUtils=_interopRequireDefault(require("xe-utils"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default=exports.default=(0,_vue.defineComponent)({name:"VxeSplit",props:{width:[Number,String],height:[Number,String],vertical:{type:Boolean,default:()=>(0,_ui.getConfig)().split.vertical},border:{type:Boolean,default:()=>(0,_ui.getConfig)().split.border},itemConfig:Object},emits:[],setup(b,e){const{emit:l,slots:s}=e;var t=_xeUtils.default.uniqueId();const U=(0,_vue.ref)(),C=(0,_vue.reactive)({staticItems:[]});const N=(0,_vue.computed)(()=>Object.assign({},(0,_ui.getConfig)().split.itemConfig,b.itemConfig)),i={computeItemOpts:N},r={refElem:U},a={xID:t,props:b,context:e,reactData:C,internalData:{},getRefMaps:()=>r,getComputeMaps:()=>i};const d=(e,t)=>e&&(_xeUtils.default.isString(e)&&(e=s[e]||null),_xeUtils.default.isFunction(e))?(0,_vn.getSlotVNs)(e(t)):[],u=()=>(0,_vue.nextTick)().then(()=>{var e=b["vertical"],t=C["staticItems"],i=U.value;if(i){const r=i.clientWidth,s=i.clientHeight;if(r&&s){i=N.value;const u=_xeUtils.default.toNumber(i.minWidth),n=_xeUtils.default.toNumber(i.minHeight),o=[];if(e){let l=0;if(t.forEach(e=>{var t=e["height"];let i=0;t?(i=(0,_dom.isScale)(t)?s*_xeUtils.default.toNumber(t):_xeUtils.default.toNumber(t),e.renderHeight=i):o.push(e),l+=i}),o.length){const a=(s-l)/o.length;o.forEach(e=>{e.renderHeight=Math.max(_xeUtils.default.toNumber((0,_utils.getGlobalDefaultConfig)(e.minHeight,n)),a)})}}else{let l=0;if(t.forEach(e=>{var t=e["width"];let i=0;t?(i=(0,_dom.isScale)(t)?r*_xeUtils.default.toNumber(t):_xeUtils.default.toNumber(t),e.renderWidth=i):o.push(e),l+=i}),o.length){const d=(r-l)/o.length;o.forEach(e=>{e.renderWidth=Math.max(_xeUtils.default.toNumber((0,_utils.getGlobalDefaultConfig)(e.minWidth,u)),d)})}}}}}),c=e=>{e.preventDefault();const i=b["vertical"];var t=C["staticItems"],l=e.currentTarget;const r=U.value;if(r){const n=l.getAttribute("xid");l=_xeUtils.default.findIndexOf(t,e=>e.id===n);const o=t[l];if(o){var s=N.value,u=_xeUtils.default.toNumber(s.minWidth),s=_xeUtils.default.toNumber(s.minHeight);const a=t[l-1];t=a?r.querySelector(`.vxe-split-item[xid="${a.id}"]`):null,l=o?r.querySelector(`.vxe-split-item[xid="${o.id}"]`):null;const d=t?t.clientWidth:0,c=l?l.clientWidth:0,h=t?t.clientHeight:0,m=l?l.clientHeight:0,f=_xeUtils.default.toNumber(a?(0,_utils.getGlobalDefaultConfig)(a.minWidth,u):u),v=_xeUtils.default.toNumber((0,_utils.getGlobalDefaultConfig)(o.minWidth,u)),_=_xeUtils.default.toNumber(a?(0,_utils.getGlobalDefaultConfig)(a.minHeight,s):s),g=_xeUtils.default.toNumber((0,_utils.getGlobalDefaultConfig)(o.minHeight,s)),p=e.clientX,x=e.clientY;(0,_dom.addClass)(r,"is--drag"),document.onmousemove=e=>{var t;e.preventDefault(),i?0<(t=e.clientY-x)?a&&m-t>=g&&(a.renderHeight=h+t,o.renderHeight=m-t):a&&h+t>=_&&(a.renderHeight=h+t,o.renderHeight=m-t):0<(t=e.clientX-p)?a&&c-t>=v&&(a.renderWidth=d+t,o.renderWidth=c-t):a&&d+t>=f&&(a.renderWidth=d+t,o.renderWidth=c-t)},document.onmouseup=()=>{document.onmousemove=null,(document.onmouseup=null,_dom.removeClass)(r,"is--drag")}}}};t={dispatchEvent:(e,t,i)=>{l(e,(0,_ui.createEvent)(i,{$split:a},t))},recalculate:u};Object.assign(a,t,{});return(0,_vue.watch)(()=>C.staticItems,()=>{u()}),(0,_vue.onMounted)(()=>{u()}),(0,_vue.onActivated)(()=>{u()}),(0,_vue.provide)("$xeSplit",a),a.renderVN=()=>{var{vertical:e,width:t,height:i}=b,l=s.default,r={};return i&&(r.height=(0,_dom.toCssUnit)(i)),t&&(r.width=(0,_dom.toCssUnit)(t)),(0,_vue.h)("div",{ref:U,class:["vxe-split",e?"is--vertical":"is--horizontal"],style:r},[(0,_vue.h)("div",{class:"vxe-split-slots"},l?l({}):[]),(()=>{const{border:u,vertical:n}=b;var e=C["staticItems"];const o=[];return e.forEach((e,t)=>{var{id:e,slots:i,renderHeight:l,renderWidth:r}=e,i=i?i.default:null,s={};n?l&&(s.height=(0,_dom.toCssUnit)(l)):r&&(s.width=(0,_dom.toCssUnit)(r)),o.push((0,_vue.h)("div",{xid:e,class:["vxe-split-item",n?"is--vertical":"is--horizontal",{"is--border":u,"is--height":l,"is--width":r,"is--fill":!l&&!r,"is--handle":0<t}],style:s},[t?(0,_vue.h)("div",{xid:e,class:"vxe-split-item-handle",onMousedown:c}):(0,_ui.renderEmptyElement)(a),(0,_vue.h)("div",{xid:e,class:"vxe-split-item--wrapper"},i?d(i,{}):[])]))}),(0,_vue.h)("div",{class:"vxe-split-wrapper"},o)})()])},a},render(){return this.renderVN()}});