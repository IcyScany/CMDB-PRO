import{s as e,_ as t}from"./subPage.2201bfd5.js";import{_ as i}from"./ServerTable.53881589.js";import{aR as a,b5 as l,al as o,r as s,O as n,Q as r,U as d,W as u,c as p,$ as m,R as c,F as f,S as _,a8 as v,aN as y,a3 as g,H as b,q as j,J as x,I as D,a0 as C,ah as w,Y as T,X as h,a6 as S,ad as k,aZ as E,v as $,aV as O}from"./index.872a2bd0.js";import{t as P}from"./tableRender.a6ff99b7.js";import{o as R,_ as F,u as I}from"./opsFormInit.3a4e1794.js";import{_ as A}from"./index.029351cd.js";import"./opsDescriptions.dfa169bd.js";import"./index.87ccdcd1.js";import"./index.fc9664cf.js";import"./index.a533313d.js";import"./index.2c670fa1.js";import"./index.fe8e77ef.js";import"./Checkbox.ddee6d58.js";import"./index.6f715054.js";import"./useBreakpoint.e81952b0.js";import"./index.e3d002e2.js";import"./index.9846e408.js";import"./alertLevel.8dae0e72.js";import"./index.44a4e190.js";import"./index.65b2e021.js";import"./index.6e2fd079.js";import"./Group.b415afa6.js";import"./RadioButton.534ff50d.js";import"./index.48209b21.js";import"./index.64f8d8d4.js";const U="network/nat/",L={postList:e=>a.post(`${U}list`,e),getDetail:e=>a.get(`${U}list/${e}`),postAdd:e=>a.post(`${U}add`,e),putEdit:(e,t)=>a.put(`${U}edit/${e}`,t),del:e=>a.delete(`${U}delete/${e}`)},Y={__name:"edit",props:{open:{type:Boolean,default:!1},sid:{type:[String,Number],default:""},formType:{type:Number,default:l}},emits:["update:open","editSuccess"],setup(e,{emit:t}){const i=e,{open:a,sid:l,formType:g}=o(i),b=t,j=s(null),{putEdit:x,getDetail:D,postAdd:C}=L,{formRenderContent:w,formDataLoading:T,confirmLoading:h,initForm:S,formDataInit:k,editSubmit:E}=R({formRef:j,TITLE_LAYER:1,formType:g,sid:l,emits:b,addApi:C,editApi:x,oneDataApi:D,customSubmitData:async function(e){e.virtual_team_v3_id||(e.virtual_team_v3_id=null);return e},customEditData:function(){}});const $=()=>{b("update:open",!1)},O=async e=>{e&&(await S(),await k())};return(e,t)=>{const i=F,l=v,o=y,s=n("vxe-button"),b=A;return r(),d(b,{title:`${e.$route.meta.title}${m(g)===e.$CONFIG.FORM_TYPE.ADD_TYPE?"新增":"编辑"}`,open:m(a),onAfterOpenChange:O,onClose:$},{footer:u((()=>[p(s,{content:"取消",onClick:$}),p(s,{type:"submit",loading:m(h),status:"primary",content:"提交",onClick:m(E)},null,8,["loading","onClick"])])),default:u((()=>[p(o,{spinning:m(T)},{default:u((()=>[p(l,{ref_key:"formRef",ref:j,model:m(w).formState,rules:m(w).rules},{default:u((()=>[(r(!0),c(f,null,_(e.$utils.filter(m(w).title,(e=>e.edit_display)),(e=>{var t,a,l,o;return r(),c(f,{key:e.field},[""===e.field?(r(),d(i,{key:0,value:m(w).formState[e.field],"onUpdate:value":t=>m(w).formState[e.field]=t,title:e,"title-data":null==(a=null==(t=m(w))?void 0:t.title_data)?void 0:a[e.field]},null,8,["value","onUpdate:value","title","title-data"])):(r(),d(i,{key:1,value:m(w).formState[e.field],"onUpdate:value":t=>m(w).formState[e.field]=t,title:e,"title-data":null==(o=null==(l=m(w))?void 0:l.title_data)?void 0:o[e.field]},null,8,["value","onUpdate:value","title","title-data"]))],64)})),128))])),_:1},8,["model","rules"])])),_:1},8,["spinning"])])),_:1},8,["title","open"])}}},B=["onClick"],N=["onClick"],q={style:{display:"flex","align-items":"center"}},G=g({__name:"index",setup(a){const l=s(null),o=b({initColumn:[],initButton:[],initTitleData:[],tableOrder:{},subPageColumns:[],titleFieldSearch:[]}),{userEdit:d,userDel:_,formOpen:v,formType:y,formSid:g}=I(),R=j((()=>{for(let e of o.initColumn){let{field:t}=e;switch(t){case"id":case"status":case"nat_id":case"region_id":e.slots={default:t};break;case"virtual_team_v3_id":e.showOverflow=!1}}return o.initColumn})),F=j((()=>{const e=["edit","add","del"];return o.initButton.reduce(((t,i)=>(e.includes(i.field)&&(t[i.field]=i),t)),{})})),A=async()=>{var e;(null==(e=l.value)?void 0:e.serverTableRef)&&l.value.serverTableRef.commitProxy("query")};x((async()=>{const{button:e,columns:t,title_data:i,order:a,sub_page_columns:l,title_field_search:s}=await P.setColumn({layer:1});o.initColumn=t.value||[],o.initButton=e.value||[],o.initTitleData=i.value||{},o.tableOrder=a.value?a.value:{},o.subPageColumns=l||[],o.titleFieldSearch=s.value||[],await D(),await A()}));const U=({type:e,row:t})=>{d({type:e,sid:t.id})},G=({row:e})=>{_({sid:e.id,delApi:L.del,loadData:A})},z=j((()=>({fields:[{field:"public_ip",operator:"vague",validate:C.isServerIp},{field:"description",operator:"vague",validate:e=>!C.isServerIp(e)}],placeholder:"直接输入公网IP、备注"}))),{subPageOpen:M,subPageRow:H,handleSubPageOpen:J}=e();return(e,a)=>{var s,_;const b=E,j=$,x=n("vxe-tag"),D=O,C=i,P=t;return r(),c(f,null,[p(C,{ref_key:"tableRef",ref:l,"auth-btn":m(F),"table-column":m(R),"query-api":m(L).postList,order:m(o).tableOrder,"title-field-search":m(o).titleFieldSearch,"default-search-field":m(z),onUserEdit:U,onUserAdd:a[0]||(a[0]=t=>m(d)({type:e.$CONFIG.FORM_TYPE.ADD_TYPE})),onUserDel:G},{id:u((({row:e})=>[p(j,{placement:"topLeft"},{title:u((()=>[p(b,{copyable:{tooltip:!1},class:"copy-text"},{default:u((()=>[w(T(e.nat_id),1)])),_:2},1024)])),default:u((()=>[h("span",{class:"cursor-pointer text-primary",onClick:t=>m(J)(e)},T(e.id),9,B)])),_:2},1024)])),nat_id:u((({row:e})=>[h("span",{class:"cursor-pointer text-primary",onClick:t=>m(J)(e)},T(e.nat_id),9,N)])),status:u((({row:e})=>[p(x,{class:S("可用"==e.status?"theme--primary":"theme--error"),size:"small"},{default:u((()=>[w(T(e.status),1)])),_:2},1032,["class"])])),cloud_master_account_id:u((({row:e})=>{var t,i,a;return[h("div",q,[p(D,{type:null==e?void 0:e.cloud_source},null,8,["type"])]),w(" "+T((null==(a=null==(i=null==(t=m(o).initTitleData)?void 0:t.cloud_master_account_id)?void 0:i[e.cloud_master_account_id])?void 0:a.page_display)||""),1)]})),region_id:u((({row:e})=>{var t,i;return[h("span",null,T((null==(i=null==(t=m(o).initTitleData)?void 0:t.region_id)?void 0:i[e.region_id])||e.region_id),1)]})),_:1},8,["auth-btn","table-column","query-api","order","title-field-search","default-search-field"]),p(Y,{open:m(v),"onUpdate:open":a[1]||(a[1]=e=>k(v)?v.value=e:null),sid:m(g),"form-type":m(y),onEditSuccess:A},null,8,["open","sid","form-type"]),p(P,{open:m(M),"onUpdate:open":a[2]||(a[2]=e=>k(M)?M.value=e:null),title:null==(s=m(H))?void 0:s.nat_id,"basic-config":{columns:m(o).subPageColumns,api:m(L).getDetail,sid:null==(_=m(H))?void 0:_.id},onClickEdit:a[3]||(a[3]=t=>U({type:e.$CONFIG.FORM_TYPE.EDIT_TYPE,row:m(H)}))},{status:u((({row:e})=>[p(x,{class:S("可用"==e.status?"theme--primary":"theme--error"),size:"small"},{default:u((()=>[w(T(e.status),1)])),_:2},1032,["class"])])),cloud_master_account_id:u((({row:e})=>{var t,i,a;return[w(T((null==(a=null==(i=null==(t=m(o).initTitleData)?void 0:t.cloud_master_account_id)?void 0:i[e.cloud_master_account_id])?void 0:a.page_display)||""),1)]})),region_id:u((({row:e})=>{var t,i;return[h("span",null,T((null==(i=null==(t=m(o).initTitleData)?void 0:t.region_id)?void 0:i[e.region_id])||e.region_id),1)]})),_:1},8,["open","title","basic-config"])],64)}}},[["__scopeId","data-v-f0d8bd5e"]]);export{G as default};
