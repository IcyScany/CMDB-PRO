import{s as t,_ as e}from"./subPage.2201bfd5.js";import{_ as a}from"./index.7d980246.js";import{a as i,_ as o}from"./opsDescriptions.dfa169bd.js";import{aR as l,b5 as n,al as s,r as u,O as r,Q as d,U as p,W as c,c as m,$ as f,R as _,F as v,S as y,a8 as b,aN as g,H as w,q as C,J as x,x as D,ah as j,a6 as T,Y as h,X as k,Z as R,av as O,aY as $,a3 as E,C as L,D as S,ad as A,a0 as P,aZ as U,v as I,aV as B}from"./index.872a2bd0.js";import{t as F}from"./tableRender.a6ff99b7.js";import{o as Y,_ as q,u as N}from"./opsFormInit.3a4e1794.js";import{_ as z}from"./index.029351cd.js";import"./index.2c670fa1.js";import"./opsTable.7b07fc7b.js";import"./index.9846e408.js";import"./index.87ccdcd1.js";import"./index.fc9664cf.js";import"./index.a533313d.js";import"./alertLevel.8dae0e72.js";import"./index.44a4e190.js";import"./index.65b2e021.js";import"./index.fe8e77ef.js";import"./Checkbox.ddee6d58.js";import"./index.6e2fd079.js";import"./Group.b415afa6.js";import"./RadioButton.534ff50d.js";import"./index.48209b21.js";import"./index.64f8d8d4.js";const G="network/vpc-route/",M={getList:()=>l.get(`${G}list`),getDetail:t=>l.get(`${G}list/${t}`),postAdd:t=>l.post(`${G}add`,t),putEdit:(t,e)=>l.put(`${G}edit/${t}`,e),del:t=>l.delete(`${G}delete/${t}`),getSubnetsList:t=>l.get(`${G}table/list/${t}`),getVpcList:()=>l.get(`${G}vpc/list`)},V={__name:"edit",props:{open:{type:Boolean,default:!1},sid:{type:[String,Number],default:""},formType:{type:Number,default:n}},emits:["update:open","editSuccess"],setup(t,{emit:e}){const a=t,{open:i,sid:o,formType:l}=s(a),n=e,w=u(null),{putEdit:C,getDetail:x,postAdd:D}=M,{formRenderContent:j,formDataLoading:T,confirmLoading:h,initForm:k,formDataInit:R,editSubmit:O}=Y({formRef:w,TITLE_LAYER:1,formType:l,sid:o,emits:n,addApi:D,editApi:C,oneDataApi:x,customSubmitData:async function(t){return t},customEditData:function(){}});const $=()=>{n("update:open",!1)},E=async t=>{t&&(await k(),await R())};return(t,e)=>{const a=q,o=b,n=g,s=r("vxe-button"),u=z;return d(),p(u,{title:`${t.$route.meta.title}${f(l)===t.$CONFIG.FORM_TYPE.ADD_TYPE?"新增":"编辑"}`,open:f(i),onAfterOpenChange:E,onClose:$},{footer:c((()=>[m(s,{content:"取消",onClick:$}),m(s,{type:"submit",loading:f(h),status:"primary",content:"提交",onClick:f(O)},null,8,["loading","onClick"])])),default:c((()=>[m(n,{spinning:f(T)},{default:c((()=>[m(o,{ref_key:"formRef",ref:w,model:f(j).formState,rules:f(j).rules},{default:c((()=>[(d(!0),_(v,null,y(t.$utils.filter(f(j).title,(t=>t.edit_display)),(t=>{var e,i,o,l;return d(),_(v,{key:t.field},[""===t.field?(d(),p(a,{key:0,value:f(j).formState[t.field],"onUpdate:value":e=>f(j).formState[t.field]=e,title:t,"title-data":null==(i=null==(e=f(j))?void 0:e.title_data)?void 0:i[t.field]},null,8,["value","onUpdate:value","title","title-data"])):(d(),p(a,{key:1,value:f(j).formState[t.field],"onUpdate:value":e=>f(j).formState[t.field]=e,title:t,"title-data":null==(l=null==(o=f(j))?void 0:o.title_data)?void 0:l[t.field]},null,8,["value","onUpdate:value","title","title-data"]))],64)})),128))])),_:1},8,["model","rules"])])),_:1},8,["spinning"])])),_:1},8,["title","open"])}}},H={key:0},Z={__name:"subnetsList",props:{show:{type:Boolean,default:!1},routeRow:{type:Object,default:()=>({})},infoColumns:{type:Array,default:()=>[]},titleData:{type:Object,default:()=>({})}},emits:["update:show"],setup(t,{emit:e}){const o=t,{show:l,routeRow:n}=s(o),p=e,v=u(null),y=w({initColumn:[],initButton:[],tableData:[],routeTableType:{}}),b=C((()=>{for(let t of y.initColumn){let{field:e}=t;if("route_table_type"===e)t.slots={default:e}}return y.initColumn}));x((async()=>{const{button:t,columns:e}=await F.setColumn({layer:2});y.initColumn=e.value||[],y.initButton=t.value||[]}));const g=C((()=>o.infoColumns.filter((t=>"subnets"!==t.field)))),E=()=>{p("update:show",!1)};return D(l,(t=>{t&&(async()=>{var t;const{data:e,route_table_type:a}=await M.getSubnetsList(null==(t=n.value)?void 0:t.route_id);y.tableData=e,y.routeTableType=a,v.value.commitRequest()})()})),(e,o)=>{const s=O,u=r("vxe-tag"),p=i,w=$,C=a;return f(l)?(d(),_("div",H,[m(s,{type:"primary",class:"mt-2",onClick:E},{default:c((()=>[j("返回")])),_:1}),m(w,{style:{"margin-top":"10px"}},{default:c((()=>[m(p,{title:null,data:f(n),columns:f(g),column:2,size:"small"},{default:c((({row:t})=>[m(u,{class:T(t.default?"theme--primary":"theme--error"),size:"small"},{default:c((()=>[j(h(t.default?"是":"否"),1)])),_:2},1032,["class"])])),region_id:c((({row:e})=>{var a,i;return[j(h((null==(i=null==(a=t.titleData)?void 0:a.region_id)?void 0:i[e.region_id])||e.region_id),1)]})),_:1},8,["data","columns"])])),_:1}),m(C,{ref_key:"tableRef",ref:v,data:f(y).tableData,columns:f(b)},{route_table_type:c((({row:t})=>{var e;return[k("span",null,h((null==(e=f(y).routeTableType)?void 0:e[t.route_table_type])||t.route_table_type),1)]})),_:1},8,["data","columns"])])):R("",!0)}}},J=["onClick"],Q=["onClick"],W={style:{display:"flex","align-items":"center"}},X={class:"truncate text-primary"},K=E({__name:"index",setup(i){const l=u(null),n=w({initColumn:[],initButton:[],initTitleData:[],subnetsOpen:!1,routeId:0,subPageColumns:[],vpcList:[]}),{userEdit:s,userDel:p,formOpen:y,formType:b,formSid:g}=N(),D=C((()=>{for(let t of n.initColumn){let{field:e}=t;switch(e){case"default":case"subnets":case"region_id":case"id":case"name":case"vpc_id":t.slots={default:e};break;case"cloud_source":t.showOverflow=!1}}return n.initColumn})),R=C((()=>{const t=["edit","add","del"];return n.initButton.reduce(((e,a)=>(t.includes(a.field)&&(e[a.field]=a),e)),{})}));x((async()=>{await Y();const{button:t,columns:e,title_data:a,sub_page_columns:i}=await F.setColumn({layer:1});n.initColumn=e.value||[],n.initButton=t.value||[],n.initTitleData=a.value||[],n.subPageColumns=i||[]}));const O=async()=>{l.value&&await l.value.commitRequest()},$=({type:t,row:e})=>{s({type:t,sid:e.id})},E=({row:t})=>{p({sid:t.id,delApi:M.del,loadData:O})},Y=async()=>{const t=await M.getVpcList();n.vpcList=t},q=t=>{var e,a;n.subnetsOpen=!0,n.routeRow=P.clone(t,!0),n.routeRow.vpc_id=null==(a=null==(e=n.vpcList)?void 0:e[t.vpc_id])?void 0:a.name},{subPageOpen:z,subPageRow:G,handleSubPageOpen:H}=t();return(t,i)=>{var u,p;const w=U,C=I,x=r("vxe-tag"),P=r("vxe-button"),F=B,Y=o,N=a,K=e;return d(),_(v,null,[L(m(N,{ref_key:"tableRef",ref:l,columns:f(D),"auth-btn":f(R),"request-config":{api:f(M).getList,immediate:!0},"filter-config":{remote:!1,showIcon:!0},"is-show-sync":{show:!0,uri:"cloud-route"},onUserEdit:$,onUserAdd:i[0]||(i[0]=e=>f(s)({type:t.$CONFIG.FORM_TYPE.ADD_TYPE})),onUserDel:E},{id:c((({row:t})=>[m(C,{placement:"topLeft"},{title:c((()=>[m(w,{copyable:{tooltip:!1},class:"copy-text"},{default:c((()=>[j(h(t.route_id),1)])),_:2},1024)])),default:c((()=>[k("span",{class:"cursor-pointer text-primary",onClick:e=>f(H)(t)},h(t.id),9,J)])),_:2},1024)])),name:c((({row:t})=>[k("span",{class:"cursor-pointer text-primary",onClick:e=>f(H)(t)},h(t.name),9,Q)])),default:c((({row:t})=>[m(x,{class:T(t.default?"theme--primary":"theme--error"),size:"small"},{default:c((()=>[j(h(t.default?"是":"否"),1)])),_:2},1032,["class"])])),region_id:c((({row:t})=>{var e,a;return[k("span",null,h((null==(a=null==(e=f(n).initTitleData)?void 0:e.region_id)?void 0:a[t.region_id])||t.region_id),1)]})),subnets:c((({row:t})=>[m(P,{mode:"text",content:"路由表",status:"primary",onClick:e=>q(t)},null,8,["onClick"])])),cloud_master_account_id:c((({row:t})=>{var e,a,i;return[k("div",W,[m(F,{type:t.cloud_source},null,8,["type"])]),j(" "+h((null==(i=null==(a=null==(e=f(n).initTitleData)?void 0:e.cloud_master_account_id)?void 0:a[t.cloud_master_account_id])?void 0:i.page_display)||""),1)]})),vpc_id:c((({row:t})=>[k("div",X,[m(Y,{"obj-type":"hw_vpc",uuid:t.vpc_id},null,8,["uuid"])])])),_:1},8,["columns","auth-btn","request-config"]),[[S,!f(n).subnetsOpen]]),m(V,{open:f(y),"onUpdate:open":i[1]||(i[1]=t=>A(y)?y.value=t:null),sid:f(g),"form-type":f(b),onEditSuccess:O},null,8,["open","sid","form-type"]),m(Z,{show:f(n).subnetsOpen,"onUpdate:show":i[2]||(i[2]=t=>f(n).subnetsOpen=t),"route-row":f(n).routeRow,"info-columns":f(n).initColumn,"title-data":f(n).initTitleData},null,8,["show","route-row","info-columns","title-data"]),m(K,{open:f(z),"onUpdate:open":i[3]||(i[3]=t=>A(z)?z.value=t:null),title:null==(u=f(G))?void 0:u.name,"basic-config":{columns:f(n).subPageColumns,api:f(M).getDetail,sid:null==(p=f(G))?void 0:p.id},onClickEdit:i[4]||(i[4]=e=>$({type:t.$CONFIG.FORM_TYPE.EDIT_TYPE,row:f(G)}))},{default:c((({row:t})=>[m(x,{class:T(t.default?"theme--primary":"theme--error"),size:"small"},{default:c((()=>[j(h(t.default?"是":"否"),1)])),_:2},1032,["class"])])),region_id:c((({row:t})=>{var e,a;return[k("span",null,h((null==(a=null==(e=f(n).initTitleData)?void 0:e.region_id)?void 0:a[t.region_id])||t.region_id),1)]})),subnets:c((({row:t})=>[m(P,{mode:"text",content:"路由表",status:"primary",onClick:e=>q(t)},null,8,["onClick"])])),cloud_master_account_id:c((({row:t})=>{var e,a,i;return[j(h((null==(i=null==(a=null==(e=f(n).initTitleData)?void 0:e.cloud_master_account_id)?void 0:a[t.cloud_master_account_id])?void 0:i.page_display)||""),1)]})),_:1},8,["open","title","basic-config"])],64)}}},[["__scopeId","data-v-c4c093ae"]]);export{K as default};
