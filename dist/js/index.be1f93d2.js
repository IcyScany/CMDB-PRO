import{a as t}from"./opsDescriptions.dfa169bd.js";import{t as e}from"./tableRender.a6ff99b7.js";import{o as i,_ as a,u as o}from"./opsFormInit.3a4e1794.js";import{_ as n}from"./index.029351cd.js";import{aR as s,b5 as l,al as r,r as d,O as u,Q as p,U as m,W as c,c as f,$ as v,R as _,F as y,S as w,a8 as j,aN as C,a3 as g,H as D,q as x,J as b,X as k,ah as E,Y as T,Z as S,ad as $,aY as h,ak as O}from"./index.872a2bd0.js";import"./index.87ccdcd1.js";import"./index.fc9664cf.js";import"./index.a533313d.js";import"./alertLevel.8dae0e72.js";import"./index.44a4e190.js";import"./index.9846e408.js";import"./index.65b2e021.js";import"./index.fe8e77ef.js";import"./Checkbox.ddee6d58.js";import"./index.6e2fd079.js";import"./Group.b415afa6.js";import"./RadioButton.534ff50d.js";import"./index.48209b21.js";import"./index.64f8d8d4.js";const R="network/enterprise-router/",L={postList:t=>s.post(`${R}list`,t),getDetail:t=>s.get(`${R}list/${t}`),putEdit:(t,e)=>s.put(`${R}edit/${t}`,e)},A={__name:"edit",props:{open:{type:Boolean,default:!1},sid:{type:[String,Number],default:""},formType:{type:Number,default:l}},emits:["update:open","editSuccess"],setup(t,{emit:e}){const o=t,{open:s,sid:l,formType:g}=r(o),D=e,x=d(null),{putEdit:b,getDetail:k,postAdd:E}=L,{formRenderContent:T,formDataLoading:S,confirmLoading:$,initForm:h,formDataInit:O,editSubmit:R}=i({formRef:x,TITLE_LAYER:1,formType:g,sid:l,emits:D,addApi:E,editApi:b,oneDataApi:k,customSubmitData:async function(t){return t},customEditData:function(){}});const A=()=>{D("update:open",!1)},F=async t=>{t&&(await h(),await O())};return(t,e)=>{const i=a,o=j,l=C,r=u("vxe-button"),d=n;return p(),m(d,{title:`${t.$route.meta.title}${v(g)===t.$CONFIG.FORM_TYPE.ADD_TYPE?"新增":"编辑"}`,open:v(s),onAfterOpenChange:F,onClose:A},{footer:c((()=>[f(r,{content:"取消",onClick:A}),f(r,{type:"submit",loading:v($),status:"primary",content:"提交",onClick:v(R)},null,8,["loading","onClick"])])),default:c((()=>[f(l,{spinning:v(S)},{default:c((()=>[f(o,{ref_key:"formRef",ref:x,model:v(T).formState,rules:v(T).rules},{default:c((()=>[(p(!0),_(y,null,w(t.$utils.filter(v(T).title,(t=>t.edit_display)),(t=>{var e,a,o,n;return p(),_(y,{key:t.field},[""===t.field?(p(),m(i,{key:0,value:v(T).formState[t.field],"onUpdate:value":e=>v(T).formState[t.field]=e,title:t,"title-data":null==(a=null==(e=v(T))?void 0:e.title_data)?void 0:a[t.field]},null,8,["value","onUpdate:value","title","title-data"])):(p(),m(i,{key:1,value:v(T).formState[t.field],"onUpdate:value":e=>v(T).formState[t.field]=e,title:t,"title-data":null==(n=null==(o=v(T))?void 0:o.title_data)?void 0:n[t.field]},null,8,["value","onUpdate:value","title","title-data"]))],64)})),128))])),_:1},8,["model","rules"])])),_:1},8,["spinning"])])),_:1},8,["title","open"])}}},F={key:0,class:"view-card-container"},I={class:"view-title"},U={style:{flex:"2"}},Y={class:"text-primary"},B={class:"flex mt-2"},P={class:"view-count-title"},N={class:"view-count-number"},G={key:1},q=g({__name:"index",setup(i){const a=D({initColumn:[],initButton:[],initTitleData:[],subPageColumns:[],viewData:[]}),{userEdit:n,formOpen:s,formType:l,formSid:r}=o(),d=x((()=>{for(let t of a.initColumn){let{field:e}=t;switch(e){case"id":case"region_id":case"enterprise_router_id":t.slots={default:e},t.showOverflow="ellipsis";break;case"virtual_team_v3_id":t.showOverflow=!1}}return a.initColumn})),j=x((()=>a.initButton.reduce(((t,e)=>(t[e.field]=e,t)),{}))),C=async()=>{const t=await L.postList({page_limit:20,page_number:1,query_condition:[],sort_field:"id",sort_order:"DESC"});a.viewData=t.data};b((async()=>{const{button:t,columns:i,title_data:o,sub_page_columns:n}=await e.setColumn({layer:1});a.initColumn=i.value||[],a.initButton=t.value||[],a.initTitleData=o.value||[],a.subPageColumns=n||[],await C()}));const g=t=>{let e={};return e.count=t.length,e.typeCount={},t.forEach((t=>{const i=t.resource_type;e.typeCount[i]?e.typeCount[i]++:e.typeCount[i]=1})),e};return(e,i)=>{const o=u("EditOutlined"),D=t,x=h,b=O;return p(),_(y,null,[v(a).viewData.length>0?(p(),_("div",F,[(p(!0),_(y,null,w(v(a).viewData,(t=>(p(),m(x,{key:t.id,class:"view-card"},{title:c((()=>[k("div",I,[E(T(t.name)+" ",1),v(j).edit?(p(),m(o,{key:0,class:"view-title-edit",onClick:i=>(({type:t,row:e})=>{n({type:t,sid:e.id})})({type:e.$CONFIG.FORM_TYPE.EDIT_TYPE,row:t})},null,8,["onClick"])):S("",!0)])])),default:c((()=>[f(D,{data:t,columns:v(d),column:1,size:"small",style:{flex:"3"}},{region_id:c((({row:t})=>{var e,i;return[E(T((null==(i=null==(e=v(a).initTitleData)?void 0:e.region_id)?void 0:i[t.region_id])||t.region_id),1)]})),availability_zone_ids:c((({row:t})=>[E(T(t.availability_zone_ids.join(", ")),1)])),enterprise_project_id:c((({row:t})=>{var e,i;return[E(T((null==(i=null==(e=v(a).initTitleData)?void 0:e.enterprise_project_id)?void 0:i[t.enterprise_project_id])||t.enterprise_project_id),1)]})),_:2},1032,["data","columns"]),k("div",U,[k("div",null,[E(" 连接数量（已创建）： "),k("span",Y,T(g(t.attachments).count),1)]),k("div",B,[(p(!0),_(y,null,w(g(t.attachments).typeCount,((t,e)=>(p(),_("div",{key:e,class:"view-count"},[k("div",P,T(e.toLocaleUpperCase()),1),k("div",N,T(t),1)])))),128))])])])),_:2},1024)))),128))])):(p(),_("div",G,[f(b,{class:"mt-20"})])),f(A,{open:v(s),"onUpdate:open":i[0]||(i[0]=t=>$(s)?s.value=t:null),sid:v(r),"form-type":v(l),onEditSuccess:C},null,8,["open","sid","form-type"])],64)}}},[["__scopeId","data-v-2ae7661c"]]);export{q as default};
