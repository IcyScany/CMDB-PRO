import{r as e,N as s,ab as a,J as n,aM as t,Q as i,U as o,W as l,$ as u,O as r,aN as c,c as d,ag as g,ah as h,av as m}from"./index.872a2bd0.js";import{_ as p}from"./index.65b2e021.js";const v={__name:"FeiShuAuth",setup(v){let f=e(!0),_=e(null),w=s();const y=a();return n((async()=>{var e,s,a,n;_.value=null;const i=new URLSearchParams(window.location.search),o=i.get("code"),l=i.get("state");if(o&&l)try{let e=await t.userFeiShuLogin(o,l);f.value=!1,w.setLoginSuccess(e);let{business_list:s,next_url:a}=e||{},n=Object.keys(s);1===n.length&&(window.location.href=a||"/"),n.length>1&&await y.push({name:"checkBusiness"})}catch(u){f.value=!1,_.value=`${null==(s=null==(e=null==u?void 0:u.response)?void 0:e.data)?void 0:s.status_code}: ${null==(n=null==(a=null==u?void 0:u.response)?void 0:a.data)?void 0:n.msg}`}})),(e,s)=>{const a=m,n=r("router-link"),t=p,v=c;return i(),o(v,{spinning:u(f)},{default:l((()=>[d(t,{message:u(f)?"飞书登录授权中...":"飞书授权结果",description:u(_),type:u(_)?"error":"info","show-icon":""},g({_:2},[u(_)?{name:"action",fn:l((()=>[d(n,{to:{name:"Login"}},{default:l((()=>[d(a,{size:"small"},{default:l((()=>[h("返回登录页")])),_:1})])),_:1})])),key:"0"}:void 0]),1032,["message","description","type"])])),_:1},8,["spinning"])}}};export{v as default};
