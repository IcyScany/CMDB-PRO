import{s as e,_ as t}from"./subPage.2201bfd5.js";import{_ as a}from"./ServerTable.53881589.js";import{_ as i}from"./opsDescriptions.dfa169bd.js";import{al as l,r as o,O as s,Q as r,U as n,W as u,c as d,$ as p,R as c,F as m,S as _,a8 as v,aN as f,a3 as y,J as b,q as g,a0 as j,ah as h,Y as x,X as w,a6 as C,ad as S,aZ as T,v as k,aV as E,a9 as P,aa as D}from"./index.872a2bd0.js";import{v as O}from"./vpcApi.1d083c20.js";import{o as R,_ as $,u as I}from"./opsFormInit.3a4e1794.js";import{_ as F}from"./index.029351cd.js";import{t as U}from"./tableRender.a6ff99b7.js";import"./index.2c670fa1.js";import"./index.fe8e77ef.js";import"./Checkbox.ddee6d58.js";import"./index.6f715054.js";import"./useBreakpoint.e81952b0.js";import"./index.e3d002e2.js";import"./index.fc9664cf.js";import"./index.9846e408.js";import"./index.87ccdcd1.js";import"./index.a533313d.js";import"./index.44a4e190.js";import"./index.65b2e021.js";import"./index.6e2fd079.js";import"./Group.b415afa6.js";import"./RadioButton.534ff50d.js";import"./index.48209b21.js";import"./index.64f8d8d4.js";import"./alertLevel.8dae0e72.js";const L={__name:"edit",props:{open:{type:Boolean,default:!1},sid:{type:[String,Number],default:""},formType:{type:Number}},emits:["update:open","editSuccess"],setup(e,{emit:t}){const a=e,{open:i,sid:y,formType:b}=l(a),g=t;let j=o(null);const{putVpcSubnetEdit:h,getVpcSubnetList:x}=O;let{formRenderContent:w,formDataLoading:C,confirmLoading:S,initForm:T,formDataInit:k,editSubmit:E}=R({formRef:j,editTitleLayer:1,formType:b,sid:y,emits:g,editApi:h,oneDataApi:x,customSubmitData:async e=>e,customEditData:()=>{}});const P=()=>{g("update:open",!1)},D=async e=>{e&&(await T(),await k())};return(e,t)=>{const a=$,l=v,o=f,y=s("vxe-button"),g=F;return r(),n(g,{title:`${e.$route.meta.title}${p(b)===e.$CONFIG.FORM_TYPE.ADD_TYPE?"新增":"编辑"}`,open:p(i),onAfterOpenChange:D,onClose:P},{footer:u((()=>[d(y,{content:"取消",onClick:P}),d(y,{type:"submit",loading:p(S),status:"primary",content:"提交",onClick:p(E)},null,8,["loading","onClick"])])),default:u((()=>[d(o,{spinning:p(C)},{default:u((()=>[d(l,{ref_key:"formRef",ref:j,model:p(w).formState,rules:p(w).rules},{default:u((()=>[(r(!0),c(m,null,_(e.$utils.filter(p(w).title,(e=>e.edit_display)),(e=>{var t,i;return r(),n(a,{key:e.field,value:p(w).formState[e.field],"onUpdate:value":t=>p(w).formState[e.field]=t,title:e,"title-data":null==(i=null==(t=p(w))?void 0:t.title_data)?void 0:i[e.field]},null,8,["value","onUpdate:value","title","title-data"])})),128))])),_:1},8,["model","rules"])])),_:1},8,["spinning"])])),_:1},8,["title","open"])}}},z=["onClick"],A=["onClick"],N=(e=>(P("data-v-9fcc6f8d"),e=e(),D(),e))((()=>w("br",null,null,-1))),Y={style:{display:"flex","align-items":"center"}},q={class:"truncate text-primary"},G=y({__name:"index",setup(l){let n=o([]),_=o([]),v=o({}),f=o([]),y=o([]);const P=o(null);let D=o({});b((async()=>{let{title_data:e,order:t,button:a,columns:i,sub_page_columns:l,title_field_search:o}=await U.setColumn({layer:1,tableType:"server"});n.value=(null==i?void 0:i.value)||[],_.value=a.value,v.value=e.value,D.value=t.value?t.value:{},f.value=l||[],y.value=o.value||[],await F()}));const R=g((()=>{for(let e of n.value){let{field:t}=e;switch(t){case"virtual_team_v3_id":e.showOverflow=!1;break;case"region_id":case"ipv6_enable":case"status":case"id":case"name":case"vpc_id":e.slots={default:t}}}return n.value}));let $=g((()=>{let e={};if(_.value)for(let t of _.value){let{field:a}=t;switch(a){case"edit":case"add":e[a]=t}}return e}));const F=async()=>{P.value&&P.value.serverTableRef.commitProxy("query")},{userEdit:G,formOpen:V,formType:B,formSid:M}=I(),H=({type:e,row:t})=>{G({type:e,sid:t.id})},J=g((()=>({fields:[{field:"cidr",operator:"vague",field_name:"子网IP",validate:j.isServerIp},{field:"description",operator:"vague",field_name:"描述",validate:e=>!j.isServerIp(e)}],placeholder:"直接输入支持子网IP、描述"}))),{subPageOpen:K,subPageRow:Q,handleSubPageOpen:W}=e(),X=e=>{let t=e.region_id,a="";return"华为云"===e.cloud_source?a=`${null==e?void 0:e.availability_zone}`.replace(`${t}`,"").toUpperCase():"阿里云"===e.cloud_source&&(a=`${null==e?void 0:e.availability_zone}`.replace(`${t}-`,"").toUpperCase()),(a[0]||"")+"区"};return(e,l)=>{var o,n;const _=T,b=k,g=s("vxe-tag"),j=E,I=i,U=a,Z=t;return r(),c(m,null,[d(U,{ref_key:"serverTableRef",ref:P,"table-column":p(R),"auth-btn":p($),order:p(D),"query-api":p(O).postVpcSubnetList,"is-show-doc":!0,"default-search-field":p(J),"show-env-search":{app_name:"cloud_vpc_subnet"},"title-field-search":p(y),onUserEdit:H,onUserAdd:l[0]||(l[0]=t=>{p(G)({type:e.$CONFIG.FORM_TYPE.ADD_TYPE})})},{id:u((({row:e})=>[d(b,{placement:"topLeft"},{title:u((()=>[d(_,{copyable:{tooltip:!1},class:"copy-text"},{default:u((()=>[h(x(e.subnet_id),1)])),_:2},1024)])),default:u((()=>[w("span",{class:"cursor-pointer text-primary",onClick:t=>p(W)(e)},x(e.id),9,z)])),_:2},1024)])),name:u((({row:e})=>[w("span",{class:"cursor-pointer text-primary",onClick:t=>p(W)(e)},x(e.name),9,A)])),region_id:u((({row:e})=>{var t,a;return[h(x(X(e)),1),N,w("span",null,x((null==(a=null==(t=p(v))?void 0:t.region_id)?void 0:a[e.region_id])||e.region_id),1)]})),ipv6_enable:u((({row:e})=>[d(g,{class:C(1==e.ipv6_enable?"theme--primary":"theme--error"),size:"small"},{default:u((()=>[h(x(1==e.ipv6_enable?"打开":"关闭"),1)])),_:2},1032,["class"])])),cloud_master_account_id:u((({row:e})=>{var t,a,i;return[w("div",Y,[d(j,{type:e.cloud_source},null,8,["type"])]),h(" "+x((null==(i=null==(a=null==(t=p(v))?void 0:t.cloud_master_account_id)?void 0:a[e.cloud_master_account_id])?void 0:i.page_display)||""),1)]})),status:u((({row:e})=>[d(g,{class:C("可用"==e.status?"theme--primary":"theme--error"),size:"small"},{default:u((()=>[h(x(e.status),1)])),_:2},1032,["class"])])),vpc_id:u((({row:e})=>[w("div",q,[d(I,{"obj-type":"hw_vpc",uuid:e.vpc_id},null,8,["uuid"])])])),_:1},8,["table-column","auth-btn","order","query-api","default-search-field","title-field-search"]),d(L,{open:p(V),"onUpdate:open":l[1]||(l[1]=e=>S(V)?V.value=e:null),sid:p(M),"form-type":p(B),onEditSuccess:F},null,8,["open","sid","form-type"]),d(Z,{open:p(K),"onUpdate:open":l[2]||(l[2]=e=>S(K)?K.value=e:null),title:null==(o=p(Q))?void 0:o.name,"basic-config":{columns:p(f),api:p(O).getVpcSubnetList,sid:null==(n=p(Q))?void 0:n.id},onClickEdit:l[3]||(l[3]=t=>H({type:e.$CONFIG.FORM_TYPE.EDIT_TYPE,row:p(Q)}))},{region_id:u((({row:e})=>{var t,a;return[w("span",null,x((null==(a=null==(t=p(v))?void 0:t.region_id)?void 0:a[e.region_id])||e.region_id),1)]})),ipv6_enable:u((({row:e})=>[d(g,{class:C(1==e.ipv6_enable?"theme--primary":"theme--error"),size:"small"},{default:u((()=>[h(x(1==e.ipv6_enable?"打开":"关闭"),1)])),_:2},1032,["class"])])),cloud_master_account_id:u((({row:e})=>{var t,a,i;return[h(x((null==(i=null==(a=null==(t=p(v))?void 0:t.cloud_master_account_id)?void 0:a[e.cloud_master_account_id])?void 0:i.page_display)||""),1)]})),status:u((({row:e})=>[d(g,{class:C("可用"==e.status?"theme--primary":"theme--error"),size:"small"},{default:u((()=>[h(x(e.status),1)])),_:2},1032,["class"])])),_:1},8,["open","title","basic-config"])],64)}}},[["__scopeId","data-v-9fcc6f8d"]]);export{G as default};
