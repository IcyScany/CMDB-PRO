import{s as e,_ as t}from"./subPage.2201bfd5.js";import{_ as i}from"./ServerTable.53881589.js";import{aR as a,b5 as l,al as n,r as o,O as s,Q as r,U as d,W as u,c as p,$ as c,R as _,F as m,S as f,a8 as v,aN as g,H as y,q as b,J as w,ah as j,Y as x,X as D,a6 as h,ad as C,aZ as T,v as k,aV as E}from"./index.872a2bd0.js";import{t as S}from"./tableRender.a6ff99b7.js";import{o as $,_ as O,u as P}from"./opsFormInit.3a4e1794.js";import{_ as R}from"./index.029351cd.js";import"./opsDescriptions.dfa169bd.js";import"./index.87ccdcd1.js";import"./index.fc9664cf.js";import"./index.a533313d.js";import"./index.2c670fa1.js";import"./index.fe8e77ef.js";import"./Checkbox.ddee6d58.js";import"./index.6f715054.js";import"./useBreakpoint.e81952b0.js";import"./index.e3d002e2.js";import"./index.9846e408.js";import"./alertLevel.8dae0e72.js";import"./index.44a4e190.js";import"./index.65b2e021.js";import"./index.6e2fd079.js";import"./Group.b415afa6.js";import"./RadioButton.534ff50d.js";import"./index.48209b21.js";import"./index.64f8d8d4.js";const F="network/vpc/peering/",A={postList:e=>a.post(`${F}list`,e),getDetail:e=>a.get(`${F}list/${e}`),postAdd:e=>a.post(`${F}add`,e),putEdit:(e,t)=>a.put(`${F}edit/${e}`,t),del:e=>a.delete(`${F}delete/${e}`)},U={__name:"edit",props:{open:{type:Boolean,default:!1},sid:{type:[String,Number],default:""},formType:{type:Number,default:l}},emits:["update:open","editSuccess"],setup(e,{emit:t}){const i=e,{open:a,sid:l,formType:y}=n(i),b=t,w=o(null),{putEdit:j,getDetail:x,postAdd:D}=A,{formRenderContent:h,formDataLoading:C,confirmLoading:T,initForm:k,formDataInit:E,editSubmit:S}=$({formRef:w,TITLE_LAYER:1,formType:y,sid:l,emits:b,addApi:D,editApi:j,oneDataApi:x,customSubmitData:async function(e){return e},customEditData:function(){}});const P=()=>{b("update:open",!1)},F=async e=>{e&&(await k(),await E())};return(e,t)=>{const i=O,l=v,n=g,o=s("vxe-button"),b=R;return r(),d(b,{title:`${e.$route.meta.title}${c(y)===e.$CONFIG.FORM_TYPE.ADD_TYPE?"新增":"编辑"}`,open:c(a),onAfterOpenChange:F,onClose:P},{footer:u((()=>[p(o,{content:"取消",onClick:P}),p(o,{type:"submit",loading:c(T),status:"primary",content:"提交",onClick:c(S)},null,8,["loading","onClick"])])),default:u((()=>[p(n,{spinning:c(C)},{default:u((()=>[p(l,{ref_key:"formRef",ref:w,model:c(h).formState,rules:c(h).rules},{default:u((()=>[(r(!0),_(m,null,f(e.$utils.filter(c(h).title,(e=>e.edit_display)),(e=>{var t,a,l,n;return r(),_(m,{key:e.field},[""===e.field?(r(),d(i,{key:0,value:c(h).formState[e.field],"onUpdate:value":t=>c(h).formState[e.field]=t,title:e,"title-data":null==(a=null==(t=c(h))?void 0:t.title_data)?void 0:a[e.field]},null,8,["value","onUpdate:value","title","title-data"])):(r(),d(i,{key:1,value:c(h).formState[e.field],"onUpdate:value":t=>c(h).formState[e.field]=t,title:e,"title-data":null==(n=null==(l=c(h))?void 0:l.title_data)?void 0:n[e.field]},null,8,["value","onUpdate:value","title","title-data"]))],64)})),128))])),_:1},8,["model","rules"])])),_:1},8,["spinning"])])),_:1},8,["title","open"])}}},q=["onClick"],L=["onClick"],Y={style:{display:"flex","align-items":"center"}},B={class:"truncate"},I={class:"truncate"},N={class:"truncate"},G={class:"truncate"},z={__name:"index",setup(a){const l=o(null),n=y({initColumn:[],subPageColumns:[],initButton:[],initTitleData:[],tableOrder:{},titleFieldSearch:[]}),{userEdit:d,userDel:f,formOpen:v,formType:g,formSid:$}=P(),O=b((()=>{for(let e of n.initColumn){let{field:t}=e;switch(t){case"id":case"peering_id":case"peering_status":e.slots={default:t};break;case"virtual_team_v3_id":case"accept_vpc_id":case"accept_tenant_id":e.showOverflow=!1}}return n.initColumn})),R=b((()=>{const e=["edit","add","del"];return n.initButton.reduce(((t,i)=>(e.includes(i.field)&&(t[i.field]=i),t)),{})}));w((async()=>{const{button:e,columns:t,title_data:i,order:a,sub_page_columns:l,title_field_search:o}=await S.setColumn({layer:1});n.initColumn=t.value||[],n.initButton=e.value||[],n.initTitleData=i.value||[],n.tableOrder=a.value||{},n.subPageColumns=l||[],n.titleFieldSearch=o.value||[],await F()}));const F=async()=>{l.value&&await l.value.serverTableRef.commitProxy("query")},z=({type:e,row:t})=>{d({type:e,sid:t.id})},M=({row:e})=>{f({sid:e.id,delApi:A.del,loadData:F})},{subPageOpen:H,subPageRow:J,handleSubPageOpen:K}=e(),Q={fields:[{field:"name",field_name:"名称",operator:"vague"}],placeholder:"支持名称搜索"};return(e,a)=>{var o,f,y;const b=T,w=k,S=E,P=s("vxe-tag"),V=i,W=t;return r(),_(m,null,[p(V,{ref_key:"tableRef",ref:l,"table-column":c(O),"auth-btn":c(R),order:c(n).tableOrder,"query-api":c(A).postList,"is-show-doc":!0,"is-show-sync":{show:!0,uri:"sync_rds_instance"},"default-search-field":Q,"title-field-search":c(n).titleFieldSearch,onUserEdit:z,onUserAdd:a[0]||(a[0]=t=>c(d)({type:e.$CONFIG.FORM_TYPE.ADD_TYPE})),onUserDel:M},{id:u((({row:e})=>[p(w,{placement:"topLeft"},{title:u((()=>[p(b,{copyable:{tooltip:!1},class:"tooltip-text"},{default:u((()=>[j(x(e.peering_id),1)])),_:2},1024)])),default:u((()=>[D("span",{class:"cursor-pointer text-primary",onClick:t=>c(K)(e)},x(e.id),9,q)])),_:2},1024)])),peering_id:u((({row:e})=>[D("span",{class:"cursor-pointer text-primary",onClick:t=>c(K)(e)},x(e.peering_id),9,L)])),cloud_master_account_id:u((({row:e})=>{var t,i,a;return[D("div",Y,[p(S,{type:e.cloud_source},null,8,["type"])]),j(" "+x((null==(a=null==(i=null==(t=c(n).initTitleData)?void 0:t.cloud_master_account_id)?void 0:i[e.cloud_master_account_id])?void 0:a.page_display)||""),1)]})),region_id:u((({row:e})=>{var t,i,a;return[D("div",null,x(null==e?void 0:e.zone_id),1),D("div",null,x((null==(t=c(n).initTitleData)?void 0:t.region_id)&&(null==(a=null==(i=c(n).initTitleData)?void 0:i.region_id)?void 0:a[null==e?void 0:e.region_id])||(null==e?void 0:e.region_id)),1)]})),peering_status:u((({row:e})=>[p(P,{class:h(["活动的","已激活"].includes(e.peering_status)?"theme--primary":"theme--error"),size:"small"},{default:u((()=>[j(x(e.peering_status),1)])),_:2},1032,["class"])])),accept_tenant_id:u((({row:e})=>[p(w,{title:e.request_tenant_id},{default:u((()=>[D("div",B,x(e.request_tenant_id),1)])),_:2},1032,["title"]),p(w,{title:e.accept_tenant_id},{default:u((()=>[D("div",I,x(e.accept_tenant_id),1)])),_:2},1032,["title"])])),accept_vpc_id:u((({row:e})=>[p(w,{title:e.request_vpc_id},{default:u((()=>[D("div",N,x(e.request_vpc_id),1)])),_:2},1032,["title"]),p(w,{title:e.accept_vpc_id},{default:u((()=>[D("div",G,x(e.accept_vpc_id),1)])),_:2},1032,["title"])])),_:1},8,["table-column","auth-btn","order","query-api","title-field-search"]),p(U,{open:c(v),"onUpdate:open":a[1]||(a[1]=e=>C(v)?v.value=e:null),sid:c($),"form-type":c(g),onEditSuccess:F},null,8,["open","sid","form-type"]),p(W,{open:c(H),"onUpdate:open":a[2]||(a[2]=e=>C(H)?H.value=e:null),sid:null==(o=c(J))?void 0:o.id,title:null==(f=c(J))?void 0:f.peering_id,"basic-config":{columns:c(n).subPageColumns,api:c(A).getDetail,sid:null==(y=c(J))?void 0:y.id},onClickEdit:a[3]||(a[3]=t=>z({type:e.$CONFIG.FORM_TYPE.EDIT_TYPE,row:c(J)}))},{peering_status:u((({row:e})=>[p(P,{class:h(["活动的","已激活"].includes(e.peering_status)?"theme--primary":"theme--error"),size:"small"},{default:u((()=>[j(x(e.peering_status),1)])),_:2},1032,["class"])])),cloud_master_account_id:u((({row:e})=>{var t,i,a;return[j(x((null==(a=null==(i=null==(t=c(n).initTitleData)?void 0:t.cloud_master_account_id)?void 0:i[e.cloud_master_account_id])?void 0:a.page_display)||""),1)]})),region_id:u((({row:e})=>{var t,i,a;return[D("div",null,x((null==(t=c(n).initTitleData)?void 0:t.region_id)&&(null==(a=null==(i=c(n).initTitleData)?void 0:i.region_id)?void 0:a[null==e?void 0:e.region_id])||(null==e?void 0:e.region_id)),1)]})),_:1},8,["open","sid","title","basic-config"])],64)}}};export{z as default};
